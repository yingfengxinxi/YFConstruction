{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-75df\",\"chunk-6b71\",\"chunk-b6ce\",\"chunk-ae32\"],{\"+cqn\":function(e,t,s){\"use strict\";var i=s(\"OKZ7\");s.n(i).a},\"+lNB\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"8GhS\"),a=s(\"7Dod\"),n=s(\"AAeT\"),l=s(\"ERJp\"),o=s(\"d9x6\"),c=s(\"c2Co\"),r=s(\"Y4Le\"),u=s(\"1DpC\"),d=s(\"VcMt\"),h={name:\"TransferHandle\",components:{XhUserCell:i.p},mixins:[],props:{dialogVisible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:\"\"},selectionList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,visible:!1,usersList:[],removeType:1,handleType:1,addsTypes:[]}},computed:{showRemoveType:function(){return\"leads\"!=this.crmType&&\"contacts\"!=this.crmType&&\"receivables\"!=this.crmType&&\"product\"!=this.crmType&&\"invoice\"!=this.crmType}},watch:{dialogVisible:{handler:function(e){this.visible=e,e||this.resetData()},deep:!0,immediate:!0}},mounted:function(){this.visible=this.dialogVisible},methods:{resetData:function(){this.usersList=[],this.removeType=1,this.handleType=1,this.addsTypes=[]},handleCancel:function(){this.visible=!1,this.$emit(\"update:dialogVisible\",!1)},userChage:function(e){this.usersList=e.value},handleConfirm:function(){var e=this;0===this.usersList.length?this.$message.error(\"请选择变更负责人\"):(this.loading=!0,this.getRequest()(this.getParams()).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.loading=!1,e.handleCancel(),\"customer\"!=e.crmType&&\"contract\"!=e.crmType&&\"leads\"!=e.crmType||e.$store.dispatch(\"GetMessageNum\"),e.$emit(\"handle\",{type:\"transfer\"})}).catch(function(){e.loading=!1}))},getRequest:function(){return\"leads\"===this.crmType?c.m:\"customer\"===this.crmType?a.X:\"contacts\"===this.crmType?n.o:\"business\"===this.crmType?l.x:\"contract\"===this.crmType?o.s:\"receivables\"===this.crmType?u.k:\"product\"===this.crmType?r.m:\"invoice\"===this.crmType?d.k:void 0},getParams:function(){var e=this,t={ownerUserId:this.usersList[0].userId};return this.showRemoveType&&(t.transferType=this.removeType),2===this.removeType&&(t.power=this.handleType),t.ids=this.selectionList.map(function(t){return parseInt(t[e.crmType+\"Id\"])}),\"customer\"===this.crmType&&(t.changeType=this.addsTypes.map(function(e){return parseInt(e)})),t}}},p=(s(\"+cqn\"),s(\"KHd+\")),m=Object(p.a)(h,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"批量转移\",width:\"450px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticClass:\"handle-box\"},[s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"变更负责人为：\")]),e._v(\" \"),s(\"xh-user-cell\",{staticClass:\"handle-item-content\",attrs:{value:e.usersList},on:{\"value-change\":e.userChage}})],1),e._v(\" \"),e.showRemoveType?s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"将原负责人：\")]),e._v(\" \"),s(\"el-radio-group\",{model:{value:e.removeType,callback:function(t){e.removeType=t},expression:\"removeType\"}},[s(\"el-radio\",{attrs:{label:1}},[e._v(\"移出\")]),e._v(\" \"),s(\"el-radio\",{attrs:{label:2}},[e._v(\"转为团队成员\")])],1)],1):e._e(),e._v(\" \"),2==e.removeType?s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"权限：\")]),e._v(\" \"),s(\"el-radio-group\",{model:{value:e.handleType,callback:function(t){e.handleType=t},expression:\"handleType\"}},[s(\"el-radio\",{attrs:{label:1}},[e._v(\"只读\")]),e._v(\" \"),s(\"el-radio\",{attrs:{label:2}},[e._v(\"读写\")])],1)],1):e._e(),e._v(\" \"),\"customer\"===e.crmType?s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"同时变更负责人至：\")]),e._v(\" \"),s(\"el-checkbox-group\",{model:{value:e.addsTypes,callback:function(t){e.addsTypes=t},expression:\"addsTypes\"}},[s(\"el-checkbox\",{attrs:{label:\"1\"}},[e._v(\"联系人\")]),e._v(\" \"),s(\"el-checkbox\",{attrs:{label:\"2\"}},[e._v(\"商机\")]),e._v(\" \"),s(\"el-checkbox\",{attrs:{label:\"3\"}},[e._v(\"合同\")])],1)],1):e._e()],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1)])},[],!1,null,\"730da104\",null);m.options.__file=\"TransferHandle.vue\";t.default=m.exports},\"+xXq\":function(e,t,s){e.exports=s.p+\"static/img/check_revoke.0500d70.png\"},\"/407\":function(e,t,s){\"use strict\";s.r(t);var i={name:\"RelatedBusinessCell\",props:{type:{type:String,default:\"\"},cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!0}},data:function(){return{}},computed:{typeName:function(){return\"customer\"==this.type?\"客户\":\"contacts\"==this.type?\"联系人\":\"business\"==this.type?\"商机\":\"contract\"==this.type?\"合同\":\"\"},name:function(){return this.data.name||this.data.businessName||this.data.customerName||this.data.number}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{footClick:function(){this.$emit(\"unbind\",this.type,this.cellIndex,this.data)},bodyClick:function(){this.$emit(\"detail\",this.type,this.cellIndex,this.data)}}},a=(s(\"/hyb\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"flexbox\",{staticClass:\"cell\"},[s(\"div\",{staticClass:\"cell-head\"},[s(\"i\",{class:e._f(\"wkIconPre\")(e.type)}),e._v(\" \"),s(\"span\",[e._v(\"\\n      \"+e._s(\"相关\"+e.typeName+\"-\")+\"\\n    \")])]),e._v(\" \"),s(\"div\",{staticClass:\"cell-body text-one-line\",class:{\"cursor-pointer\":e.cursorPointer},on:{click:e.bodyClick}},[e._v(\"\\n    \"+e._s(e.name)+\"\\n  \")]),e._v(\" \"),s(\"div\",{staticClass:\"cell-foot\"},[e.showFoot?s(\"a\",{staticClass:\"cancel-btn\",on:{click:e.footClick}},[e._v(\"取消关联\")]):e._e()])])},[],!1,null,\"061d0168\",null);n.options.__file=\"index.vue\";t.default=n.exports},\"/hyb\":function(e,t,s){\"use strict\";var i=s(\"KOLf\");s.n(i).a},\"0/jB\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"EJiy\"),a=s.n(i),n=s(\"gDS+\"),l=s.n(n),o=s(\"ZoMv\"),c=s(\"4XAY\"),r=s(\"6iAj\"),u=s(\"7Qib\"),d=s(\"8GhS\"),h=s(\"Woz+\"),p=s(\"KTTK\"),m={name:\"SceneCreate\",components:{XhUserCell:d.p,XhProuctCate:d.j,VDistpicker:h.a,XhStructureCell:d.n},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,required:!0,default:function(){return{}}},crmType:{type:String,default:\"\"},name:{type:String,default:\"\"},isDefault:{type:Boolean,default:!1},edit_id:{type:String,default:\"\"}},data:function(){return{form:[],visible:!1,showErrors:!1,saveDefault:!1,saveName:null}},watch:{dialogVisible:{handler:function(e){var t=this;if(e){if(this.edit_id){this.form=[];var s=function(e){var s=t.obj.obj[e],i=t.getItem();if(i.fieldName=s.name,i.formType=s.formType,i.type=s.type,t.calConditionOptions(s.formType,s).forEach(function(e){s.type===e.type&&(i.condition=e.value)}),\"checkbox\"!==i.formType&&\"select\"!==i.formType&&\"dealStatus\"!==i.formType&&\"checkStatus\"!==i.formType||(i.setting=t.getEditSetting(i.formType,i.fieldName)),\"date\"==s.formType)i.value=s.values;else if(\"datetime\"==s.formType)i.value=s.values;else if(\"business_type\"==s.formType){if(i.typeId=s.values[0],i.statusId=s.values.length>1?s.values[1]:null,i.typeOption=t.getEditSetting(i.formType,i.fieldName),s.typeId){var a=i.typeOption.find(function(e){return e.typeId===s.typeId});i.statusOption=a?a.statusList:[]}}else if(\"user\"==s.formType)i.value=[],t.getEditUserValue(i,s.values[0]);else if(\"structure\"==s.formType)i.value=[],t.getEditDepValue(i,s.values[0]);else if(\"checkbox\"==s.formType)i.value=s.values;else if(\"select\"==s.formType)\"string\"!=t.getSettingValueType(i.setting)?i.value=s.values[0]:i.value=s.values;else if(\"category\"==s.formType)i.value=[],t.getProductCategoryValue(i,s.values[0]);else if(\"map_address\"==s.formType){var n=s.values[0].split(\",\");i.address={state:n.length>0?n[0]:\"\",city:n.length>1?n[1]:\"\",area:n.length>2?n[2]:\"\"}}else i.setting=s.setting,i.value=s.values[0];t.form.push(i)};for(var i in this.obj.obj)s(i)}else this.form=Object(u.t)(this.obj.form),0==this.form.length&&this.form.push(this.getItem());this.name?this.saveName=this.name:this.saveName=\"\",this.isDefault?this.saveDefault=this.isDefault:this.saveDefault=!1}this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick(function(){var e=document.getElementById(\"scene-filter-container\");e.scrollTop=e.scrollHeight})}},methods:{getEditSetting:function(e,t){var s=this.fieldList.find(function(s){return s.formType==e&&s.fieldName==t});return s?s.setting:[]},getEditUserValue:function(e,t){t&&Object(p.D)({pageType:0}).then(function(s){for(var i=s.data||[],a=0;a<i.length;a++){var n=i[a];if(n.userId==t){e.value=[n];break}}}).catch(function(){})},getEditDepValue:function(e,t){t&&Object(p.n)().then(function(s){for(var i=s.data||[],a=0;a<i.length;a++){var n=i[a];if(n.id==t){e.value=[n];break}}}).catch(function(){})},getProductCategoryValue:function(e,t){var s=this;Object(r.L)().then(function(i){var a=i.data||[],n=[];s.filterProductTree(a,t,n),e.value=n.reverse()}).catch(function(){})},filterProductTree:function(e,t,s){for(var i=0;i<e.length;i++){var a=e[i];if(a.categoryId==t){s.push(t),this.filterProductTree(e,a.pid,s);break}}},selectProvince:function(e,t){t.address.state=e.value},selectCity:function(e,t){t.address.city=e.value},selectArea:function(e,t){t.address.area=e.value},getItem:function(){return{fieldName:\"\",name:\"\",type:3,formType:\"\",condition:\"contains\",value:\"\",setting:[],typeOption:[],statusOption:[],typeId:\"\",statusId:\"\"}},typeOptionsChange:function(e){if(e.typeId){var t=e.typeOption.find(function(t){return t.typeId===e.typeId});e.statusOption=t.statusList||[]}else e.statusOption=[];e.statusId=\"\"},arrayValueChange:function(e){e.value.length>0?(e.item.value=e.value,e.item.valueContent=e.valueContent):e.item.value=[]},selectChange:function(e,t){this.calConditionOptions(t.formType,t).forEach(function(s){s.value===e&&(t.type=s.type)})},showCalCondition:function(e){return\"date\"!=e&&\"datetime\"!=e&&\"business_type\"!=e&&\"category\"!=e&&\"map_address\"!=e},calConditionOptions:function(e,t){return\"checkStatus\"==e||\"dealStatus\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2}]:\"user\"==e||\"structure\"==e?[{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4}]:\"select\"==e?[{value:\"in\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2}]:\"checkbox\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"contains\",label:\"包含\",disabled:!1,type:3}]:\"module\"==e||\"text\"==e||\"textarea\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4}]:\"floatnumber\"==e||\"number\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4},{value:\"isNull\",label:\"为空\",disabled:!1,type:5},{value:\"isNotNull\",label:\"不为空\",disabled:!1,type:6},{value:\"gt\",label:\"大于\",disabled:!1,type:7},{value:\"egt\",label:\"大于等于\",disabled:!1,type:8},{value:\"lt\",label:\"小于\",disabled:!1,type:9},{value:\"elt\",label:\"小于等于\",disabled:!1,type:10}]:\"category\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isnot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"not_contain\",label:\"不包含\",disabled:!1,type:4}]:[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4},{value:\"startWith\",label:\"开始于\",disabled:!1,type:8},{value:\"endWith\",label:\"结束于\",disabled:!1,type:10},{value:\"isNull\",label:\"为空\",disabled:!1,type:5},{value:\"isNotNull\",label:\"不为空\",disabled:!1,type:6},{value:\"gt\",label:\"大于\",disabled:!1,type:7},{value:\"egt\",label:\"大于等于\",disabled:!1,type:8},{value:\"lt\",label:\"小于\",disabled:!1,type:9},{value:\"elt\",label:\"小于等于\",disabled:!1,type:10}]},fieldFocus:function(){this.$el.click()},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.fieldName===e.fieldName});t&&(e.formType=t.formType,e.name=t.name,\"business_type\"==e.formType?(e.typeOption=t.setting,e.statusOption=[],e.typeId=\"\",e.statusId=\"\",e.value=\"\"):\"checkStatus\"==e.formType||\"dealStatus\"==e.formType?(e.setting=t.setting||[],e.value=\"\"):\"map_address\"==e.formType?e.address={state:\"\",city:\"\",area:\"\"}:\"date\"===e.formType||\"datetime\"===e.formType||\"user\"===e.formType||\"structure\"===e.formType||\"category\"===e.formType?e.value=[]:\"select\"==e.formType||\"checkbox\"===e.formType?(e.setting=t.setting||[],e.value=[]):e.value=\"\",\"checkbox\"==e.formType||\"checkStatus\"==e.formType||\"dealStatus\"==e.formType?(e.condition=\"is\",e.type=1):\"user\"==e.formType||\"structure\"==e.formType?(e.condition=\"contains\",e.type=3):\"select\"==e.formType?(e.condition=\"in\",e.type=1):(e.condition=\"is\",e.type=1)),this.getError()},handleCancel:function(){this.visible=!1,this.$emit(\"update:dialogVisible\",!1)},getError:function(){this.showErrors=!1;for(var e=[],t=0;t<this.form.length;t++){var s=this.form[t];if(e.includes(s.fieldName)){this.showErrors=!0;break}e.push(s.fieldName)}},handleConfirm:function(){var e=this;if(this.showErrors)this.$message.error(\"筛选条件中有重复项！\");else if(this.saveName&&\"\"!==this.saveName){for(var t=0;t<this.form.length;t++){var s=this.form[t];if(!s.fieldName||\"\"===s.fieldName)return void this.$message.error(\"要筛选的字段名称不能为空！\");if(\"business_type\"==s.formType){if(!s.typeId&&!s.statusId)return void this.$message.error(\"筛选内容不能为空！\")}else if(\"map_address\"==s.formType){if(!s.address.state&&!s.address.city&&!s.address.area)return void this.$message.error(\"筛选内容不能为空！\")}else if(\"date\"==s.formType||\"datetime\"==s.formType||\"user\"==s.formType||\"structure\"==s.formType||\"category\"==s.formType||\"checkbox\"==s.formType){if(!s.value||0===s.value.length)return void this.$message.error(\"筛选内容不能为空！\")}else if(\"\"===s.value||void 0===s.value||null===s.value)return void this.$message.error(\"筛选内容不能为空！\")}var i=[];this.form.forEach(function(t){if(\"datetime\"==t.formType||\"date\"==t.formType)i.push({formType:t.formType,name:t.fieldName,type:\"date\"==t.formType?11:12,values:t.value});else if(\"business_type\"==t.formType)i.push({formType:t.formType,name:t.statusId?\"statusId\":\"typeId\",type:1,values:t.statusId?[t.typeId,t.statusId]:[t.typeId]});else if(\"user\"==t.formType)i.push({type:t.type,values:[t.value[0].userId],formType:t.formType,name:t.fieldName});else if(\"structure\"==t.formType)i.push({type:t.type,values:[t.value[0].id],formType:t.formType,name:t.fieldName});else if(\"checkbox\"==t.formType)i.push({type:t.type,values:t.value,formType:t.formType,name:t.fieldName});else if(\"category\"==t.formType)i.push({type:1,values:[t.value[t.value.length-1]],formType:t.formType,name:t.fieldName});else if(\"select\"==t.formType){var s=t.value;\"string\"!=e.getSettingValueType(t.setting)&&(s=[t.value]),i.push({type:t.type,values:s,formType:t.formType,name:t.fieldName})}else if(\"map_address\"==t.formType){var a=\"\";for(var n in t.address)t.address[n]&&(a+=t.address[n]+\",\");i.push({values:[a],type:1,formType:t.formType,name:t.fieldName})}else i.push({type:t.type,values:[t.value],formType:t.formType,name:t.fieldName})});var a={obj:i,form:this.form,saveDefault:this.saveDefault,saveName:this.saveName};this.requestCreateScene(a)}else this.$message.error(\"场景名称不能为空！\")},requestCreateScene:function(e){var t=this;this.edit_id?Object(c.w)({isDefault:e.saveDefault?1:0,name:e.saveName,sceneId:this.edit_id,type:o.default[this.crmType],data:l()(e.obj)}).then(function(e){t.$message({type:\"success\",message:\"编辑成功\"}),t.$emit(\"save-success\"),t.handleCancel()}).catch(function(){}):Object(c.t)({type:o.default[this.crmType],isDefault:e.saveDefault?1:0,name:e.saveName,data:l()(e.obj)}).then(function(e){t.$emit(\"save-success\"),t.$message({type:\"success\",message:\"创建成功\"}),t.handleCancel()}).catch(function(){})},handleAdd:function(){this.form.push(this.getItem())},handleDelete:function(e){var t=this;this.$confirm(\"您确定要删除这一条数据吗?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.form.splice(e,1),t.getError()}).catch(function(){})},getSettingValueType:function(e){if(e&&e.length>0){var t=e[0];return void 0===t?\"undefined\":a()(t)}return[]}}},f=(s(\"lhwF\"),s(\"KHd+\")),v=Object(f.a)(m,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{attrs:{title:e.edit_id?\"编辑场景\":\"新建场景\",visible:e.visible,\"close-on-click-modal\":!1,\"append-to-body\":!0,width:\"800px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticClass:\"scene-name-container\"},[s(\"div\",{staticClass:\"scene-name\"},[e._v(\"场景名称\")]),e._v(\" \"),s(\"el-input\",{staticClass:\"scene-input\",attrs:{maxlength:10,placeholder:\"请输入场景名称，最多10个字符\"},model:{value:e.saveName,callback:function(t){e.saveName=\"string\"==typeof t?t.trim():t},expression:\"saveName\"}})],1),e._v(\" \"),s(\"div\",{staticClass:\"scene-name\"},[e._v(\"筛选条件\")]),e._v(\" \"),s(\"el-form\",{staticClass:\"filter-container\",attrs:{id:\"scene-filter-container\"}},[s(\"el-form-item\",[e._l(e.form,function(t,i){return[s(\"el-row\",{key:i},[s(\"el-col\",{attrs:{span:8}},[s(\"el-select\",{attrs:{placeholder:\"请选择要筛选的字段名\"},on:{change:function(s){e.fieldChange(t)},focus:e.fieldFocus},model:{value:t.fieldName,callback:function(s){e.$set(t,\"fieldName\",s)},expression:\"formItem.fieldName\"}},e._l(e.fieldList,function(e){return s(\"el-option\",{key:e.fieldName,attrs:{label:e.name,value:e.fieldName}})}))],1),e._v(\" \"),e.showCalCondition(t.formType)?s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]):e._e(),e._v(\" \"),e.showCalCondition(t.formType)?s(\"el-col\",{attrs:{span:4}},[s(\"el-select\",{attrs:{placeholder:\"请选择范围\"},on:{change:function(s){e.selectChange(s,t)}},model:{value:t.condition,callback:function(s){e.$set(t,\"condition\",s)},expression:\"formItem.condition\"}},e._l(e.calConditionOptions(t.formType,t),function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(\" \"),\"business_type\"==t.formType?s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]):e._e(),e._v(\" \"),\"business_type\"==t.formType?s(\"el-col\",{attrs:{span:4}},[s(\"el-select\",{on:{change:function(s){e.typeOptionsChange(t)}},model:{value:t.typeId,callback:function(s){e.$set(t,\"typeId\",s)},expression:\"formItem.typeId\"}},e._l(t.typeOption,function(e){return s(\"el-option\",{key:e.typeId,attrs:{label:e.name,value:e.typeId}})}))],1):e._e(),e._v(\" \"),s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]),e._v(\" \"),s(\"el-col\",{attrs:{span:\"datetime\"===t.formType||\"date\"===t.formType||\"map_address\"===t.formType?13:8}},[\"checkStatus\"===t.formType||\"dealStatus\"===t.formType||\"select\"===t.formType&&\"string\"!=e.getSettingValueType(t.setting)?s(\"el-select\",{attrs:{placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.name,value:e.value}})})):\"select\"===t.formType?s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e,attrs:{label:e,value:e}})})):\"checkbox\"===t.formType?s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e,attrs:{label:e,value:e}})})):\"date\"===t.formType||\"datetime\"===t.formType?s(\"el-date-picker\",{staticStyle:{padding:\"0px 10px\"},attrs:{\"value-format\":\"date\"===t.formType?\"yyyy-MM-dd\":\"yyyy-MM-dd HH:mm:ss\",type:\"date\"===t.formType?\"daterange\":\"datetimerange\",\"range-separator\":\"-\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}}):\"business_type\"===t.formType?s(\"el-select\",{model:{value:t.statusId,callback:function(s){e.$set(t,\"statusId\",s)},expression:\"formItem.statusId\"}},e._l(t.statusOption,function(e){return s(\"el-option\",{key:e.statusId,attrs:{label:e.name,value:e.statusId}})})):\"user\"===t.formType?s(\"xh-user-cell\",{attrs:{item:t,\"info-params\":{m:\"crm\",c:e.crmType,a:\"index\"},value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"structure\"===t.formType?s(\"xh-structure-cell\",{attrs:{item:t,value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"category\"===t.formType?s(\"xh-prouct-cate\",{attrs:{item:t,value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"map_address\"===t.formType?s(\"v-distpicker\",{attrs:{province:t.address.state,city:t.address.city,area:t.address.area},on:{province:function(s){e.selectProvince(s,t)},city:function(s){e.selectCity(s,t)},area:function(s){e.selectArea(s,t)}}}):s(\"el-input\",{attrs:{placeholder:\"请输入筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}})],1),e._v(\" \"),s(\"el-col\",{staticClass:\"delete\",attrs:{span:1}},[s(\"i\",{staticClass:\"el-icon-error delete-btn\",on:{click:function(t){e.handleDelete(i)}}})])],1)]})],2)],1),e._v(\" \"),s(\"p\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showErrors,expression:\"showErrors\"}],staticClass:\"el-icon-warning warning-info\"},[s(\"span\",{staticClass:\"desc\"},[e._v(\"筛选条件中有重复项！\")])]),e._v(\" \"),s(\"el-button\",{attrs:{type:\"text\"},on:{click:e.handleAdd}},[e._v(\"+ 添加筛选条件\")]),e._v(\" \"),s(\"div\",{staticClass:\"save\"},[s(\"div\",{staticClass:\"save-setting\"},[s(\"el-checkbox\",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:\"saveDefault\"}},[e._v(\"设置为默认\")])],1)]),e._v(\" \"),s(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{on:{click:e.handleCancel}},[e._v(\"取 消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"确 定\")])],1)],1)},[],!1,null,\"84f2a688\",null);v.options.__file=\"SceneCreate.vue\";t.default=v.exports},\"08m3\":function(e,t,s){},\"0Dkb\":function(e,t,s){e.exports=s.p+\"static/img/todo.b7ec535.png\"},\"4A6M\":function(e,t,s){\"use strict\";var i=s(\"T1FP\");s.n(i).a},\"5QVi\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"L2JU\"),l=s(\"ZoMv\"),o=s(\"RY6g\"),c=s(\"sR+e\"),r=s(\"68y1\"),u=s(\"4XAY\"),d=s(\"7Dod\"),h=s(\"c2Co\"),p=s(\"AAeT\"),m=s(\"ERJp\"),f=s(\"d9x6\"),v=s(\"Y4Le\"),y=s(\"1DpC\"),g=s(\"zhwh\"),b=s(\"X5SI\"),_=s(\"4peS\"),C=s.n(_),w=s(\"XJYT\"),T=s(\"dAOq\"),k=s(\"jHPx\"),x=s(\"7Qib\");t.default={components:{CRMListHead:o.default,CRMTableHead:c.default,FieldSet:r.default},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-235,list:[],fieldList:[],sortData:{},currentPage:1,pageSize:C.a.get(\"crmPageSizes\")||15,pageSizes:[15,30,60,100],total:0,search:\"\",rowID:\"\",rowType:\"\",showDview:!1,filterObj:[],sceneId:\"\",sceneName:\"\",selectionList:[],moneyFields:[],isRequested:!1}},mixins:[T.a],computed:a()({},Object(n.b)([\"crm\"])),watch:{},mounted:function(){var e=this;window.onresize=function(){e.updateTableHeight()},this.isSeas&&this.crm.pool?this.getFieldList():this.crm[this.crmType].index&&(this.loading=!0)},methods:{getList:function(){var e=this;this.loading=!0;var t=this.getIndexRequest(),s={page:this.currentPage,limit:this.pageSize,search:this.search,type:this.isSeas?l.default.pool:l.default[this.crmType]};this.sortData.order&&(s.sortField=this.sortData.prop,s.order=\"ascending\"==this.sortData.order?2:1),this.sceneId&&(s.sceneId=this.sceneId),this.poolId&&(s.poolId=this.poolId),this.filterObj&&this.filterObj.length>0&&(s.searchList=this.filterObj),t(s).then(function(t){e.isRequested=!0,\"customer\"===e.crmType?e.list=t.data.list.map(function(e){return e.show=!1,e}):(\"contract\"!==e.crmType&&\"receivables\"!==e.crmType&&\"business\"!==e.crmType||(e.moneyData=t.data.extraData&&t.data.extraData.money||{}),e.list=t.data.list),t.data.totalRow&&Math.ceil(t.data.totalRow/e.pageSize)<e.currentPage&&e.currentPage>1?(e.currentPage=e.currentPage-1,e.getList()):(e.total=t.data.totalRow,e.loading=!1),e.$nextTick(function(){document.querySelector(\".el-table__body-wrapper\").scrollTop=1})}).catch(function(){e.loading=!1})},getIndexRequest:function(){return\"leads\"===this.crmType?h.g:\"customer\"===this.crmType?this.isSeas?d.t:d.k:\"contacts\"===this.crmType?p.g:\"business\"===this.crmType?m.g:\"contract\"===this.crmType?f.g:\"product\"===this.crmType?v.g:\"receivables\"===this.crmType?y.e:\"visit\"===this.crmType?g.c:\"expense\"===this.crmType?b.j:void 0},getFieldList:function(e){var t=this;if(0==this.fieldList.length||e){this.loading=!0;var s={};this.isSeas?this.poolId&&(s.poolId=this.poolId):s.label=l.default[this.crmType],(this.isSeas?u.z:u.A)(s).then(function(e){for(var s=[],i=[],a=0;a<e.data.length;a++){var n=e.data[a],l=0;l=n.width?n.width:n.name&&n.name.length<=6?15*n.name.length+45:140,\"floatnumber\"===n.formType&&i.push(n.fieldName||\"\"),s.push({prop:n.fieldName,label:n.name,width:l,sortId:n.id})}t.moneyFields=i,t.fieldList=s,t.getList()}).catch(function(){t.loading=!1})}else this.getList()},fieldFormatter:function(e,t,s){return this.moneyFields.includes(t.property)?Object(k.h)(e[t.property]||0):\"isTransform\"===t.property?[\"否\",\"是\"][s]||\"--\":\"\"===e[t.property]||null===e[t.property]?\"--\":e[t.property]},crmSearch:function(e){this.currentPage=1,this.search=e,this.fieldList.length&&this.getList()},handleRowClick:function(e,t,s){if(\"selection\"!==t.type){if(\"leads\"===this.crmType)\"leadsName\"===t.property?(this.rowID=e.leadsId,this.rowType=\"leads\",this.showDview=!0):this.showDview=!1;else if(\"customer\"===this.crmType){if(\"businessCheck\"===t.property&&e.businessCount>0)return;\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):this.showDview=!1}else\"contacts\"===this.crmType?\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"name\"===t.property?(this.rowID=e.contactsId,this.rowType=\"contacts\",this.showDview=!0):this.showDview=!1:\"business\"===this.crmType?\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"businessName\"===t.property?(this.rowID=e.businessId,this.rowType=\"business\",this.showDview=!0):this.showDview=!1:\"contract\"===this.crmType?\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"businessName\"===t.property?(this.rowID=e.businessId,this.rowType=\"business\",this.showDview=!0):\"contactsName\"===t.property?(this.rowID=e.contactsId,this.rowType=\"contacts\",this.showDview=!0):\"num\"===t.property?(this.rowID=e.contractId,this.rowType=\"contract\",this.showDview=!0):this.showDview=!1:\"product\"===this.crmType?\"name\"===t.property?(this.rowID=e.productId,this.showDview=!0):this.showDview=!1:\"receivables\"===this.crmType?\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"contractNum\"===t.property?(this.rowID=e.contractId,this.rowType=\"contract\",this.showDview=!0):\"number\"===t.property?(this.rowID=e.receivablesId,this.rowType=\"receivables\",this.showDview=!0):this.showDview=!1:\"visit\"==this.crmType?\"visitNumber\"===t.property?(this.rowID=e.visitId,this.rowType=\"visit\",this.showDview=!0):\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"contractNum\"===t.property?(this.rowID=e.contractId,this.rowType=\"contract\",this.showDview=!0):\"contactsName\"===t.property?(this.rowID=e.contactsId,this.rowType=\"contacts\",this.showDview=!0):this.showDview=!1:\"expense\"==this.crmType&&(\"expenseNum\"===t.property?(\"0\"==e.hasExamine?(this.rowType=\"expense\",this.rowID=e.expenseId):(this.rowType=\"expense-examines\",this.rowID=e.examineId),this.showDview=!0):\"customerName\"===t.property?(this.rowID=e.customerId,this.rowType=\"customer\",this.showDview=!0):\"contractNum\"===t.property?(this.rowID=e.contractId,this.rowType=\"contract\",this.showDview=!0):\"businessName\"===t.property?(this.rowID=e.businessId,this.rowType=\"business\",this.showDview=!0):this.showDview=!1);this.showDview&&this.$store.commit(\"SET_COLLAPSE\",this.showDview)}},exportInfos:function(){var e={search:this.search,type:this.isSeas?l.default.pool:l.default[this.crmType]};this.sceneId&&(e.sceneId=this.sceneId),this.poolId&&(e.poolId=this.poolId),this.filterObj&&this.filterObj.length>0&&(e.searchList=this.filterObj);var t=void 0;t=this.isSeas?d.q:{customer:d.f,leads:h.c,contacts:p.c,business:m.c,contract:f.c,receivables:y.b,product:v.c,expense:b.g}[this.crmType];var s=w.Loading.service({fullscreen:!0,text:\"导出中...\"});t(e).then(function(e){Object(x.c)(e),s.close()}).catch(function(){s.close()})},handleFilter:function(e){this.filterObj=e;var t=document.documentElement.clientHeight,s=this.filterObj.length>0?295:235;this.tableHeight=t-s,this.currentPage=1,this.getList()},handleScene:function(e){this.sceneId=e.id,this.sceneName=e.name,this.currentPage=1,this.getFieldList()},handleHandle:function(e){this.getList()},setSave:function(){this.getFieldList(!0)},listHeadHandle:function(e){\"save-success\"!==e.type&&\"import-crm\"!==e.type||(this.currentPage=1,this.getList())},sortChange:function(e,t,s){this.currentPage=1,this.sortData=e,this.getList()},handleSelectionChange:function(e){this.selectionList=e,this.$refs.crmTableHead.headSelectionChange(e)},handleHeaderDragend:function(e,t,s,i){if(s.property){var a,n=null;if(this.fieldList.forEach(function(e){s.property===e.prop&&(a=e.sortId)}),!a)return;var l={id:a,width:e,field:s.property};if(this.isSeas){if(!this.poolId)return;n=u.l,l.poolId=this.poolId}else n=u.h;n(l).then(function(e){}).catch(function(){})}},handleSizeChange:function(e){C.a.set(\"crmPageSizes\",e),this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getStatusStyle:function(e){return{backgroundColor:this.getStatusColor(e)}},toggleStar:function(e){var t=this;this.loading=!0;var s={leads:h.l,customer:d.V,contacts:p.n,business:m.t}[this.crmType],i={};i.id=e[this.crmType+\"Id\"],s(i).then(function(){t.loading=!1,t.$message.success(e.star>0?\"取消关注成功\":\"关注成功\"),e.star=e.star>0?0:1}).catch(function(){t.loading=!1})},updateTableHeight:function(){var e=document.documentElement.clientHeight,t=this.filterObj.length>0?285:235;this.tableHeight=e-t}},beforeDestroy:function(){}}},\"5XBl\":function(e,t,s){e.exports=s.p+\"static/img/board.e62f270.png\"},\"5pSV\":function(e,t,s){\"use strict\";var i=s(\"Rq8O\");s.n(i).a},\"5ttW\":function(e,t,s){\"use strict\";var i=s(\"NFCg\");s.n(i).a},\"68y1\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"4XAY\"),a=s(\"ZoMv\"),n=s(\"7Qib\"),l=s(\"t2rG\"),o={name:\"FieldSet\",components:{Draggable:s.n(l).a},props:{crmType:String,isSeas:{type:Boolean,default:!1},poolId:[String,Number]},data:function(){return{loading:!1,show:!1,poolConfig:1,fields:[],copyfields:[],search:\"\"}},computed:{},watch:{show:function(e){e&&this.getList()},poolId:function(){this.fields=[]}},mounted:function(){},beforeDestroy:function(){},methods:{getList:function(){var e=this;this.loading=0==this.fields.length;var t=null,s={};this.isSeas?(t=i.n,s.poolId=this.poolId):(t=i.j,s.label=a.default[this.crmType]),t(s).then(function(t){e.poolConfig=t.data.poolConfig;var s=t.data.value.map(function(e,t){return e.left=\"\",e.center=\"\",e.right=\"\",e.check=!0,e}),i=t.data.hideValue.map(function(e,t){return e.left=\"\",e.center=\"\",e.right=\"\",e.check=!1,e});e.fields=s.concat(i),e.copyfields=Object(n.t)(e.fields),e.loading=!1}).catch(function(){e.loading=!1})},searchClick:function(){var e=this;this.fields=this.fields.map(function(t){var s=t.name.indexOf(e.search);if(-1!=s){t.left=t.name.substr(0,s),t.center=t.name.substr(s,e.search.length);var i=s+e.search.length;t.right=t.name.substr(i,t.name.length-i)}else t.left=\"\",t.center=\"\",t.right=\"\";return t})},save:function(){var e=this,t=this.fields.filter(function(e){return e.check});if(t.length<2)this.$message.error(\"至少要显示两列\");else{var s=this.fields.filter(function(e){return!e.check});this.loading=!0;var n=null,l={noHideIds:t.map(function(e){return e.id}),hideIds:s.map(function(e){return e.id})};this.isSeas?(n=i.m,l.poolId=this.poolId):(n=i.i,l.label=a.default[this.crmType]),n(l).then(function(t){e.$message.success(\"操作成功\"),e.show=!1,e.loading=!1,e.$emit(\"change\")}).catch(function(){e.loading=!1})}},reSet:function(){this.fields=Object(n.t)(this.copyfields)}}},c=(s(\"SYA5\"),s(\"KHd+\")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-popover\",{attrs:{\"popper-class\":\"no-padding-popover\",placement:\"bottom\",width:\"240\",trigger:\"click\"},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[s(\"div\",{staticClass:\"field-set\"},[s(\"el-input\",{staticClass:\"field-set__search\",attrs:{placeholder:\"搜索字段\"},on:{input:e.searchClick},model:{value:e.search,callback:function(t){e.search=t},expression:\"search\"}}),e._v(\" \"),s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticClass:\"field-set__content\"},[s(\"draggable\",{attrs:{options:{dragClass:\"sortable-drag\",forceFallback:!1}},model:{value:e.fields,callback:function(t){e.fields=t},expression:\"fields\"}},e._l(e.fields,function(t,i){return s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:1!=e.poolConfig&&\"poolDay\"!==t.fieldName||1==e.poolConfig,expression:\"(poolConfig != 1 && item.fieldName !== 'poolDay') || poolConfig == 1\"}],key:i,staticClass:\"field-set__content--item text-one-line\"},[s(\"el-switch\",{model:{value:t.check,callback:function(s){e.$set(t,\"check\",s)},expression:\"item.check\"}}),e._v(\" \"),t.center?s(\"span\",[e._v(e._s(t.left)),s(\"span\",{staticClass:\"input-word\"},[e._v(e._s(t.center))]),e._v(e._s(t.right))]):s(\"span\",[e._v(e._s(t.name))])],1)}))],1),e._v(\" \"),s(\"div\",{staticClass:\"field-set__ft\"},[s(\"el-button\",{attrs:{type:\"text\"},on:{click:e.reSet}},[e._v(\"重置\")]),e._v(\" \"),s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.save}},[e._v(\"保存\")])],1)],1),e._v(\" \"),e.$slots.reference?e._t(\"default\",null,{slot:\"reference\"}):s(\"i\",{staticClass:\"wk wk-config table-set\",attrs:{slot:\"reference\"},on:{click:function(t){e.show=!e.show}},slot:\"reference\"})],2)},[],!1,null,\"57b286b4\",null);r.options.__file=\"index.vue\";t.default=r.exports},\"6ce6\":function(e,t,s){},\"6pZM\":function(e,t,s){e.exports=s.p+\"static/img/check_wait.81cfb8e.png\"},\"77fj\":function(e,t,s){\"use strict\";var i=s(\"Btlj\");s.n(i).a},\"85i7\":function(e,t,s){},\"94wX\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"ZoMv\"),l=s(\"L2JU\"),o=s(\"4XAY\"),c={name:\"SceneList\",components:{},props:{crmType:{type:String,default:\"\"}},data:function(){return{sceneSelectId:-1,sceneList:[]}},computed:a()({},Object(l.b)([\"crm\"])),watch:{},mounted:function(){this.crm[this.crmType].index&&this.getSceneList()},methods:{getSceneList:function(){var e=this;Object(o.s)({type:n.default[this.crmType]}).then(function(t){var s=t.data.filter(function(e,t){return 1===e.isDefault});if(s&&s.length>0){var i=s[0];e.sceneSelectId=i.sceneId,e.$emit(\"scene\",{id:i.sceneId,name:i.name,bydata:i.bydata||\"\"})}else e.sceneSelectId=\"\",e.$emit(\"scene\",{id:\"\",name:\"\",bydata:\"\"});e.sceneList=t.data}).catch(function(){e.$emit(\"scene\",{id:\"\",name:\"\",bydata:\"\"})})},selectScene:function(e,t){this.sceneSelectId=e.sceneId,this.$emit(\"scene\",{id:e.sceneId,name:e.name,bydata:e.bydata}),this.$emit(\"hidden-scene\")},addScene:function(){this.$emit(\"scene-handle\",{type:\"add\"})},setScene:function(){this.$emit(\"scene-handle\",{type:\"set\"})}}},r=(s(\"4A6M\"),s(\"KHd+\")),u=Object(r.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"scene-container\"},[s(\"div\",{staticClass:\"scene-list\"},e._l(e.sceneList,function(t,i){return s(\"div\",{key:i,staticClass:\"scene-list-item\",class:{\"scene-list-item-select\":t.sceneId==e.sceneSelectId},on:{click:function(s){e.selectScene(t,i)}}},[e._v(\"\\n      \"+e._s(t.name)+\"\\n    \")])})),e._v(\" \"),s(\"div\",{staticClass:\"handle-interval\"},[s(\"flexbox\",{staticClass:\"handle-button\",nativeOn:{click:function(t){return e.addScene(t)}}},[s(\"i\",{staticClass:\"wk wk-add handle-button-icon\"}),e._v(\" \"),s(\"div\",{staticClass:\"handle-button-name\"},[e._v(\"新建场景\")])]),e._v(\" \"),s(\"flexbox\",{staticClass:\"handle-button\",nativeOn:{click:function(t){return e.setScene(t)}}},[s(\"i\",{staticClass:\"wk wk-manage handle-button-icon\"}),e._v(\" \"),s(\"div\",{staticClass:\"handle-button-name\"},[e._v(\"管理\")])])],1)])},[],!1,null,\"db45760c\",null);u.options.__file=\"SceneList.vue\";t.default=u.exports},\"9cPJ\":function(e,t,s){e.exports=s.p+\"static/img/visit.ffb589c.png\"},AVjW:function(e,t,s){\"use strict\";var i=s(\"gIBH\");s.n(i).a},BRlT:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"t3Un\");var l=s(\"1bNe\"),o=s(\"7Qib\"),c=s(\"L2JU\"),r={name:\"NearbyIndex\",components:{ChangeAddress:function(){return s.e(\"chunk-6eb1\").then(s.bind(null,\"oVWf\"))},CustomerDetail:l.default},props:{},data:function(){return{map:null,radiusSelectWidth:100,showTypePopover:!1,showCustomContent:!1,selectType:{},currentId:-1,changeAddressShow:!1,address:\"\",mapList:[],markerArr:[],loading:!0,circle:null,memterOptions:[{label:\"1千米\",value:\"1000\"},{label:\"3千米\",value:\"3000\"},{label:\"5千米\",value:\"5000\"},{label:\"10千米\",value:\"10000\"}],centerPoint:{},mapData:{radius:\"1000\",type:\"\"},mapHeight:document.documentElement.clientHeight-210,typeOptions:[{value:\"\",label:\"全部\"},{value:2,label:\"客户\"},{value:9,label:\"公海\"}],showDview:!1,rowID:null}},computed:a()({},Object(c.b)([\"crm\"]),{menuItems:function(){var e=[];return this.crm&&this.crm.customer&&e.push({title:\"客户\",path:\"customer\",icon:s(\"cLla\")}),this.crm&&this.crm.pool&&e.push({title:\"公海\",path:\"seas\",icon:s(\"goM+\")}),this.crm&&this.crm.customer&&this.crm.customer.nearbyCustomer&&e.push({title:\"附近客户\",path:\"nearby\",icon:s(\"t4Dm\")}),e}}),watch:{},mounted:function(){var e=this;Object(o.l)().then(function(){var t=new BMap.Map(\"choicemap\"),s=new BMap.Point(116.404,39.915);t.centerAndZoom(s,14),t.enableScrollWheelZoom(!0),e.map=t,e.centerPoint=s,e.getMyPosition()})},deactivated:function(){this.$refs.elMenu.activeIndex=\"nearby\"},methods:{menuSelect:function(e,t){this.$emit(\"menu-select\",e,t)},getMyPosition:function(){(new BMap.LocalCity).get(this.getFirstPosition)},getFirstPosition:function(e){this.centerPoint=e.center,this.address=e.name,this.getMapInfo()},radiusChange:function(e){e?(this.mapData.radius=e.value,this.selectType=e,this.showCustomContent=!1):this.showCustomContent=!0,this.getMapInfo(),this.showTypePopover=!1},getMapInfo:function(){var e=this;this.loading=!0,this.map.clearOverlays();var t,s=a()({},this.mapData);s.lat=this.centerPoint.lat,s.lng=this.centerPoint.lng,(t=s,Object(n.a)({url:\"crmCustomer/nearbyCustomer\",method:\"post\",data:t})).then(function(t){e.mapList=t.data,e.addMarkerLabel(),e.setCircle(),e.loading=!1}).catch(function(){e.loading=!1})},selectAddress:function(e){var t=this.map.getOverlays();this.currentId=e.customerId;for(var s=0;s<t.length;s++){var i=t[s];\"ComplexCustomOverlay\"===i._type&&(i._customerId===e.customerId?(this.map.centerAndZoom(i._point,this.map.getZoom()),i._changeOverStyle()):i._changeOutStyle())}},setCircle:function(){this.circle&&this.removeOverlay(this.circle);var e=new BMap.Circle(this.centerPoint,this.mapData.radius,{strokeColor:\"#2362FB\",fillColor:\"#2362FB\",strokeWeight:2,fillOpacity:.05,strokeOpacity:.5,strokeStyle:\"solid\"});e.setCenter(this.centerPoint),this.circle=e,this.circle.type=\"circle\",this.map.addOverlay(e),this.map.setCenter(this.centerPoint),this.map.panTo(this.centerPoint),this.map.setViewport(this.markerArr)},addMarkerLabel:function(){function e(e,t,s){this._type=\"ComplexCustomOverlay\",this._point=e,this._name=t,this._customerId=s}this.markerArr=[],e.prototype=new BMap.Overlay,e.prototype.initialize=function(e){var i=this;this._map=e;var a=this._div=document.createElement(\"div\"),n=this._span=document.createElement(\"span\");a.className=\"map-marker--custom marker--\"+this._customerId,n.className=\"map-custom--text\",a.appendChild(n),a.style.position=\"absolute\",a.style.zIndex=this._zIndex=BMap.Overlay.getZIndex(this._point.lat),a.style.color=\"white\",a.style.padding=\"2px\",a.style.whiteSpace=\"nowrap\",a.style.MozUserSelect=\"none\",a.style.fontSize=\"12px\",n.innerHTML=this._name,a.appendChild(n);var l=this._arrow=document.createElement(\"div\");l.style.background=\"url(\"+s(\"FM4U\")+\") no-repeat\",l.style.position=\"absolute\",l.style.width=\"20px\",l.style.height=\"15px\",l.style.transform=\"scale(0.5)\",l.style.top=\"24px\",l.style.left=\"75px\",l.style.opacity=\"0.95\",l.style.overflow=\"hidden\",a.appendChild(l),this._changeOverStyle=function(){this._div.style.backgroundColor=\"#fba019\",this._div.style.whiteSpace=\"normal\",this._div.style.zIndex=\"1\",this._arrow.style.backgroundPosition=\"0px -20px\"},this._changeOutStyle=function(){t.currentId!==this._customerId&&(this._div.style.backgroundColor=\"#2362FB\",this._div.style.whiteSpace=\"nowrap\",this._div.style.zIndex=this._zIndex,this._arrow.style.backgroundPosition=\"0px 0px\")};var o=this;return a.onmouseover=function(){o._changeOverStyle()},a.onmouseout=function(){o._changeOutStyle()},a.onclick=function(){for(var e=null,s=0;s<t.mapList.length;s++)if(i._customerId===t.mapList[s].customerId){e=t.mapList.splice(s,1),t.mapList.unshift(e[0]),t.$refs.nearbyList.scrollTop=0,t.selectAddress(e[0]);break}},t.map.getPanes().labelPane.appendChild(a),a},e.prototype.draw=function(){var e=this._map.pointToOverlayPixel(this._point);this._div.style.left=e.x-parseInt(this._arrow.style.left)-10+\"px\",this._div.style.top=e.y-30+\"px\"};var t=this;this.mapList.forEach(function(s){var i=new BMap.Point(s.lng,s.lat),a=new e(i,s.customerName,s.customerId);t.markerArr.push(i),t.map.addOverlay(a)})},removeOverlay:function(e){for(var t=this.map.getOverlays(),s=0;s<t.length;s++)t[s].type==e.type&&this.map.removeOverlay(t[s])},handleSelect:function(e){this.centerPoint=e.point,this.address=e.address+e.title,this.getMapInfo()},checkCustomerDetail:function(e){this.rowID=e,this.showDview=!0}}},u=(s(\"wjQc\"),s(\"KHd+\")),d=Object(u.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"map-box\"},[i(\"div\",{staticClass:\"map-title\"},[i(\"el-menu\",{ref:\"elMenu\",attrs:{\"default-active\":\"nearby\",mode:\"horizontal\",\"active-text-color\":\"#2362FB\"},on:{select:e.menuSelect}},e._l(e.menuItems,function(t,a){return i(\"el-menu-item\",{key:a,attrs:{index:t.path}},[i(\"img\",{attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:t.icon}}),e._v(\" \"),i(\"span\",[e._v(e._s(t.title))])])}))],1),e._v(\" \"),i(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticClass:\"map-content\"},[i(\"flexbox\",{staticClass:\"map-content--title\",attrs:{align:\"stretch\"}},[i(\"flexbox-item\",[i(\"div\",{staticClass:\"title--position\"},[i(\"span\",{staticClass:\"wk wk-position\"}),e._v(\" \"),i(\"el-tooltip\",{staticClass:\"item\",attrs:{content:e.address,effect:\"dark\",placement:\"top-start\"}},[i(\"span\",{staticClass:\"title--address\"},[e._v(e._s(e.address))])])],1),e._v(\" \"),i(\"el-button\",{staticClass:\"el-button--text\",attrs:{type:\"text\"},on:{click:function(t){e.changeAddressShow=!0}}},[e._v(\"重新选择地址\")]),e._v(\" \"),i(\"span\",{staticClass:\"place-text\"},[e._v(\"附近 \")]),e._v(\" \"),i(\"el-popover\",{attrs:{width:e.radiusSelectWidth,placement:\"bottom\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:e.showTypePopover,callback:function(t){e.showTypePopover=t},expression:\"showTypePopover\"}},[i(\"div\",{staticClass:\"type-popper\"},[i(\"div\",{staticClass:\"type-content\"},[e._l(e.memterOptions,function(t,s){return i(\"div\",{key:s,staticClass:\"type-content-item\",class:{selected:e.selectType.value==t.value&&!e.showCustomContent},on:{click:function(s){e.radiusChange(t)}}},[i(\"div\",{staticClass:\"mark\"}),e._v(e._s(t.label)+\"\\n              \")])}),e._v(\" \"),i(\"div\",{staticClass:\"type-content-item\",class:{selected:e.showCustomContent},on:{click:function(t){e.showCustomContent=!0}}},[i(\"div\",{staticClass:\"mark\"}),e._v(\"自定义\\n              \")])],2),e._v(\" \"),e.showCustomContent?i(\"div\",{staticClass:\"type-content-custom\"},[i(\"el-input\",{model:{value:e.mapData.radius,callback:function(t){e.$set(e.mapData,\"radius\",t)},expression:\"mapData.radius\"}}),e._v(\" \"),i(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(t){e.radiusChange(null)}}},[e._v(\"确定\")])],1):e._e()]),e._v(\" \"),i(\"el-input\",{staticClass:\"type-select\",style:{width:e.radiusSelectWidth+\"px\"},attrs:{slot:\"reference\",readonly:!0},slot:\"reference\",model:{value:e.mapData.radius,callback:function(t){e.$set(e.mapData,\"radius\",t)},expression:\"mapData.radius\"}},[i(\"i\",{class:[\"el-icon-arrow-up\",{\"is-reverse\":e.showTypePopover}],attrs:{slot:\"suffix\"},slot:\"suffix\"})])],1),e._v(\" \"),i(\"span\",{staticClass:\"place-text\"},[e._v(\" 米的客户\")])],1),e._v(\" \"),i(\"div\",{staticClass:\"title--right\"},[i(\"label\",{staticClass:\"title-label\"},[e._v(\"客户类型： \")]),e._v(\" \"),i(\"el-select\",{on:{change:e.getMapInfo},model:{value:e.mapData.type,callback:function(t){e.$set(e.mapData,\"type\",t)},expression:\"mapData.type\"}},e._l(e.typeOptions,function(e){return i(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(\" \"),i(\"flexbox\",{staticClass:\"box-content\",attrs:{align:\"stretch\"}},[i(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:e.mapList,expression:\"mapList\"}],staticClass:\"map-content--left\",attrs:{\"xs-empty-icon\":\"none\"}},[i(\"div\",{attrs:{id:\"map-scroll\"}},[i(\"ul\",{ref:\"nearbyList\",style:{height:e.mapHeight+\"px\"}},e._l(e.mapList,function(t,s){return i(\"li\",{key:s,staticClass:\"map-info--box\",style:{backgroundColor:t.customerId===e.currentId?\"#f7f7f7\":\"\"},on:{click:function(s){e.selectAddress(t)}}},[i(\"span\",{staticClass:\"wk wk-location\"}),e._v(\" \"),i(\"div\",{staticClass:\"map-box--content\"},[i(\"div\",{staticClass:\"map-info--name\"},[i(\"el-tooltip\",{staticClass:\"item\",attrs:{content:t.customerName,effect:\"dark\",placement:\"top-start\"}},[i(\"div\",{staticClass:\"map-customer-name can-visit--underline\",on:{click:function(s){s.stopPropagation(),e.checkCustomerDetail(t.customerId)}}},[e._v(e._s(t.customerName))])])],1),e._v(\" \"),i(\"div\",{staticClass:\"map-info--content\"},[e._v(\"负责人: \"+e._s(t.ownerUserName))]),e._v(\" \"),i(\"div\",{staticClass:\"map-info--content\",attrs:{title:t.detailAddress}},[e._v(e._s(t.detailAddress))]),e._v(\" \"),i(\"div\",{staticClass:\"map-info--content\"},[e._v(\"距离选择地址: \"+e._s(t.distance/1e3)+\" km\")])])])}))])]),e._v(\" \"),i(\"flexbox-item\",{staticClass:\"map-primity\",style:{height:e.mapHeight+\"px\"}},[i(\"div\",{staticClass:\"map\",attrs:{id:\"choicemap\"}})])],1)],1),e._v(\" \"),i(\"change-address\",{attrs:{show:e.changeAddressShow,value:e.centerPoint},on:{select:e.handleSelect,close:function(t){e.changeAddressShow=!1}}}),e._v(\" \"),e.showDview?i(\"customer-detail\",{staticClass:\"d-view\",attrs:{id:e.rowID,\"no-listener-class\":[\"map-customer-name\"]},on:{\"hide-view\":function(t){e.showDview=!1}}}):e._e()],1)},[],!1,null,\"e055d50c\",null);d.options.__file=\"index.vue\";t.default=d.exports},Bd1s:function(e,t,s){\"use strict\";var i=s(\"08m3\");s.n(i).a},Btlj:function(e,t,s){},BzA1:function(e,t,s){\"use strict\";s.r(t);var i=s(\"a/5N\"),a={name:\"ImportInfo\",components:{},props:{list:Array},data:function(){return{}},computed:{showList:function(){return this.list.filter(function(e){return\"file\"!==e.formType})}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{getValueContent:function(e){if(\"map_address\"===e.formType)return e.value?e.value.detailAddress:\"\";if(\"structure\"===e.formType||\"user\"===e.formType||\"checkbox\"===e.formType){if(Object(i.a)(e.value)){var t={structure:\"name\",user:\"realname\",checkbox:\"\"}[e.formType];return e.value.map(function(e){return t?e[t]:e}).join(\"，\")}return\"\"}if(\"single_user\"===e.formType)return Object(i.c)(e.value)&&e.value.realname?e.value.realname:\"\";if(\"customer\"===e.formType||\"business\"===e.formType||\"contract\"===e.formType||\"contacts\"===e.formType||\"category\"===e.formType||\"statusName\"===e.formType||\"typeName\"===e.formType){var s={customer:\"customerName\",business:\"businessName\",contract:\"contractNum\",contacts:\"contactsName\",category:\"categoryName\",statusName:\"statusName\",typeName:\"typeName\"}[e.formType];return Object(i.a)(e.value)?e.value.length>0?e.value[0][s]:\"\":e.value?e.value[s]:\"\"}return e.value}}},n=(s(\"AVjW\"),s(\"KHd+\")),l=Object(n.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"content\"},[s(\"div\",{staticClass:\"content-title\"},[e._v(\"基本信息\")]),e._v(\" \"),e._l(e.showList,function(t,i){return s(\"p\",{key:i,staticClass:\"detail-cell\"},[s(\"span\",{staticClass:\"detail-cell__label\"},[e._v(\"\\n      \"+e._s(t.name)+\"\\n    \")]),s(\"br\"),e._v(\" \"),s(\"span\",{staticClass:\"detail-cell__value\"},[e._v(\"\\n      \"+e._s(e.getValueContent(t))+\"\\n    \")])])})],2)},[],!1,null,\"74c3ac7c\",null);l.options.__file=\"ImportInfo.vue\";t.default=l.exports},C3Po:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"8GhS\"),l=s(\"zsVz\"),o={name:\"TaskQuickAdd\",components:{XhUserCell:n.p},props:{params:Object},data:function(){return{sendLoading:!1,isUnfold:!1,sendContent:\"\",sendStopTime:\"\",mainUser:[]}},computed:{createMainUser:function(){return this.mainUser&&this.mainUser.length?this.mainUser[0]:null}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{inputFocus:function(){var e=this;this.$emit(\"focus\"),this.isUnfold=!0,this.$nextTick(function(){e.$refs.input.focus()})},selectMainUser:function(e){this.mainUser=e.value},send:function(){var e=this;if(this.sendContent.length){this.sendLoading=!0;var t={name:this.sendContent,stopTime:this.sendStopTime,mainUserId:this.createMainUser?this.createMainUser.userId:\"\"};this.params&&(t=a()({},t,this.params)),Object(l.e)(t).then(function(t){e.sendLoading=!1,e.$message.success(\"新建成功\"),e.resetSendData(),e.$emit(\"send\")}).catch(function(){e.sendLoading=!1})}else this.$message.error(\"请填写任务标题\")},resetSendData:function(){this.sendContent=\"\",this.sendStopTime=\"\",this.mainUser=[],this.isUnfold=!1},addClose:function(){this.isUnfold=!1}}},c=(s(\"5pSV\"),s(\"KHd+\")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.sendLoading,expression:\"sendLoading\"}],staticClass:\"task-quick-add\",class:[\"add\",{unfold:e.isUnfold,\"is-close\":!e.isUnfold}]},[e.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:e.addClose}}):e._e(),e._v(\" \"),s(\"el-input\",{ref:\"input\",staticClass:\"input\",attrs:{maxlength:100,\"prefix-icon\":e.isUnfold?\"\":\"el-icon-plus\",placeholder:\"添加任务\"},on:{focus:e.inputFocus},model:{value:e.sendContent,callback:function(t){e.sendContent=t},expression:\"sendContent\"}}),e._v(\" \"),s(\"flexbox\",{staticClass:\"add-info\"},[s(\"el-date-picker\",{ref:\"endTime\",class:{\"no-time-top\":!e.sendStopTime},attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"\"},model:{value:e.sendStopTime,callback:function(t){e.sendStopTime=t},expression:\"sendStopTime\"}}),e._v(\" \"),s(\"xh-user-cell\",{attrs:{value:e.mainUser,radio:\"\",placement:\"top\"},on:{\"value-change\":e.selectMainUser}},[s(\"div\",{staticClass:\"select-user\",attrs:{slot:\"reference\"},slot:\"reference\"},[e.createMainUser?s(\"xr-avatar\",{attrs:{name:e.createMainUser.realname,size:24,src:e.createMainUser.img}}):s(\"i\",{staticClass:\"wk wk-persons add-info--person\"})],1)])],1),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.send,expression:\"send\"}],staticClass:\"send-btn\",attrs:{icon:\"wk wk-top\",type:\"primary\"}},[e._v(\"发布\")])],1)},[],!1,null,\"38430333\",null);r.options.__file=\"TaskQuickAdd.vue\";t.default=r.exports},\"E/pc\":function(e,t,s){\"use strict\";var i=s(\"fpBj\");s.n(i).a},EFFI:function(e,t,s){\"use strict\";var i=s(\"oSbd\");s.n(i).a},FD7p:function(e,t,s){},FM4U:function(e,t,s){e.exports=s.p+\"static/img/nearby_bg.866658c.png\"},\"FT/l\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"L2JU\"),l=s(\"7Dod\"),o={name:\"BusinessCheck\",components:{},props:{show:Boolean,data:{type:Object,default:function(){return{row:{name:\"\"}}}}},data:function(){return{loading:!1,list:[],fieldList:[]}},computed:a()({},Object(n.b)([\"crm\"]),{canShowIndex:function(){return this.crm.business&&this.crm.business.index}}),watch:{show:{handler:function(e){this.canShowIndex&&e&&this.data.row&&this.data.row.businessCount>0&&0==this.list.length&&this.getDetail()},deep:!0,immediate:!0}},mounted:function(){this.fieldList.push({prop:\"businessName\",width:\"200\",label:\"商机名称\"}),this.fieldList.push({prop:\"money\",width:\"200\",label:\"商机金额\"}),this.fieldList.push({prop:\"customerName\",width:\"200\",label:\"客户名称\"}),this.fieldList.push({prop:\"typeName\",width:\"200\",label:\"商机状态组\"}),this.fieldList.push({prop:\"statusName\",width:\"200\",label:\"状态\"})},methods:{getDetail:function(){var e=this;this.loading=!0,Object(l.G)({pageType:0,customerId:this.data.row.customerId}).then(function(t){e.loading=!1,e.list=t.data.list}).catch(function(){e.loading=!1})},hidenView:function(){document.querySelector(\"#app\").click(),this.$emit(\"close\",this.$el,this.data)},handleRowClick:function(e,t,s){this.$emit(\"click\",e)},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{fontSize:\"12px\",textAlign:\"center\",cursor:\"pointer\"}},headerCellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{fontSize:\"12px\",textAlign:\"center\"}}}},c=(s(\"EFFI\"),s(\"KHd+\")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:!e.canShowIndex,expression:\"!canShowIndex\"}],staticClass:\"container\",attrs:{\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"}},[s(\"div\",{staticClass:\"header\"},[s(\"i\",{staticClass:\"wk wk-customer\"}),e._v(\" \"),s(\"span\",{staticClass:\"name\"},[e._v(e._s(e.data.row.customerName))]),e._v(\" \"),s(\"span\",{staticClass:\"detail\"},[e._v(e._s(\"商机个数：（\"+e.list.length+\"）个\"))]),e._v(\" \"),s(\"i\",{staticClass:\"el-icon-close close\",on:{click:e.hidenView}})]),e._v(\" \"),s(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{\"margin-right\":\"3px\"},attrs:{data:e.list,\"cell-style\":e.cellStyle,\"header-cell-style\":e.headerCellStyle,height:\"250\",stripe:\"\",\"highlight-current-row\":\"\"},on:{\"row-click\":e.handleRowClick}},e._l(e.fieldList,function(e,t){return s(\"el-table-column\",{key:t,attrs:{prop:e.prop,label:e.label,align:\"center\",\"header-align\":\"center\",\"show-overflow-tooltip\":\"\"}})}))],1)},[],!1,null,\"ad617234\",null);r.options.__file=\"BusinessCheck.vue\";t.default=r.exports},FyZu:function(e,t,s){\"use strict\";s.r(t);var i=s(\"7Dod\"),a=s(\"ZoMv\"),n={name:\"DuplicateCheck\",components:{CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-66f9\"),s.e(\"chunk-63bb\"),s.e(\"chunk-7029\"),s.e(\"chunk-6435\"),s.e(\"chunk-5a74\")]).then(s.bind(null,\"3z7q\"))}},props:{visible:{type:Boolean,default:!1}},data:function(){return{loading:!1,typeSelect:\"name\",searchContent:\"\",tableData:null,showFullDetail:!1,relationID:\"\",relationCrmType:\"\"}},computed:{poolType:function(){return a.default.pool},showTable:function(){return this.tableData},isCustomerFilter:function(){return\"name\"==this.typeSelect},fieldList:function(){return this.isCustomerFilter?[{prop:\"name\",label:\"客户名称\",width:200},{prop:\"createTime\",label:\"创建时间\",width:160},{prop:\"ownerUserName\",label:\"负责人\",width:100},{prop:\"lastTime\",label:\"最后跟进时间\",width:160},{prop:\"module\",label:\"模块\",width:100}]:[{prop:\"mobile\",label:\"手机号/电话\",width:160},{prop:\"contactsName\",label:\"联系人\",width:160},{prop:\"name\",label:\"客户名称\",width:200},{prop:\"ownerUserName\",label:\"负责人\",width:100},{prop:\"module\",label:\"模块\",width:100}]}},watch:{typeSelect:function(){this.searchContent=\"\",this.tableData=null}},mounted:function(){},methods:{handleClose:function(){this.$emit(\"update:visible\",!1),this.resetData()},resetData:function(){this.typeSelect=\"name\",this.searchContent=\"\",this.tableData=null},getList:function(){var e=this;if(this.searchContent){var t={};t[this.typeSelect]=this.searchContent,this.loading=!0,Object(i.a)(t).then(function(t){e.loading=!1;var s=t.data||[];e.tableData=s.map(function(t){return t.module=a.default.convertTypeToName(t.type),t.poolName&&(t.module=t.module+\"（\"+t.poolName+\"）\"),e.isCustomerFilter||(t.mobile=e.searchContent,t.type==a.default.contacts&&(t.contactsName=t.name,t.contactsId=t.id,t.name=t.customerName,t.id=t.customerId,t.type=a.default.customer)),t})}).catch(function(){e.loading=!1})}},handleRowClick:function(e,t,s){if(\"name\"==t.property&&e.id){this.relationID=e.id;var i=a.default.convertTypeToKey(e.type);this.relationCrmType=\"pool\"==i?\"customer\":i,this.showFullDetail=!0}else\"contactsName\"==t.property&&e.contactsId&&(this.relationID=e.contactsId,this.relationCrmType=\"contacts\",this.showFullDetail=!0)},cellClassName:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return\"name\"===t.property||\"contactsName\"===t.property?\"can-visit--underline\":\"\"},handleClick:function(e){var t=this;this.$confirm(\"确定要领取该客户吗?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.P)({ids:[e.id]}).then(function(e){t.getList()}).catch(function(){})}).catch(function(){})}}},l=(s(\"zowB\"),s(\"KHd+\")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,\"before-close\":e.handleClose,title:\"客户查重\",\"custom-class\":\"no-padding-dialog\",width:\"800px\"},on:{\"update:visible\":function(t){e.visible=t}}},[s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticClass:\"duplicate-check\",class:{\"show-table\":e.showTable}},[s(\"div\",[s(\"el-input\",{staticClass:\"search-input\",nativeOn:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.getList(t):null}},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:\"searchContent\"}},[s(\"el-select\",{attrs:{slot:\"prepend\"},slot:\"prepend\",model:{value:e.typeSelect,callback:function(t){e.typeSelect=t},expression:\"typeSelect\"}},[s(\"el-option\",{attrs:{label:\"按客户名称\",value:\"name\"}}),e._v(\" \"),s(\"el-option\",{attrs:{label:\"按手机号/电话\",value:\"phone\"}})],1),e._v(\" \"),s(\"el-button\",{attrs:{slot:\"append\",type:\"primary\",icon:\"wk wk-search\"},nativeOn:{click:function(t){return e.getList(t)}},slot:\"append\"},[e._v(\"查重\")])],1)],1),e._v(\" \"),e.showTable?s(\"el-table\",{staticClass:\"duplicate-check__content\",staticStyle:{width:\"100%\"},attrs:{data:e.tableData,\"cell-class-name\":e.cellClassName,border:\"\",height:\"380\"},on:{\"row-click\":e.handleRowClick}},e._l(e.fieldList,function(e,t){return s(\"el-table-column\",{key:t,attrs:{prop:e.prop,label:e.label,\"min-width\":e.width,\"show-overflow-tooltip\":\"\"}})})):e._e(),e._v(\" \"),e.showTable?s(\"div\",{staticClass:\"duplicate-check__footer\"},[e._v(\"注：查重结果最多显示10条，如不完整，请完善查重条件\")]):e._e(),e._v(\" \"),s(\"c-r-m-full-screen-detail\",{attrs:{visible:e.showFullDetail,\"crm-type\":e.relationCrmType,id:e.relationID},on:{\"update:visible\":function(t){e.showFullDetail=t},handle:e.getList}})],1)])},[],!1,null,\"7aa3bafc\",null);o.options.__file=\"index.vue\";t.default=o.exports},GzrR:function(e,t,s){},\"I+NK\":function(e,t,s){\"use strict\";var i=s(\"PWYh\");s.n(i).a},IHka:function(e,t,s){\"use strict\";var i=s(\"iSV6\");s.n(i).a},JAjk:function(e,t,s){e.exports=s.p+\"static/img/contacts.83d4b7f.png\"},JCWM:function(e,t,s){\"use strict\";s.r(t);var i=s(\"7Dod\"),a=s(\"XJYT\"),n={name:\"PutPoolHandle\",components:{},mixins:[],props:{visible:{type:Boolean,required:!0,default:!1},id:[String,Number],selectionList:{type:Array,default:function(){return[]}}},data:function(){return{selectId:\"\",list:[]}},computed:{},watch:{list:{handler:function(){this.selectId=this.list&&this.list.length>0?this.list[0].poolId:\"\"},immediate:!0},visible:function(e){e&&0===this.list.length&&this.getList()}},mounted:function(){},methods:{getList:function(){var e=this,t=a.Loading.service({target:document.querySelector('.el-dialog[aria-label=\"放入公海\"]')});Object(i.u)().then(function(s){e.list=s.data||[],t&&t.close()}).catch(function(){t&&t.close()})},handleCancel:function(){this.$emit(\"update:visible\",!1)},handleConfirm:function(){var e=this;if(this.selectId){var t=a.Loading.service({target:document.querySelector('.el-dialog[aria-label=\"放入公海\"]')});Object(i.F)({ids:this.selectionList.map(function(e){return e.customerId}),poolId:this.selectId}).then(function(s){e.$message({type:\"success\",message:\"操作成功\"}),t.close(),e.$emit(\"handle\",{type:\"put_seas\"}),e.handleCancel()}).catch(function(){t.close()})}}}},l=(s(\"jUvl\"),s(\"KHd+\")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"放入公海\",width:\"450px\"},on:{close:e.handleCancel}},[s(\"div\",{staticClass:\"handle-box\"},[s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"公海：\")]),e._v(\" \"),s(\"el-select\",{model:{value:e.selectId,callback:function(t){e.selectId=t},expression:\"selectId\"}},e._l(e.list,function(e){return s(\"el-option\",{key:e.poolId,attrs:{label:e.poolName,value:e.poolId}})}))],1)],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1)])},[],!1,null,\"7b1cec81\",null);o.options.__file=\"PutPoolHandle.vue\";t.default=o.exports},K4QM:function(e,t,s){e.exports=s.p+\"static/img/leads_not.d26c261.png\"},KOLf:function(e,t,s){},Klv4:function(e,t,s){\"use strict\";var i=s(\"lrb+\");s.n(i).a},\"L+lS\":function(e,t,s){e.exports=s.p+\"static/img/nearby_not.016fa6f.png\"},\"La+m\":function(e,t,s){},LheQ:function(e,t,s){},M4wA:function(e,t,s){\"use strict\";var i=s(\"ehRj\");s.n(i).a},MvHO:function(e,t,s){\"use strict\";s.r(t);var i=s(\"ZoMv\"),a=s(\"4XAY\"),n=s(\"t2rG\"),l=s.n(n),o=s(\"0/jB\"),c={name:\"SceneSet\",components:{draggable:l.a,SceneCreate:o.default},props:{dialogVisible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:\"\"}},data:function(){return{defaultId:\"\",visible:!1,isleftIndeterminate:!1,checkleftAll:!1,checkedLeftData:[],leftCheckItems:[],isrightIndeterminate:!1,checkrightAll:!1,checkedRightData:[],rightCheckItems:[],moveItem:{},handlDefaultItem:{},showCreateScene:!1,fieldList:[],filterObj:{form:[]},filterName:\"\",filterDefault:!1,filterEditId:\"\"}},computed:{},watch:{dialogVisible:{handler:function(e){this.visible=e,e&&this.getSceneList()},deep:!0,immediate:!0}},mounted:function(){},methods:{getSceneList:function(){var e=this;Object(a.u)({type:i.default[this.crmType]}).then(function(t){e.checkedLeftData=t.data.value.map(function(e){return e.check=!1,e.data=e.data?JSON.parse(e.data):{},e}),e.checkedRightData=t.data.hideValue.map(function(e){return e.check=!1,e.data=e.data?JSON.parse(e.data):{},e});var s=e.checkedLeftData.filter(function(e){return 1==e.isDefault});s&&s.length>0?e.defaultId=s[0].sceneId:e.defaultId=\"\"}).catch(function(){})},handleConfirm:function(){var e=this;0==this.checkedLeftData.filter(function(t){return t.sceneId==e.defaultId}).length&&(this.defaultId=\"\"),Object(a.v)({type:i.default[this.crmType],noHideIds:this.checkedLeftData.map(function(e){return e.sceneId}),hideIds:this.checkedRightData.map(function(e){return e.sceneId})}).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.handleCancel(),e.$emit(\"save-success\")}).catch(function(){})},itemHandle:function(e,t,s){var i=this;\"edit\"==e?this.addAndEditScene(\"edit\",t):\"delete\"==e?this.$confirm(\"您确定要删除这一条数据吗?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(a.r)({sceneId:t.sceneId}).then(function(e){i.$message({type:\"success\",message:\"删除成功\"}),i.checkedLeftData.splice(s,1),i.leftCheckItemChange(),i.$emit(\"save-success\")}).catch(function(){})}).catch(function(){}):\"default\"==e&&(this.handlDefaultItem=t)},defaultHandle:function(){var e=this;Object(a.q)({sceneId:this.handlDefaultItem.sceneId}).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.defaultId=e.handlDefaultItem.sceneId}).catch(function(){})},addAndEditScene:function(e,t){var s=this;Object(a.E)({label:i.default[this.crmType]}).then(function(i){s.fieldList=i.data,\"edit\"==e?(s.filterObj={form:[],obj:t.data},s.filterName=t.name,s.filterDefault=1==t.isDefault,s.filterEditId=t.sceneId.toString()):(s.filterObj={form:[]},s.filterEditId=\"\",s.filterName=\"\",s.filterDefault=!1),s.showCreateScene=!0}).catch(function(){})},handleCancel:function(){this.visible=!1,this.$emit(\"update:dialogVisible\",!1)},rightMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},rightMove:function(e){this.moveItem=e.draggedContext.element},leftMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},leftMove:function(e){this.moveItem=e.draggedContext.element},handleleftCheckAllChange:function(e){e&&(this.isleftIndeterminate=!1),this.checkedLeftData.forEach(function(t){t.check=1!=t.isSystem&&e}),this.leftCheckItems=e?this.checkedLeftData.filter(function(e){return e.check}):[]},leftCheckItemChange:function(){this.leftCheckItems=this.checkedLeftData.filter(function(e){return 1==e.check}),this.leftCheckItems.length>0?this.leftCheckItems.length==this.checkedLeftData.length?(this.checkleftAll=!0,this.isleftIndeterminate=!1):(this.checkleftAll=!1,this.isleftIndeterminate=!0):(this.checkleftAll=!1,this.isleftIndeterminate=!1)},handlerightCheckAllChange:function(e){e&&(this.isrightIndeterminate=!1),this.checkedRightData.forEach(function(t){t.check=e}),this.rightCheckItems=e?this.checkedRightData:[]},rightCheckItemChange:function(){this.rightCheckItems=this.checkedRightData.filter(function(e){return 1==e.check}),this.rightCheckItems.length>0?this.rightCheckItems.length==this.checkedRightData.length?(this.checkrightAll=!0,this.isrightIndeterminate=!1):(this.checkrightAll=!1,this.isrightIndeterminate=!0):(this.checkrightAll=!1,this.isrightIndeterminate=!1)},changePositon:function(e){var t=this;\"left\"==e?(this.checkedRightData=this.checkedRightData.filter(function(e,s,i){var a=!1;return t.rightCheckItems.forEach(function(t,s){e.sceneId==t.sceneId&&(a=!0)}),!a}),this.rightCheckItems.forEach(function(e,s){e.check=!1,t.checkedLeftData.push(e)}),this.rightCheckItems=[],this.isrightIndeterminate=!1,this.checkrightAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange()):(this.checkedLeftData=this.checkedLeftData.filter(function(e,s,i){var a=!1;return t.leftCheckItems.forEach(function(t,s){e.sceneId==t.sceneId&&(a=!0)}),!a}),this.leftCheckItems.forEach(function(e,s){e.check=!1,t.checkedRightData.push(e)}),this.leftCheckItems=[],this.isleftIndeterminate=!1,this.checkleftAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange())}}},r=(s(\"O+M7\"),s(\"KHd+\")),u=Object(r.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"场景管理\",width:\"700px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticClass:\"scene-name\"},[e._v(\"您可通过拖拽管理标签\")]),e._v(\" \"),s(\"flexbox\",{staticClass:\"scene-list\"},[s(\"div\",{staticClass:\"scene-list-box\"},[s(\"flexbox\",{staticClass:\"scene-list-head\"},[s(\"el-checkbox\",{attrs:{indeterminate:e.isleftIndeterminate},on:{change:e.handleleftCheckAllChange},model:{value:e.checkleftAll,callback:function(t){e.checkleftAll=t},expression:\"checkleftAll\"}}),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-head-name\"},[e._v(\"显示的标签\")]),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-head-detail\"},[e._v(e._s(e.leftCheckItems.length+\"/\"+e.checkedLeftData.length))])],1),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-body\"},[e._l(e.checkedLeftData,function(t,i){return 1==t.isSystem?s(\"flexbox\",{key:i,staticClass:\"list-item\"},[s(\"div\",{staticClass:\"default-mark\",class:{\"default-mark-active\":t.sceneId==e.defaultId}}),e._v(\" \"),s(\"el-checkbox\",{staticClass:\"list-item-check\",attrs:{disabled:!0},on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(s){e.$set(t,\"check\",s)},expression:\"item.check\"}}),e._v(\" \"),s(\"div\",{staticClass:\"list-item-name\"},[e._v(e._s(t.name))]),e._v(\" \"),s(\"div\",{staticClass:\"list-item-handle\"},[s(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:e.defaultHandle}},[s(\"i\",{staticClass:\"el-icon-arrow-down\",on:{click:function(s){e.itemHandle(\"default\",t,i)}}}),e._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[s(\"el-dropdown-item\",[e._v(\"设置为默认标签\")])],1)],1)],1)],1):e._e()}),e._v(\" \"),s(\"draggable\",{staticStyle:{\"min-height\":\"100px\"},attrs:{move:e.leftMove,options:{group:\"list\",forceFallback:!1,fallbackClass:\"draggingStyle\"}},on:{end:e.leftMoveEnd},model:{value:e.checkedLeftData,callback:function(t){e.checkedLeftData=t},expression:\"checkedLeftData\"}},e._l(e.checkedLeftData,function(t,i){return 1!=t.isSystem?s(\"flexbox\",{key:i,staticClass:\"list-item\"},[s(\"div\",{staticClass:\"default-mark\",class:{\"default-mark-active\":t.sceneId==e.defaultId}}),e._v(\" \"),s(\"el-checkbox\",{staticClass:\"list-item-check\",on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(s){e.$set(t,\"check\",s)},expression:\"item.check\"}}),e._v(\" \"),s(\"div\",{staticClass:\"list-item-name\"},[e._v(e._s(t.name))]),e._v(\" \"),s(\"div\",{staticClass:\"list-item-handle\"},[s(\"i\",{staticClass:\"el-icon-edit\",on:{click:function(s){e.itemHandle(\"edit\",t,i)}}}),e._v(\" \"),s(\"i\",{staticClass:\"el-icon-delete\",on:{click:function(s){e.itemHandle(\"delete\",t,i)}}}),e._v(\" \"),s(\"el-dropdown\",{on:{command:e.defaultHandle}},[s(\"i\",{staticClass:\"el-icon-arrow-down\",on:{click:function(s){e.itemHandle(\"default\",t,i)}}}),e._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[s(\"el-dropdown-item\",[e._v(\"设置为默认标签\")])],1)],1)],1)],1):e._e()}))],2)],1),e._v(\" \"),s(\"div\",{staticClass:\"scene-middle-list\"},[s(\"el-button\",{staticClass:\"scene-middle-left-button\",class:{\"scene-middle-button-select\":e.rightCheckItems.length>0},attrs:{disabled:0==e.rightCheckItems.length},on:{click:function(t){e.changePositon(\"left\")}}},[s(\"i\",{staticClass:\"el-icon-arrow-left scene-middle-icon\"})]),e._v(\" \"),s(\"el-button\",{staticClass:\"scene-middle-right-button\",class:{\"scene-middle-button-select\":e.leftCheckItems.length>0},attrs:{disabled:0==e.leftCheckItems.length},on:{click:function(t){e.changePositon(\"right\")}}},[s(\"i\",{staticClass:\"el-icon-arrow-right scene-middle-icon\"})])],1),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-box\"},[s(\"flexbox\",{staticClass:\"scene-list-head\"},[s(\"el-checkbox\",{attrs:{indeterminate:e.isrightIndeterminate},on:{change:e.handlerightCheckAllChange},model:{value:e.checkrightAll,callback:function(t){e.checkrightAll=t},expression:\"checkrightAll\"}}),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-head-name\"},[e._v(\"隐藏的标签\")]),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-head-detail\"},[e._v(e._s(e.rightCheckItems.length+\"/\"+e.checkedRightData.length))])],1),e._v(\" \"),s(\"div\",{staticClass:\"scene-list-body\"},[s(\"draggable\",{staticStyle:{\"min-height\":\"100px\"},attrs:{move:e.rightMove,options:{group:\"list\",forceFallback:!1,fallbackClass:\"draggingStyle\"}},on:{end:e.rightMoveEnd},model:{value:e.checkedRightData,callback:function(t){e.checkedRightData=t},expression:\"checkedRightData\"}},e._l(e.checkedRightData,function(t,i){return s(\"flexbox\",{key:i,staticClass:\"list-item\"},[s(\"el-checkbox\",{staticClass:\"list-item-check\",staticStyle:{\"margin-left\":\"9px\"},on:{change:e.rightCheckItemChange},model:{value:t.check,callback:function(s){e.$set(t,\"check\",s)},expression:\"item.check\"}}),e._v(\" \"),s(\"div\",{staticClass:\"list-item-name\"},[e._v(e._s(t.name))])],1)}))],1)],1)]),e._v(\" \"),s(\"div\",{staticClass:\"handle-bar\"},[s(\"div\",{staticClass:\"handle-bar-add\",on:{click:function(t){e.addAndEditScene(\"add\",{})}}},[e._v(\"+ 新建场景\")])]),e._v(\" \"),s(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1),e._v(\" \"),s(\"scene-create\",{attrs:{\"field-list\":e.fieldList,\"crm-type\":e.crmType,\"dialog-visible\":e.showCreateScene,obj:e.filterObj,name:e.filterName,edit_id:e.filterEditId,\"is-default\":e.filterDefault},on:{\"update:dialogVisible\":function(t){e.showCreateScene=t},\"save-success\":e.getSceneList}})],1)},[],!1,null,\"17a0eee5\",null);u.options.__file=\"SceneSet.vue\";t.default=u.exports},NFCg:function(e,t,s){},Nbko:function(e,t,s){\"use strict\";var i=s(\"La+m\");s.n(i).a},\"O+M7\":function(e,t,s){\"use strict\";var i=s(\"hyBJ\");s.n(i).a},OKZ7:function(e,t,s){},\"On0+\":function(e,t,s){},PWYh:function(e,t,s){},QSP8:function(e,t,s){\"use strict\";var i=s(\"WWx0\");s.n(i).a},R1k5:function(e,t,s){e.exports=s.p+\"static/img/invoice.d717c31.png\"},RY6g:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"L2JU\"),l=s(\"8OTK\"),o=s(\"FyZu\"),c={name:\"CRMListHead\",components:{CRMAllCreate:l.default,DuplicateCheck:o.default},props:{title:{type:String,default:\"\"},placeholder:{type:String,default:\"请输入内容\"},mainTitle:{type:String,default:\"\"},crmType:{type:String,default:\"\"},isSeas:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!0},search:String,createFun:Function},data:function(){return{inputContent:\"\",moreTypes:[],createActionInfo:{type:\"save\"},createCRMType:\"\",isCreate:!1,dupCheckShow:!1}},computed:a()({},Object(n.b)([\"crm\"]),{canSave:function(){return!this.isSeas&&this.crm[this.crmType].save},canExamines:function(){return!!this.crm[this.crmType].examines},titleIcon:function(){return s(\"p3hS\")(\"./\"+this.crmType+\".png\")},showDupCheck:function(){return[\"leads\",\"customer\",\"contacts\"].includes(this.crmType)&&!this.isSeas}}),mounted:function(){var e=this;this.crm[this.crmType]&&this.crm[this.crmType].excelimport&&this.moreTypes.push({type:\"enter\",name:\"导入\",icon:\"import\"}),this.crm[this.crmType]&&this.crm[this.crmType].excelexport&&this.moreTypes.push({type:\"out\",name:\"导出\",icon:\"export\"}),this.$bus.on(\"import-crm-done-bus\",function(t){e.crmType==t&&e.$emit(\"on-handle\",{type:\"import-crm\"})})},beforeDestroy:function(){this.$bus.off(\"import-crm-done-bus\")},methods:{handleTypeDrop:function(e){\"out\"==e?this.$emit(\"on-export\"):\"enter\"==e&&this.$bus.emit(\"import-crm-bus\",this.crmType,{ownerSelectShow:!this.isSeas,poolSelectShow:this.isSeas})},createClick:function(){this.createFun?this.createFun():(this.createCRMType=this.crmType,this.createActionInfo={type:\"save\"},this.isCreate=!this.isCreate)},examinesClick:function(){this.$emit(\"on-examine\")},inputChange:function(){this.$emit(\"update:search\",this.inputContent)},searchInput:function(){this.$emit(\"on-search\",this.inputContent)},createSaveSuccess:function(e){e&&e.createContacts?\"customer\"==e.type&&(this.createCRMType=\"contacts\",this.createActionInfo={type:\"relative\",crmType:\"customer\",data:{}},this.createActionInfo.data.customer=e.data,this.isCreate=!0):this.$emit(\"on-handle\",{type:\"save-success\"})},hideView:function(){this.isCreate=!1}}},r=(s(\"TsvW\"),s(\"KHd+\")),u=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"c-container\"},[e.$slots.icon?e._t(\"icon\"):i(\"flexbox\",{staticClass:\"title\"},[i(\"img\",{staticClass:\"title-icon\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:e.titleIcon}}),e._v(e._s(e.title))]),e._v(\" \"),e.showSearch?i(\"el-input\",{staticClass:\"sc-container\",attrs:{placeholder:e.placeholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.searchInput(t):null}},model:{value:e.inputContent,callback:function(t){e.inputContent=t},expression:\"inputContent\"}},[i(\"el-button\",{attrs:{slot:\"append\",type:\"primary\"},nativeOn:{click:function(t){return e.searchInput(t)}},slot:\"append\"},[e._v(\"搜索\")])],1):e._e(),e._v(\" \"),i(\"div\",{staticClass:\"right-container\"},[e.canSave?i(\"el-button\",{staticClass:\"xr-btn--orange\",attrs:{icon:\"el-icon-plus\",type:\"primary\"},on:{click:e.createClick}},[e._v(e._s(e.mainTitle))]):e._e(),e._v(\" \"),e.canExamines?i(\"el-button\",{staticClass:\"dup-check-btn\",attrs:{type:\"primary\"},on:{click:e.examinesClick}},[e._v(\"报销\")]):e._e(),e._v(\" \"),e.showDupCheck?i(\"el-button\",{staticClass:\"dup-check-btn\",on:{click:function(t){e.dupCheckShow=!0}}},[e._v(\"查重\")]):e._e(),e._v(\" \"),e.moreTypes.length>0?i(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:e.handleTypeDrop}},[i(\"el-button\",{attrs:{icon:\"el-icon-more\"}}),e._v(\" \"),i(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},e._l(e.moreTypes,function(t,s){return i(\"el-dropdown-item\",{key:s,attrs:{icon:e._f(\"wkIconPre\")(t.icon),command:t.type}},[e._v(e._s(t.name))])}))],1):e._e()],1),e._v(\" \"),e.isCreate?i(\"c-r-m-all-create\",{attrs:{\"crm-type\":e.createCRMType,action:e.createActionInfo},on:{\"save-success\":e.createSaveSuccess,close:e.hideView}}):e._e(),e._v(\" \"),i(\"duplicate-check\",{attrs:{visible:e.dupCheckShow},on:{\"update:visible\":function(t){e.dupCheckShow=t}}})],2)},[],!1,null,\"06b065a8\",null);u.options.__file=\"CRMListHead.vue\";t.default=u.exports},Rq8O:function(e,t,s){},SYA5:function(e,t,s){\"use strict\";var i=s(\"VvOk\");s.n(i).a},ShYU:function(e,t,s){e.exports=s.p+\"static/img/marketing.0612591.png\"},T1FP:function(e,t,s){},TAVA:function(e,t,s){\"use strict\";s.r(t);var i=s(\"EJiy\"),a=s.n(i),n=s(\"7Qib\"),l=s(\"8GhS\"),o=s(\"Woz+\"),c={name:\"Index\",components:{XhUserCell:l.p,XhProuctCate:l.j,VDistpicker:o.a,XhStructureCell:l.n},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,required:!0,default:function(){return{}}},crmType:{type:String,default:\"\"},saveScene:{type:Boolean,default:!0}},data:function(){return{form:[],visible:!1,showErrors:!1,saveChecked:!1,saveDefault:!1,saveName:null}},computed:{infoParams:function(){return this.crmType?{m:\"crm\",c:this.crmType,a:\"index\"}:{}}},watch:{dialogVisible:{handler:function(e){e&&(this.form=Object(n.t)(this.obj.form),0==this.form.length&&this.form.push({fieldName:\"\",name:\"\",formType:\"\",condition:\"contains\",type:3,value:\"\",typeOption:[],statusOption:[],typeId:\"\",statusId:\"\",address:{state:\"\",city:\"\",area:\"\"}}),this.saveChecked=!1,this.saveDefault=!1,this.saveName=null),this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick(function(){var e=document.getElementById(\"filter-container\");e.scrollTop=e.scrollHeight})}},methods:{selectProvince:function(e,t){t.address.state=e.value},selectCity:function(e,t){t.address.city=e.value},selectArea:function(e,t){t.address.area=e.value},typeOptionsChange:function(e){if(e.typeId){var t=e.typeOption.find(function(t){return t.typeId===e.typeId});e.statusOption=t.statusList||[]}else e.statusOption=[];e.statusId=\"\"},arrayValueChange:function(e){e.value.length>0?(e.item.value=e.value,e.item.valueContent=e.valueContent):e.item.value=[]},selectChange:function(e,t){this.calConditionOptions(t.formType,t).forEach(function(s){s.value===e&&(t.type=s.type)})},showCalCondition:function(e){return\"date\"!=e&&\"datetime\"!=e&&\"business_type\"!=e&&\"category\"!=e&&\"map_address\"!=e},calConditionOptions:function(e,t){return\"checkStatus\"==e||\"dealStatus\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2}]:\"user\"==e||\"structure\"==e?[{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4}]:\"select\"==e?[{value:\"in\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2}]:\"checkbox\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"contains\",label:\"包含\",disabled:!1,type:3}]:\"module\"==e||\"text\"==e||\"textarea\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4}]:\"floatnumber\"==e||\"number\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4},{value:\"isNull\",label:\"为空\",disabled:!1,type:5},{value:\"isNotNull\",label:\"不为空\",disabled:!1,type:6},{value:\"gt\",label:\"大于\",disabled:!1,type:7},{value:\"egt\",label:\"大于等于\",disabled:!1,type:8},{value:\"lt\",label:\"小于\",disabled:!1,type:9},{value:\"elt\",label:\"小于等于\",disabled:!1,type:10}]:\"category\"==e?[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isnot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"not_contain\",label:\"不包含\",disabled:!1,type:4}]:[{value:\"is\",label:\"等于\",disabled:!1,type:1},{value:\"isNot\",label:\"不等于\",disabled:!1,type:2},{value:\"contains\",label:\"包含\",disabled:!1,type:3},{value:\"notContains\",label:\"不包含\",disabled:!1,type:4},{value:\"startWith\",label:\"开始于\",disabled:!1,type:8},{value:\"endWith\",label:\"结束于\",disabled:!1,type:10},{value:\"isNull\",label:\"为空\",disabled:!1,type:5},{value:\"isNotNull\",label:\"不为空\",disabled:!1,type:6},{value:\"gt\",label:\"大于\",disabled:!1,type:7},{value:\"egt\",label:\"大于等于\",disabled:!1,type:8},{value:\"lt\",label:\"小于\",disabled:!1,type:9},{value:\"elt\",label:\"小于等于\",disabled:!1,type:10}]},fieldFocus:function(){this.$el.click()},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.fieldName===e.fieldName});t&&(e.formType=t.formType,e.name=t.name,\"business_type\"==e.formType?(e.typeOption=t.setting,e.statusOption=[],e.typeId=\"\",e.statusId=\"\",e.value=\"\"):\"checkStatus\"==e.formType||\"dealStatus\"==e.formType?(e.setting=t.setting||[],e.value=\"\"):\"map_address\"==e.formType?e.address={state:\"\",city:\"\",area:\"\"}:\"date\"===e.formType||\"datetime\"===e.formType||\"user\"===e.formType||\"structure\"===e.formType||\"category\"===e.formType?e.value=[]:\"select\"==e.formType||\"checkbox\"===e.formType?(e.setting=t.setting||[],e.value=[]):e.value=\"\",\"checkbox\"==e.formType||\"checkStatus\"==e.formType||\"dealStatus\"==e.formType?(e.type=1,e.condition=\"is\"):\"user\"==e.formType||\"structure\"==e.formType?(e.condition=\"contains\",e.type=3):\"select\"==e.formType?(e.condition=\"in\",e.type=1):(e.condition=\"is\",e.type=1)),this.getError()},handleCancel:function(){this.$emit(\"update:dialogVisible\",!1)},getError:function(){this.showErrors=!1;for(var e=[],t=0;t<this.form.length;t++){var s=this.form[t];if(e.includes(s.fieldName)){this.showErrors=!0;break}e.push(s.fieldName)}},handleConfirm:function(){var e=this;if(this.showErrors)this.$message.error(\"筛选条件中有重复项！\");else if(!this.saveChecked||this.saveName&&\"\"!==this.saveName){for(var t=0;t<this.form.length;t++){var s=this.form[t];if(!s.fieldName||\"\"===s.fieldName)return void this.$message.error(\"筛选的字段名称不能为空！\");if(\"business_type\"==s.formType){if(!s.typeId&&!s.statusId)return void this.$message.error(\"筛选内容不能为空！\")}else if(\"map_address\"==s.formType){if(!s.address.state&&!s.address.city&&!s.address.area)return void this.$message.error(\"筛选内容不能为空！\")}else if(\"date\"==s.formType||\"datetime\"==s.formType||\"user\"==s.formType||\"structure\"==s.formType||\"category\"==s.formType||\"checkbox\"==s.formType){if((!s.value||0===s.value.length)&&\"isNull\"!=s.condition&&\"isNotNull\"!=s.condition)return void this.$message.error(\"筛选内容不能为空！\")}else if((\"\"===s.value||void 0===s.value||null===s.value)&&\"isNull\"!=s.condition&&\"isNotNull\"!=s.condition)return void this.$message.error(\"筛选内容不能为空\")}var i=[];this.form.forEach(function(t){if(\"datetime\"==t.formType||\"date\"==t.formType)i.push({formType:t.formType,name:t.fieldName,type:\"date\"==t.formType?11:12,values:t.value});else if(\"business_type\"==t.formType)i.push({formType:t.formType,name:t.statusId?\"statusId\":\"typeId\",type:1,values:t.statusId?[t.typeId,t.statusId]:[t.typeId]});else if(\"user\"==t.formType)i.push({type:t.type,values:[t.value[0].userId],formType:t.formType,name:t.fieldName});else if(\"structure\"==t.formType)i.push({type:t.type,values:[t.value[0].id],formType:t.formType,name:t.fieldName});else if(\"checkbox\"==t.formType)i.push({type:t.type,values:t.value,formType:t.formType,name:t.fieldName});else if(\"category\"==t.formType)i.push({type:1,values:[t.value[t.value.length-1]],formType:t.formType,name:t.fieldName});else if(\"select\"==t.formType){var s=t.value;\"string\"!=e.getSettingValueType(t.setting)&&(s=[t.value]),i.push({type:t.type,values:s,formType:t.formType,name:t.fieldName})}else if(\"map_address\"==t.formType){var a=\"\";for(var n in t.address)t.address[n]&&(a+=t.address[n]+\",\");i.push({values:[a],type:1,formType:t.formType,name:t.fieldName})}else i.push({type:t.type,values:[t.value],formType:t.formType,name:t.fieldName})});var a={obj:i,form:this.form,saveChecked:this.saveChecked,saveDefault:this.saveDefault,saveName:this.saveName};this.$emit(\"filter\",a)}else this.$message.error(\"场景名称不能为空！\")},handleAdd:function(){this.form.push({fieldName:\"\",condition:\"contains\",value:\"\",type:\"\",formType:\"\",setting:[],typeOption:[],statusOption:[],typeId:\"\",statusId:\"\"})},handleDelete:function(e){var t=this;this.$confirm(\"您确定要删除这一条数据吗?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.form.splice(e,1),t.getError()}).catch(function(){})},getSettingValueType:function(e){if(e&&e.length>0){var t=e[0];return void 0===t?\"undefined\":a()(t)}return[]}}},r=(s(\"Uan0\"),s(\"KHd+\")),u=Object(r.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{attrs:{visible:e.visible,\"close-on-click-modal\":!1,title:\"高级筛选\",width:\"900px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticStyle:{\"margin-bottom\":\"10px\"}},[e._v(\"筛选条件\")]),e._v(\" \"),s(\"el-form\",{staticClass:\"filter-container\",attrs:{id:\"filter-container\"}},[s(\"el-form-item\",[e._l(e.form,function(t,i){return[s(\"el-row\",{key:i},[s(\"el-col\",{attrs:{span:8}},[s(\"el-select\",{attrs:{placeholder:\"请选择要筛选的字段名\"},on:{change:function(s){e.fieldChange(t)},focus:e.fieldFocus},model:{value:t.fieldName,callback:function(s){e.$set(t,\"fieldName\",s)},expression:\"formItem.fieldName\"}},e._l(e.fieldList,function(e){return s(\"el-option\",{key:e.fieldName,attrs:{label:e.name,value:e.fieldName}})}))],1),e._v(\" \"),e.showCalCondition(t.formType)?s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]):e._e(),e._v(\" \"),e.showCalCondition(t.formType)?s(\"el-col\",{attrs:{span:4}},[s(\"el-select\",{attrs:{placeholder:\"请选择范围\"},on:{change:function(s){e.selectChange(s,t)}},model:{value:t.condition,callback:function(s){e.$set(t,\"condition\",s)},expression:\"formItem.condition\"}},e._l(e.calConditionOptions(t.formType,t),function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(\" \"),\"business_type\"==t.formType?s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]):e._e(),e._v(\" \"),\"business_type\"==t.formType?s(\"el-col\",{attrs:{span:4}},[s(\"el-select\",{on:{change:function(s){e.typeOptionsChange(t)}},model:{value:t.typeId,callback:function(s){e.$set(t,\"typeId\",s)},expression:\"formItem.typeId\"}},e._l(t.typeOption,function(e){return s(\"el-option\",{key:e.typeId,attrs:{label:e.name,value:e.typeId}})}))],1):e._e(),e._v(\" \"),s(\"el-col\",{attrs:{span:1}},[e._v(\" \")]),e._v(\" \"),s(\"el-col\",{attrs:{span:\"datetime\"===t.formType||\"date\"===t.formType||\"map_address\"===t.formType?13:8}},[\"checkStatus\"===t.formType||\"dealStatus\"===t.formType||\"select\"===t.formType&&\"string\"!=e.getSettingValueType(t.setting)?s(\"el-select\",{attrs:{placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.name,value:e.value}})})):\"select\"===t.formType?s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e,attrs:{label:e,value:e}})})):\"checkbox\"===t.formType?s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}},e._l(t.setting,function(e){return s(\"el-option\",{key:e,attrs:{label:e,value:e}})})):\"date\"===t.formType||\"datetime\"===t.formType?s(\"el-date-picker\",{staticStyle:{padding:\"0px 10px\"},attrs:{\"value-format\":\"date\"===t.formType?\"yyyy-MM-dd\":\"yyyy-MM-dd HH:mm:ss\",type:\"date\"===t.formType?\"daterange\":\"datetimerange\",\"range-separator\":\"-\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}}):\"business_type\"===t.formType?s(\"el-select\",{model:{value:t.statusId,callback:function(s){e.$set(t,\"statusId\",s)},expression:\"formItem.statusId\"}},e._l(t.statusOption,function(e){return s(\"el-option\",{key:e.statusId,attrs:{label:e.name,value:e.statusId}})})):\"user\"===t.formType?s(\"xh-user-cell\",{attrs:{item:t,\"info-params\":e.infoParams,value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"structure\"===t.formType?s(\"xh-structure-cell\",{attrs:{item:t,value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"category\"===t.formType?s(\"xh-prouct-cate\",{attrs:{item:t,value:t.value},on:{\"value-change\":e.arrayValueChange}}):\"map_address\"===t.formType?s(\"v-distpicker\",{attrs:{province:t.address.state,city:t.address.city,area:t.address.area},on:{province:function(s){e.selectProvince(s,t)},city:function(s){e.selectCity(s,t)},area:function(s){e.selectArea(s,t)}}}):s(\"el-input\",{attrs:{placeholder:\"请输入筛选条件\"},model:{value:t.value,callback:function(s){e.$set(t,\"value\",s)},expression:\"formItem.value\"}})],1),e._v(\" \"),s(\"el-col\",{staticClass:\"delete\",attrs:{span:1}},[s(\"i\",{staticClass:\"el-icon-error delete-btn\",on:{click:function(t){e.handleDelete(i)}}})])],1)]})],2)],1),e._v(\" \"),s(\"p\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showErrors,expression:\"showErrors\"}],staticClass:\"el-icon-warning warning-info\"},[s(\"span\",{staticClass:\"desc\"},[e._v(\"筛选条件中有重复项！\")])]),e._v(\" \"),s(\"el-button\",{attrs:{type:\"text\"},on:{click:e.handleAdd}},[e._v(\"+ 添加筛选条件\")]),e._v(\" \"),e.saveScene?s(\"div\",{staticClass:\"save\"},[s(\"el-checkbox\",{model:{value:e.saveChecked,callback:function(t){e.saveChecked=t},expression:\"saveChecked\"}},[e._v(\"保存为场景\")]),e._v(\" \"),s(\"el-input\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.saveChecked,expression:\"saveChecked\"}],staticClass:\"name\",attrs:{maxlength:10,placeholder:\"请输入场景名称，最多10个字符\"},model:{value:e.saveName,callback:function(t){e.saveName=\"string\"==typeof t?t.trim():t},expression:\"saveName\"}}),e._v(\" \"),s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.saveChecked,expression:\"saveChecked\"}],staticClass:\"save-setting\"},[s(\"el-checkbox\",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:\"saveDefault\"}},[e._v(\"设置为默认\")])],1)],1):e._e(),e._v(\" \"),s(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{on:{click:e.handleCancel}},[e._v(\"取 消\")]),e._v(\" \"),s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handleConfirm}},[e._v(\"确 定\")])],1)],1)},[],!1,null,\"17304d98\",null);u.options.__file=\"index.vue\";t.default=u.exports},TnB8:function(e,t,s){\"use strict\";s.r(t);var i=s(\"7Dod\"),a=s(\"1bNe\"),n=s(\"5QVi\"),l={name:\"SeacIndex\",components:{CustomerDetail:a.default},filters:{dealIcon:function(e){return 1==e?\"wk wk-success deal-suc\":\"wk wk-close deal-un\"},dealName:function(e){return 1==e?\"已成交\":\"未成交\"}},mixins:[n.default],data:function(){return{crmType:\"customer\",isSeas:!0,poolId:\"\",poolAuth:{},poolList:[]}},computed:{menuItems:function(){var e=[];return this.crm&&this.crm.customer&&e.push({title:\"客户\",path:\"customer\",icon:s(\"cLla\")}),this.crm&&this.crm.pool&&e.push({title:\"公海\",path:\"seas\",icon:s(\"riSQ\")}),this.crm&&this.crm.customer&&this.crm.customer.nearbyCustomer&&e.push({title:\"附近客户\",path:\"nearby\",icon:s(\"L+lS\")}),e}},watch:{poolId:{handler:function(e){e&&this.getCustomerPoolAuth(e)},deep:!0,immediate:!0}},created:function(){this.getPoolList()},activated:function(){this.isRequested&&this.getList()},deactivated:function(){this.$refs.elMenu.activeIndex=\"seas\"},methods:{getCustomerPoolAuth:function(e){var t=this;Object(i.v)({poolId:e}).then(function(e){t.poolAuth=e.data||{}}).catch(function(){})},menuSelect:function(e,t){this.$emit(\"menu-select\",e,t)},getPoolList:function(){var e=this;Object(i.u)().then(function(t){e.poolList=t.data||[],e.poolId=e.poolList.length>0?e.poolList[0].poolId:\"\"}).catch(function(){})},poolChange:function(){this.currentPage=1,this.getFieldList(!0)},cellClassName:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return\"customerName\"===t.property?\"can-visit--underline\":\"businessCheck\"===t.property?\"can-visit\":\"\"}}},o=(s(\"fS1+\"),s(\"KHd+\")),c=Object(o.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",[i(\"c-r-m-list-head\",{attrs:{search:e.search,\"is-seas\":!0,title:\"公海管理\",placeholder:\"请输入客户名称/手机/电话\",\"main-title\":\"新建客户\",\"crm-type\":\"customer\"},on:{\"update:search\":function(t){e.search=t},\"on-handle\":e.listHeadHandle,\"on-search\":e.crmSearch,\"on-export\":e.exportInfos}},[i(\"el-menu\",{ref:\"elMenu\",attrs:{slot:\"icon\",\"default-active\":\"seas\",mode:\"horizontal\",\"active-text-color\":\"#2362FB\"},on:{select:e.menuSelect},slot:\"icon\"},e._l(e.menuItems,function(t,a){return i(\"el-menu-item\",{key:a,attrs:{index:t.path}},[i(\"img\",{attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:t.icon}}),e._v(\" \"),i(\"span\",[e._v(e._s(t.title))])])}))],1),e._v(\" \"),i(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:!e.crm.pool&&e.poolAuth.index,expression:\"!crm.pool && poolAuth.index\"}],staticClass:\"crm-container\",attrs:{\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"}},[i(\"c-r-m-table-head\",{ref:\"crmTableHead\",attrs:{\"is-seas\":e.isSeas,\"pool-id\":e.poolId,\"pool-auth\":e.poolAuth,\"crm-type\":\"customer\"},on:{filter:e.handleFilter,handle:e.handleHandle,scene:e.handleScene}},[i(\"template\",{slot:\"custom\"},[i(\"div\",[e._v(\"公海：\")]),e._v(\" \"),i(\"el-select\",{on:{change:e.poolChange},model:{value:e.poolId,callback:function(t){e.poolId=t},expression:\"poolId\"}},e._l(e.poolList,function(e){return i(\"el-option\",{key:e.poolId,attrs:{label:e.poolName,value:e.poolId}})}))],1)],2),e._v(\" \"),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticClass:\"n-table--border\",staticStyle:{width:\"100%\"},attrs:{id:\"crm-table\",\"row-height\":40,data:e.list,height:e.tableHeight,\"cell-class-name\":e.cellClassName,\"use-virtual\":\"\",stripe:\"\",border:\"\",\"highlight-current-row\":\"\"},on:{\"row-click\":e.handleRowClick,\"sort-change\":e.sortChange,\"header-dragend\":e.handleHeaderDragend,\"selection-change\":e.handleSelectionChange}},[i(\"el-table-column\",{attrs:{\"show-overflow-tooltip\":\"\",type:\"selection\",align:\"center\",width:\"55\"}}),e._v(\" \"),e._l(e.fieldList,function(t,s){return i(\"el-table-column\",{key:s,attrs:{fixed:0==s,prop:t.prop,label:t.label,width:t.width,sortable:\"custom\",\"show-overflow-tooltip\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(s){return[\"dealStatus\"==t.prop?[i(\"i\",{class:e._f(\"dealIcon\")(s.row[t.prop])}),e._v(\" \"),i(\"span\",[e._v(e._s(e._f(\"dealName\")(s.row[t.prop])))])]:\"status\"==t.prop?[2==s.row.status?i(\"i\",{staticClass:\"wk wk-circle-password customer-lock\"}):e._e()]:[e._v(e._s(e.fieldFormatter(s.row,s.column)))]]}}])})}),e._v(\" \"),i(\"el-table-column\"),e._v(\" \"),i(\"el-table-column\",{attrs:{resizable:!1,fixed:\"right\",width:\"40\"},scopedSlots:e._u([{key:\"header\",fn:function(t){return[i(\"field-set\",{attrs:{\"is-seas\":e.isSeas,\"crm-type\":e.crmType,\"pool-id\":e.poolId},on:{change:e.setSave}})]}}])})],2),e._v(\" \"),i(\"div\",{staticClass:\"p-contianer\"},[i(\"el-pagination\",{staticClass:\"p-bar\",attrs:{\"current-page\":e.currentPage,\"page-sizes\":e.pageSizes,\"page-size\":e.pageSize,total:e.total,\"pager-count\":5,background:\"\",layout:\"prev, pager, next, sizes, total, jumper\"},on:{\"update:pageSize\":function(t){e.pageSize=t},\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)],1),e._v(\" \"),e.showDview?i(\"customer-detail\",{staticClass:\"d-view\",attrs:{id:e.rowID,\"pool-id\":e.poolId,\"is-seas\":e.isSeas},on:{handle:e.handleHandle,\"hide-view\":function(t){e.showDview=!1}}}):e._e()],1)},[],!1,null,\"e1b0f0ca\",null);c.options.__file=\"index.vue\";t.default=c.exports},TsvW:function(e,t,s){\"use strict\";var i=s(\"85i7\");s.n(i).a},U4MQ:function(e,t,s){e.exports=s.p+\"static/img/contract.65548f9.png\"},Uan0:function(e,t,s){\"use strict\";var i=s(\"i6id\");s.n(i).a},Vm8M:function(e,t,s){\"use strict\";var i=s(\"7Qib\"),a={name:\"MapView\",components:{},props:{title:{type:String,default:\"\"},lat:{type:[String,Number],default:0},lng:{type:[String,Number],default:0}},data:function(){return{}},computed:{},mounted:function(){var e=this;this.$el.style.zIndex=Object(i.q)(),document.body.appendChild(this.$el),Object(i.l)().then(function(){var t=new BMap.Map(\"choicemap\",{enableMapClick:!1}),s=new BMap.Point(parseFloat(e.lng),parseFloat(e.lat));t.centerAndZoom(s,18),t.enableScrollWheelZoom();var i=new BMap.Marker(s);t.addOverlay(i);var a=new BMap.InfoWindow(e.title);i.addEventListener(\"click\",function(){t.openInfoWindow(a,s)})})},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit(\"hidden\")}}},n=(s(\"I+NK\"),s(\"KHd+\")),l=Object(n.a)(a,function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",{staticClass:\"map-view\"},[t(\"div\",{attrs:{id:\"choicemap\"}}),this._v(\" \"),t(\"i\",{staticClass:\"el-icon-close map-close\",on:{click:this.hiddenView}})])},[],!1,null,\"33a9f6bf\",null);l.options.__file=\"MapView.vue\";t.a=l.exports},VvOk:function(e,t,s){},WGjG:function(e,t,s){\"use strict\";s.r(t);var i=s(\"8GhS\"),a=s(\"7Dod\"),n={name:\"AllocHandle\",components:{XhUserCell:i.p},mixins:[],props:{dialogVisible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:\"\"},poolId:[String,Number],selectionList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!0,visible:!1,usersList:[]}},computed:{},watch:{dialogVisible:{handler:function(e){this.visible=e,e||(this.usersList=[])},deep:!0,immediate:!0}},mounted:function(){this.visible=this.dialogVisible},methods:{handleCancel:function(){this.visible=!1,this.$emit(\"update:dialogVisible\",!1)},userChage:function(e){this.usersList=e.value},handleConfirm:function(){var e=this;if(0===this.usersList.length)this.$message.error(\"请选择负责人\");else{var t={userId:this.usersList[0].userId,poolId:this.poolId};t.ids=this.selectionList.map(function(t){return t[e.crmType+\"Id\"]}),this.loading=!0,Object(a.d)(t).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.loading=!1,e.$emit(\"handle\",{type:\"alloc\"}),e.handleCancel()}).catch(function(){e.loading=!1})}}}},l=(s(\"Klv4\"),s(\"KHd+\")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"批量分配\",width:\"400px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticClass:\"handle-box\"},[s(\"flexbox\",{staticClass:\"handle-item\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"handle-item-name\",staticStyle:{\"margin-top\":\"8px\"}},[e._v(\"请选择：\")]),e._v(\" \"),s(\"xh-user-cell\",{staticClass:\"handle-item-content\",attrs:{value:e.usersList},on:{\"value-change\":e.userChage}})],1)],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1)])},[],!1,null,\"c3449ef0\",null);o.options.__file=\"AllocHandle.vue\";t.default=o.exports},WWx0:function(e,t,s){},ZX9L:function(e,t,s){\"use strict\";var i={name:\"TimeTypeSelect\",props:{defaultType:[String,Object],width:{type:Number,default:200},options:{type:Array,default:function(){return[{label:\"今天\",value:\"today\"},{label:\"昨天\",value:\"yesterday\"},{label:\"本周\",value:\"week\"},{label:\"上周\",value:\"lastWeek\"},{label:\"本月\",value:\"month\"},{label:\"上月\",value:\"lastMonth\"},{label:\"本季度\",value:\"quarter\"},{label:\"上季度\",value:\"lastQuarter\"},{label:\"本年\",value:\"year\"},{label:\"去年\",value:\"lastYear\"}]}}},data:function(){return{selectType:{label:\"本年\",value:\"year\"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:\"\",endTime:\"\"}},computed:{typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||\"\")+\"-\"+(this.endTime||\"\"):\"\":this.selectType.label}},watch:{defaultType:function(){this.selectType.value!=this.defaultType&&(this.selectType=this.getDefaultTypeValue(this.defaultType))}},mounted:function(){void 0!==this.defaultType?\"string\"==typeof this.defaultType?this.selectType=this.getDefaultTypeValue(this.defaultType):this.defaultType.label?this.selectType=this.defaultType:\"default\"==this.defaultType.type?this.selectType=this.getDefaultTypeValue(this.defaultType.value):\"custom\"==this.defaultType.type&&(this.sureCustomContent=!0,this.showCustomContent=!0,this.startTime=this.defaultType.startTime,this.endTime=this.defaultType.endTime):this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},methods:{getDefaultTypeValue:function(e){for(var t=0;t<this.options.length;t++){var s=this.options[t];if(s.value==e)return s}return{label:\"本年\",value:\"year\"}},typeSelectClick:function(e){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=e,this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit(\"change\",{type:\"custom\",startTime:this.startTime,endTime:this.endTime}))}}},a=(s(\"77fj\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-popover\",{staticClass:\"time-type-select\",attrs:{width:e.width,placement:\"bottom\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:e.showTypePopover,callback:function(t){e.showTypePopover=t},expression:\"showTypePopover\"}},[s(\"div\",{staticClass:\"type-popper\"},[s(\"div\",{staticClass:\"type-content\"},[e._l(e.options,function(t,i){return s(\"div\",{key:i,staticClass:\"type-content-item\",class:{selected:e.selectType.value==t.value&&!e.showCustomContent},on:{click:function(s){e.typeSelectClick(t)}}},[s(\"div\",{staticClass:\"mark\"}),e._v(e._s(t.label)+\"\\n      \")])}),e._v(\" \"),s(\"div\",{staticClass:\"type-content-item\",class:{selected:e.showCustomContent},on:{click:function(t){e.showCustomContent=!0}}},[s(\"div\",{staticClass:\"mark\"}),e._v(\"自定义\\n      \")])],2),e._v(\" \"),e.showCustomContent?s(\"div\",{staticClass:\"type-content-custom\"},[s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:\"startTime\"}}),e._v(\" \"),s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:\"endTime\"}}),e._v(\" \"),s(\"el-button\",{on:{click:e.customSureClick}},[e._v(\"确定\")])],1):e._e()]),e._v(\" \"),s(\"el-input\",{staticClass:\"type-select\",style:{width:e.width+\"px\"},attrs:{slot:\"reference\",readonly:!0},slot:\"reference\",model:{value:e.typeShowValue,callback:function(t){e.typeShowValue=t},expression:\"typeShowValue\"}},[s(\"i\",{class:[\"el-icon-arrow-up\",{\"is-reverse\":e.showTypePopover}],attrs:{slot:\"suffix\"},slot:\"suffix\"})])],1)},[],!1,null,\"20503202\",null);n.options.__file=\"index.vue\";t.a=n.exports},aKrz:function(e,t,s){e.exports=s.p+\"static/img/expense-examines.29e9174.png\"},bok9:function(e,t,s){e.exports=s.p+\"static/img/receivables.29e9174.png\"},cBfe:function(e,t,s){},cLla:function(e,t,s){e.exports=s.p+\"static/img/customer_not.7d40ec4.png\"},dAOq:function(e,t,s){\"use strict\";t.a={methods:{getStatusColor:function(e){return 0==e?\"#ffc539\":1==e?\"#20b559\":2==e?\"#f95a5a\":3==e?\"#398dff\":4==e?\"#999\":5==e?\"#d9d9d9\":6==e?\"#2362FB\":8==e?\"#bfbfbf\":void 0},getStatusName:function(e){return 0==e?\"待审核\":1==e?\"通过\":2==e?\"拒绝\":3==e?\"审核中\":4==e?\"撤回\":5==e?\"未提交\":6==e?\"创建\":8==e?\"已作废\":\"\"},getStatusIcon:function(e){return 0==e?\"wk wk-time\":1==e?\"wk wk-success\":2==e?\"wk wk-close\":3==e?\"wk wk-time\":4==e?\"wk wk-reset\":5==e?\"wk wk-time\":6==e?\"wk wk-l-plus\":8==e?\"wk wk-invalid\":\"\"},getXhStatusList:function(){return[{label:\"待审核\",value:0},{label:\"通过\",value:1},{label:\"拒绝\",value:2},{label:\"审核中\",value:3},{label:\"撤回\",value:4}]},getStatusImageIcon:function(e){return 0==e||3==e||5==e?s(\"6pZM\"):1==e?s(\"y4JV\"):2==e?s(\"migV\"):4==e?s(\"+xXq\"):6==e?s(\"wu/m\"):\"\"}}}},dTTw:function(e,t,s){e.exports=s.p+\"static/img/business.66d7980.png\"},eOwn:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"7Dod\"),l=s(\"6iAj\"),o=s(\"4XAY\"),c=s(\"giPm\"),r=s(\"O8VQ\"),u=s(\"/G0b\"),d=s(\"8OTK\"),h=s(\"C3Po\"),p=s(\"ZoMv\"),m=s(\"7Qib\"),f=s(\"Z+Ht\"),v=s(\"vvxI\"),y=s(\"ZX9L\"),g=s(\"ehos\"),b=s(\"L2JU\"),_={name:\"Activity\",components:{LogAdd:c.default,LogCell:r.default,CRMAllCreate:d.default,TaskQuickAdd:h.default,TimeTypeSelect:y.a,LogEditDialog:u.default,CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-66f9\"),s.e(\"chunk-63bb\"),s.e(\"chunk-7029\"),s.e(\"chunk-0aaf\"),s.e(\"chunk-24c6\")]).then(s.bind(null,\"3z7q\"))}},mixins:[f.a,v.default],props:{handle:{type:Array,default:function(){return[]}},id:[String,Number],contactsId:[String,Number],crmType:{type:String,default:\"\"},isSeas:{type:Boolean,default:!1},typeList:{type:Array,default:function(){return[]}},detail:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,filterValue:{},timeOptions:[{label:\"全部\",value:\"\"},{label:\"最近7天\",value:\"7\"},{label:\"最近30天\",value:\"30\"},{label:\"最近60天\",value:\"60\"}],contacts:[],followTypes:[],handleType:\"\",activityType:{icon:\"all\",color:\"#2362FB\",command:\"\",label:\"全部活动\"},list:[],noMore:!1,page:1,isCRMCreate:!1,createActionInfo:{type:\"relative\",crmType:this.crmType,data:{}},createCRMType:\"\",isTaskCreate:!1,showFullDetail:!1,relationID:\"\",relationCrmType:\"\",scrollKey:Date.now(),logEditData:null,logEditPosition:{seciton:0,index:0},logEditDialogVisible:!1}},computed:a()({},Object(b.b)([\"crm\"]),{canCreateFollowRecord:function(){return this.crm&&this.crm.followRecord&&this.crm.followRecord.save},showRelate:function(){return\"customer\"==this.crmType},scrollDisabled:function(){return this.loading||this.noMore},taskParams:function(){var e={};return e[this.crmType+\"Ids\"]=this.id,e}}),watch:{id:function(){this.initInfo(),this.refreshLogList()}},created:function(){this.debouncedRefreshLogList=Object(g.debounce)(300,this.refreshLogList),this.initInfo()},methods:{getLogTypeList:function(){var e=this;Object(l.s)().then(function(t){e.followTypes=t.data.map(function(e){return{value:e,label:e}})}).catch(function(){})},getContactsList:function(){var e=this;Object(n.H)({customerId:this.id}).then(function(t){e.contacts=t.data.list}).catch(function(){})},sendLog:function(e){var t=this;if(e.content){var s={};s.activityType=p.default[this.crmType],s.activityTypeId=e.id,s.content=e.content,s.category=e.followType;var i=e.business.map(function(e){return e.businessId});s.batchId=e.batchId,s.businessIds=i.join(\",\"),s.contactsIds=e.contactsId,s.nextTime=e.nextTime||\"\",s.isEvent=0,this.sendLoading=!0,Object(o.a)(s).then(function(e){t.sendLoading=!1,t.$message.success(\"发布成功\"),t.$refs.logAdd&&t.$refs.logAdd.resetInfo(),t.refreshLogList()}).catch(function(){t.sendLoading=!1})}else this.$message.error(\"请输入跟进内容\")},handleClick:function(e){var t=this;if(this.handleType==e?this.handleType=\"\":this.handleType=e,\"log\"==e)this.isTaskCreate=!1,this.$nextTick(function(){t.$refs.logAdd&&(t.$refs.logAdd.isUnfold=t.handleType==e)});else if(\"task\"==e)this.isTaskCreate=!0,this.$nextTick(function(){t.$refs.taskAdd.inputFocus()});else{this.isTaskCreate=!1;var s={type:\"relative\",crmType:this.crmType,data:{}};\"contacts\"==this.crmType?(s.data.customer=Object(m.t)(this.detail),\"business\"==e&&(s.relativeData={contactsId:this.detail.contactsId})):\"customer\"==this.crmType?s.data.customer=Object(m.t)(this.detail):\"business\"==this.crmType?(s.data.customer=Object(m.t)(this.detail),s.data.business=Object(m.t)(this.detail),\"contacts\"==e&&(s.relativeData={businessId:this.detail.businessId})):\"contract\"==this.crmType&&(s.data.customer=Object(m.t)(this.detail),s.data.contract=Object(m.t)(this.detail)),this.createActionInfo=s,this.createCRMType=e,this.isCRMCreate=!0}},initInfo:function(){var e=this;this.$nextTick(function(){e.$refs.logAdd&&e.$refs.logAdd.resetInfo(),e.$refs.taskAdd&&e.$refs.taskAdd.resetSendData()}),this.filterValue={search:\"\",timeLine:{label:\"全部\",value:\"\"}},this.getLogTypeList(),this.showRelate&&this.getContactsList()},refreshLogList:function(){this.page=1,this.noMore=!1,this.list=[],this.scrollKey=Date.now()},handleSelectClick:function(e){this.activityType=e,this.refreshLogList()},timeTypeChange:function(e){this.filterValue.timeLine=e,this.refreshLogList()},getLogList:function(){var e=this;this.loading=!0;var t={page:this.page,crmType:p.default[this.crmType],activityType:this.activityType.command,activityTypeId:this.id};this.filterValue.search&&(t.search=this.filterValue.search),this.filterValue.timeLine.type&&(\"custom\"===this.filterValue.timeLine.type?(t.startDate=this.filterValue.timeLine.startTime.replace(/\\./g,\"-\"),t.endDate=this.filterValue.timeLine.endTime.replace(/\\./g,\"-\")):t.intervalDay=this.filterValue.timeLine.value||\"\"),Object(o.c)(t).then(function(t){if(e.loading=!1,!e.noMore)if(e.page++,e.list.length){var s=e.list[e.list.length-1];t.data.time&&t.data.list.length&&s.time!=t.data.time&&e.list.push(t.data)}else t.data.time&&t.data.list.length&&e.list.push(t.data);e.noMore=t.data.lastPage}).catch(function(){e.noMore=!0,e.loading=!1})},createCRMSuccess:function(){this.handleType=\"\",this.refreshLogList()},createCRMClose:function(){this.isCRMCreate=!1,this.handleType=\"\"},checkCRMDetail:function(e,t){this.relationID=t,this.relationCrmType=e,this.showFullDetail=!0},getActivityIcon:function(e){return this.getXrIcon(this.getActivityType(e))},getActivityTypeColor:function(e){return this.getXrIconColor(this.getActivityType(e))},logCellDelete:function(e,t,s){this.list[s].list.splice(t,1),0==this.list[s].list.length&&this.list.splice(s,1),this.scrollKey=Date.now()},logCellEdit:function(e,t,s){this.logEditData=e,this.logEditPosition={seciton:s,index:t},this.logEditDialogVisible=!0},logEditSave:function(e){this.logEditPosition.seciton>=0&&this.logEditPosition.index>=0&&this.list[this.logEditPosition.seciton].list.splice(this.logEditPosition.index,1,e)}}},C=(s(\"QSP8\"),s(\"KHd+\")),w=Object(C.a)(_,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:e.getLogList,expression:\"getLogList\"}],key:e.scrollKey,staticClass:\"main\",attrs:{\"infinite-scroll-distance\":\"100\",\"infinite-scroll-disabled\":\"scrollDisabled\"}},[s(\"div\",[!e.isSeas&&e.handle&&e.handle.length?s(\"div\",{staticClass:\"main-handle\"},e._l(e.handle,function(t,i){return s(\"el-button\",{key:i,class:{\"is-select\":e.handleType===t.type},attrs:{type:\"primary\",icon:\"wk wk-add\"},on:{click:function(s){e.handleClick(t.type)}}},[e._v(\"\\n        \"+e._s(t.label)+\"\\n      \")])})):e._e(),e._v(\" \"),!e.isSeas&&e.handle&&e.handle.length?[!e.isTaskCreate&&e.canCreateFollowRecord?s(\"log-add\",{ref:\"logAdd\",staticClass:\"log-add\",attrs:{id:e.id,\"show-business\":e.showRelate,\"show-contacts\":e.showRelate,contacts:e.contacts,\"contacts-id\":e.contactsId,\"follow-types\":e.followTypes,\"crm-type\":e.crmType},on:{send:e.sendLog,focus:function(t){e.handleType=\"log\"},close:function(t){e.handleClick(e.handleType)}}}):s(\"task-quick-add\",{ref:\"taskAdd\",staticClass:\"task-quick-add\",attrs:{params:e.taskParams},on:{focus:function(t){e.handleType=\"task\"},send:e.refreshLogList}})]:e._e(),e._v(\" \"),s(\"div\",{staticClass:\"log\",class:{\"is-top\":e.handle&&0==e.handle.length}},[s(\"flexbox\",{staticClass:\"log__header\",attrs:{justify:\"flex-end\"}},[s(\"el-input\",{attrs:{placeholder:\"关键字搜索\",\"prefix-icon\":\"el-icon-search\"},on:{input:e.debouncedRefreshLogList},model:{value:e.filterValue.search,callback:function(t){e.$set(e.filterValue,\"search\",t)},expression:\"filterValue.search\"}}),e._v(\" \"),s(\"time-type-select\",{attrs:{width:190,options:e.timeOptions,\"default-type\":e.filterValue.timeLine},on:{change:e.timeTypeChange}}),e._v(\" \"),e.typeList.length>1?s(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:e.handleSelectClick}},[s(\"span\",{staticClass:\"el-dropdown-link\"},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+e.activityType.icon],style:{backgroundColor:e.activityType.color}}),e._v(e._s(e.activityType.label)),s(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),e._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},e._l(e.typeList,function(t,i){return s(\"el-dropdown-item\",{key:i,attrs:{command:t}},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+t.icon],style:{backgroundColor:t.color}}),e._v(e._s(t.label))])}))],1):e._e()],1),e._v(\" \"),e._l(e.list,function(t,i){return s(\"div\",{key:i,staticClass:\"log-section\"},[s(\"div\",{staticClass:\"log-section__title\"},[s(\"span\",{staticClass:\"section-title\"},[s(\"span\",{staticClass:\"section-title__time\"},[e._v(e._s(t.time))])])]),e._v(\" \"),e._l(t.list,function(a,n){return[1==a.type?s(\"div\",{key:n,staticClass:\"log-cell\",class:{\"only-one\":1==t.list.length}},[s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":!e.isSeas},on:{\"crm-detail\":e.checkCRMDetail,delete:e.logCellDelete,edit:e.logCellEdit}}),e._v(\" \"),s(\"i\",{staticClass:\"wk wk-message log-cell__mark\"})],1):s(\"div\",{key:n,staticClass:\"log-cell activity-cell\",class:{\"only-one\":1==t.list.length}},[2==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[e._v(e._s(a.createTime)+\" \"+e._s(a.realname)+\"创建了\"+e._s(e.getActivityTypeName(a.activityType))+\"：\")]),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(t){e.checkCRMDetail(e.getActivityType(a.activityType),a.activityTypeId)}}},[e._v(e._s(a.activityTypeName||\"查看详情\"))])]):3==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[e._v(e._s(a.createTime)+\" \"+e._s(a.realname)+\"将商机：\")]),e._v(\" \"),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(t){e.checkCRMDetail(\"business\",a.activityTypeId)}}},[e._v(e._s(a.activityTypeName))]),e._v(\" \"),s(\"span\",[e._v(e._s(\" 阶段变为 \"+a.content))])]):4==a.type?s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":\"\"},on:{\"crm-detail\":e.checkCRMDetail,delete:e.logCellDelete}}):e._e(),e._v(\" \"),s(\"i\",{staticClass:\"log-cell__mark\",class:e.getActivityIcon(a.activityType),staticStyle:{\"background-color\":\"#FB9323\"},style:{backgroundColor:e.getActivityTypeColor(a.activityType)}})],1)]})],2)}),e._v(\" \"),e.loading?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[e._v(\"加载中...\")]):e._e(),e._v(\" \"),e.noMore?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[e._v(\"没有更多了\")]):e._e()],2)],2),e._v(\" \"),e.isCRMCreate?s(\"c-r-m-all-create\",{attrs:{\"crm-type\":e.createCRMType,action:e.createActionInfo},on:{\"save-success\":e.createCRMSuccess,close:e.createCRMClose}}):e._e(),e._v(\" \"),s(\"c-r-m-full-screen-detail\",{attrs:{visible:e.showFullDetail,\"crm-type\":e.relationCrmType,id:e.relationID},on:{\"update:visible\":function(t){e.showFullDetail=t}}}),e._v(\" \"),s(\"log-edit-dialog\",{attrs:{visible:e.logEditDialogVisible,data:e.logEditData},on:{\"update:visible\":function(t){e.logEditDialogVisible=t},save:e.logEditSave}})],1)},[],!1,null,\"7955f64b\",null);w.options.__file=\"index.vue\";t.default=w.exports},ehRj:function(e,t,s){},\"fS1+\":function(e,t,s){\"use strict\";var i=s(\"LheQ\");s.n(i).a},fpBj:function(e,t,s){},gIBH:function(e,t,s){},gesf:function(e,t,s){},giPm:function(e,t,s){\"use strict\";s.r(t);var i=s(\"KTTK\"),a=s(\"mkuN\"),n=s(\"zMq1\"),l=s(\"ye9D\"),o=s(\"NYF1\"),c=s(\"YIeP\"),r=s(\"7Qib\");var u={methods:{dispatch:function(e,t,s){for(var i=this.$parent||this.$root,a=i.$options.componentName;i&&(!a||a!==e);)(i=i.$parent)&&(a=i.$options.componentName);i&&i.$emit.apply(i,[t].concat(s))},broadcast:function(e,t,s){(function e(t,s,i){this.$children.forEach(function(a){a.$options.componentName===t?a.$emit.apply(a,[s].concat(i)):e.apply(a,[t,s].concat([i]))})}).call(this,e,t,s)}}},d={name:\"LogAdd\",components:{CrmRelative:a.a,AddImageList:n.a,AddFileList:l.a,AddRelateList:o.a,CommonWords:c.a},mixins:[u],props:{showBusiness:{type:Boolean,default:!1},showContacts:{type:Boolean,default:!1},contacts:Array,contactsId:[String,Number],followTypes:Array,id:[String,Number],crmType:{type:String,default:\"\"}},data:function(){return{isUnfold:!1,content:\"\",imgFiles:[],businessAction:{},files:[],showBusinessPopover:!1,business:[],selectContactsId:\"\",followType:\"\",nextTime:\"\",showRelativeType:\"\",batchId:Object(r.r)()}},computed:{autosize:function(){return this.isUnfold?{minRows:3,maxRows:6}:{minRows:1,maxRows:1}}},watch:{followTypes:function(){this.getDefalutFollowType()},content:function(e){var t=!!(e&&e.length>0);this.dispatch(\"SlideView\",\"setEditClose\",[t])},contactsId:function(){this.selectContactsId=this.contactsId||\"\"},id:{handler:function(){this.businessAction={type:\"condition\",data:{moduleType:this.crmType,customerId:this.id}}},immediate:!0}},created:function(){this.selectContactsId=this.contactsId||\"\",this.getDefalutFollowType()},beforeDestroy:function(){},methods:{getDefalutFollowType:function(){this.followTypes&&this.followTypes.length>0?this.followType=this.followTypes[0].value:this.followType=\"\"},resetInfo:function(){this.nextTime=\"\",this.isUnfold=!1,this.content=\"\",this.dispatch(\"SlideView\",\"setEditClose\",[!1]),this.imgFiles=[],this.files=[],this.business=[],this.selectContactsId=this.contactsId||\"\",this.showRelativeType=\"\",this.batchId=Object(r.r)(),this.getDefalutFollowType()},commonWordsSelect:function(e){var t=this;this.content?this.$confirm(\"您选中的常用语将覆盖当前填写内容?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){t.content=e}).catch(function(){}):this.content=e},checkRelativeInfos:function(e){\"business\"==this.showRelativeType&&(this.business=e.data)},barClick:function(e){this.showRelativeType=e,\"business\"==e?this.showBusinessPopover=!0:\"file\"==e?this.$refs.fileInput.click():\"img\"==e&&this.$refs.imgInput.click()},uploadFile:function(e){var t=e.target.files;if(t.length){for(var s=0;s<t.length;s++){if(-1==t[s].type.indexOf(\"image\")&&\"img\"==this.showRelativeType)return void this.$message.error(\"请上传正确的文件类型\")}for(var i=\"image/*\"==e.target.accept?\"img\":\"file\",a=0;a<t.length;a++){var n=t[a];this.uploadFileRequest(n,i)}e.target.value=\"\"}},uploadFileRequest:function(e,t,s){var i=this;this.$wkUploadFile.upload({file:e,params:{type:t,batchId:this.batchId}}).then(function(a){var n=a.res.data||{};n.size=Object(r.h)(e.size),\"img\"==t?i.imgFiles.push(n):(n.icon=Object(r.o)(e),i.files.push(n)),s&&s()}).catch(function(){})},deleteImage:function(e,t){this.deleteImgOrFile(\"image\",e,t)},deleteFile:function(e,t){this.deleteImgOrFile(\"file\",e,t)},deleteImgOrFile:function(e,t,s){var a=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.g)({id:t.fileId}).then(function(t){\"image\"==e?a.imgFiles.splice(s,1):a.files.splice(s,1),a.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteAllFile:function(e){var t=this;this.batchId&&this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.i)({batchId:t.batchId,type:e}).then(function(s){2==e?t.imgFiles=[]:t.files=[],t.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteRelate:function(e,t){this.business.splice(t,1)},inputFocus:function(){var e=this;this.isUnfold=!0,this.$nextTick(function(){e.$refs.textarea.focus(),e.$emit(\"focus\")})},sendClick:function(){this.$emit(\"send\",{id:this.id,content:this.content,files:this.files,images:this.imgFiles,business:this.business,contactsId:this.selectContactsId,batchId:this.batchId,followType:this.followType,nextTime:this.nextTime})},close:function(){this.isUnfold=!1,this.$emit(\"close\")}}},h=(s(\"Nbko\"),s(\"KHd+\")),p=Object(h.a)(d,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{class:[\"mix-content\",{unfold:!e.isUnfold}]},[e.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:e.close}}):e._e(),e._v(\" \"),e.isUnfold?s(\"div\",{staticClass:\"mix-content-select\"},[e.showContacts?s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择联系人\"},model:{value:e.selectContactsId,callback:function(t){e.selectContactsId=t},expression:\"selectContactsId\"}},e._l(e.contacts,function(e){return s(\"el-option\",{key:e.contactsId,attrs:{label:e.name,value:e.contactsId}})})):e._e(),e._v(\" \"),s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择跟进方式\"},model:{value:e.followType,callback:function(t){e.followType=t},expression:\"followType\"}},e._l(e.followTypes,function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(\" \"),s(\"el-date-picker\",{attrs:{editable:!1,type:\"datetime\",placeholder:\"选择下次联系时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:e.nextTime,callback:function(t){e.nextTime=t},expression:\"nextTime\"}}),e._v(\" \"),s(\"common-words\",{on:{select:e.commonWordsSelect}})],1):e._e(),e._v(\" \"),s(\"div\",{class:[\"i-cont\",{unfold:!e.isUnfold}]},[e.isUnfold?e._e():s(\"i\",{staticClass:\"wk wk-write\"}),e._v(\" \"),s(\"el-input\",{ref:\"textarea\",attrs:{autosize:e.autosize,maxlength:800,type:\"textarea\",clearable:\"\",resize:\"none\",placeholder:\"请输入内容\"},on:{focus:e.inputFocus},model:{value:e.content,callback:function(t){e.content=t},expression:\"content\"}})],1),e._v(\" \"),e.imgFiles.length>0&&e.isUnfold?s(\"add-image-list\",{attrs:{data:e.imgFiles},on:{delete:e.deleteImage,\"delete-all\":function(t){e.deleteAllFile(2)},upload:e.uploadFile}}):e._e(),e._v(\" \"),e.files.length>0&&e.isUnfold?s(\"add-file-list\",{attrs:{data:e.files},on:{delete:e.deleteFile,\"delete-all\":function(t){e.deleteAllFile(1)}}}):e._e(),e._v(\" \"),e.business.length>0&&e.isUnfold?s(\"add-relate-list\",{attrs:{data:e.business,type:\"business\"},on:{delete:e.deleteRelate}}):e._e(),e._v(\" \"),e.isUnfold?s(\"div\",{staticClass:\"bar-cont\"},[s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-picture\"},on:{click:function(t){e.barClick(\"img\")}}},[e._v(\"图片\")]),e._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-file\"},on:{click:function(t){e.barClick(\"file\")}}},[e._v(\"附件\")]),e._v(\" \"),e.showBusiness?s(\"el-popover\",{attrs:{placement:\"bottom\",width:\"700\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:e.showBusinessPopover,callback:function(t){e.showBusinessPopover=t},expression:\"showBusinessPopover\"}},[s(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:e.showBusinessPopover,radio:!1,action:e.businessAction,\"selected-data\":{business:e.business},\"crm-type\":\"business\"},on:{close:function(t){e.showBusinessPopover=!1},changeCheckout:e.checkRelativeInfos}}),e._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",staticStyle:{\"margin-left\":\"10px\"},attrs:{slot:\"reference\",type:\"text\",icon:\"wk wk-associate\"},on:{click:function(t){e.barClick(\"business\")}},slot:\"reference\"},[e._v(\"关联商机\")])],1):e._e(),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.sendClick,expression:\"sendClick\"}],staticClass:\"send-btn\",attrs:{type:\"primary\"}},[e._v(\"发布\")])],1):e._e(),e._v(\" \"),s(\"input\",{ref:\"fileInput\",staticClass:\"file-input\",attrs:{accept:\"*.*\",type:\"file\",multiple:\"\"},on:{change:e.uploadFile}}),e._v(\" \"),s(\"input\",{ref:\"imgInput\",staticClass:\"file-input\",attrs:{accept:\"image/*\",type:\"file\",multiple:\"\"},on:{change:e.uploadFile}})],1)},[],!1,null,\"670c00a3\",null);p.options.__file=\"LogAdd.vue\";t.default=p.exports},\"goM+\":function(e,t,s){e.exports=s.p+\"static/img/seas_not.68f3f48.png\"},hwzM:function(e,t,s){\"use strict\";s.r(t);var i=s(\"7Qib\"),a=s(\"KTTK\"),n={name:\"FileCell\",filters:{getFileSize:function(e){return Object(i.h)(e)}},props:{cellIndex:Number,data:Object,list:Array,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},data:function(){return{}},computed:{fileIcon:function(){var e=this.data.name?this.data.name.split(\".\"):[],t=\"\";return t=e.length>0?e[e.length-1]:\"\",Object(i.n)(t)},previewShow:function(){return this.list}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{downloadClick:function(){Object(i.d)({path:this.data.filePath||this.data.url,name:this.data.name})},previewClick:function(){Object(i.a)(this.data.name)?Object(i.G)(this.data.filePath||this.data.url,this.data.name):this.$bus.emit(\"preview-image-bus\",{index:this.cellIndex||0,data:this.list.map(function(e){return{url:e.filePath||e.url,name:e.name}})})},deleteClick:function(){var e=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(a.g)({id:e.data.fileId}).then(function(t){e.$message.success(\"操作成功\"),e.$emit(\"delete\",e.cellIndex,e.data)}).catch(function(){})}).catch(function(){e.$message({type:\"info\",message:\"已取消删除\"})})}}},l=(s(\"Bd1s\"),s(\"KHd+\")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"flexbox\",{staticClass:\"cell\"},[i(\"img\",{staticClass:\"cell-head\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:e.fileIcon,alt:\"\"}}),e._v(\" \"),i(\"div\",{staticClass:\"cell-body text-one-line\",class:{\"cursor-pointer\":e.cursorPointer}},[i(\"span\",[e._v(e._s(e.data.name.length>20?e.data.name.substring(0,20)+\"...\":e.data.name))])]),e._v(\" \"),i(\"div\",{staticClass:\"size\"},[e._v(\"\\n    (\"+e._s(e._f(\"getFileSize\")(e.data.size))+\")\\n  \")]),e._v(\" \"),i(\"div\",{staticClass:\"cell-foot\"},[e.previewShow?i(\"span\",{staticClass:\"xr-text-btn primary\",on:{click:e.previewClick}},[e._v(\"预览\")]):e._e(),e._v(\" \"),i(\"span\",{staticClass:\"xr-text-btn primary\",on:{click:e.downloadClick}},[e._v(\"下载\")]),e._v(\" \"),e.showDelete?i(\"span\",{staticClass:\"xr-text-btn delete\",on:{click:e.deleteClick}},[e._v(\"删除\")]):e._e()])])},[],!1,null,\"4a3d86b8\",null);o.options.__file=\"index.vue\";t.default=o.exports},hyBJ:function(e,t,s){},i6id:function(e,t,s){},iSV6:function(e,t,s){},j4Q1:function(e,t,s){\"use strict\";s.r(t);var i=s(\"EJiy\"),a=s.n(i),n={name:\"FilterContent\",props:{obj:{type:Object,required:!0,default:function(){return{}}}},data:function(){return{optionsNames:{is:\"等于\",in:\"等于\",isNot:\"不等于\",contains:\"包含\",notContains:\"不包含\",startWith:\"开始于\",endWith:\"结束于\",isNull:\"为空\",isNotNull:\"不为空\",eq:\"等于\",neq:\"不等于\",gt:\"大于\",egt:\"大于等于\",lt:\"小于\",elt:\"小于等于\"},showObj:{}}},computed:{},watch:{obj:function(e){this.showObj=e}},mounted:function(){this.showObj=this.obj},methods:{handleDelete:function(e,t){this.showObj.obj.splice(t,1),this.showObj.form.splice(t,1),this.$emit(\"delete\",{item:e,index:t,obj:this.showObj})},getTypesName:function(e){return e.typeId&&e.typeOption.find(function(t){return t.typeId===e.typeId}).name||\"\"},getNameValue:function(e){var t=e.setting.find(function(t){return t.value===e.value});return t?t.name:\"\"},getStatusName:function(e){if(e.statusId){var t=e.statusOption.find(function(t){return t.statusId===e.statusId});return t.name?\"-\"+t.name:\"\"}return\"\"},getDealStatus:function(e){return 0==e?\"未成交\":1==e?\"已成交\":\"\"},getSettingValueType:function(e){if(e&&e.length>0){var t=e[0];return void 0===t?\"undefined\":a()(t)}return[]}}},l=(s(\"p6ZA\"),s(\"KHd+\")),o=Object(l.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"wrapper\"},[s(\"ul\",{staticClass:\"list\"},e._l(e.showObj.form,function(t,i){return s(\"li\",{key:i,staticClass:\"list-item\"},[\"date\"==t.formType?s(\"span\",[e._v(e._s(t.name+\" “\"+t.value[0]+\"-\"+t.value[1]+\"”\"))]):\"datetime\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" “\"+t.value[0]+\"-\"+t.value[1]+\"”\"))]):\"business_type\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" “\"+e.getTypesName(t)+e.getStatusName(t)+\"”\"))]):\"map_address\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" \"+t.address.state+\" \"+t.address.city+\" \"+t.address.area))]):\"checkStatus\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" “\"+e.optionsNames[t.condition]+\"” \"+e.getNameValue(t)))]):\"dealStatus\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" “\"+e.optionsNames[t.condition]+\"” \"+e.getDealStatus(t.value)))]):\"user\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" \"+e.optionsNames[t.condition]+\"“\"+t.value[0].realname+\"”\"))]):\"structure\"===t.formType?s(\"span\",[e._v(e._s(t.name+\" \"+e.optionsNames[t.condition]+\"“\"+t.value[0].name+\"”\"))]):\"category\"===t.formType&&t.value.length>0?s(\"span\",[e._v(e._s(t.name+\" “\"+t.valueContent+\"”\"))]):\"select\"===t.formType&&\"string\"!=e.getSettingValueType(t.setting)?s(\"span\",[e._v(e._s(t.name+\" “\"+e.getNameValue(t)+\"”\"))]):s(\"span\",[e._v(e._s(t.name+\" \"+e.optionsNames[t.condition]+\"“\"+t.value+\"”\"))]),e._v(\" \"),s(\"i\",{staticClass:\"el-icon-close icon\",on:{click:function(s){e.handleDelete(t,i)}}})])}))])},[],!1,null,\"540fc399\",null);o.options.__file=\"FilterContent.vue\";t.default=o.exports},jUvl:function(e,t,s){\"use strict\";var i=s(\"gesf\");s.n(i).a},keIY:function(e,t,s){e.exports=s.p+\"static/img/leads.2c5bddd.png\"},lhwF:function(e,t,s){\"use strict\";var i=s(\"6ce6\");s.n(i).a},\"lrb+\":function(e,t,s){},migV:function(e,t,s){e.exports=s.p+\"static/img/check_fail.f446ba8.png\"},nslc:function(e,t,s){\"use strict\";s.r(t);var i=s(\"7Dod\"),a={name:\"DealStatusHandle\",components:{},mixins:[],props:{value:Number,visible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:\"\"},selectionList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!0,status:1,options:[{label:\"已成交\",value:1},{label:\"未成交\",value:0}]}},computed:{},watch:{value:{handler:function(e){void 0!==e&&(this.status=0==e?1:0)},immediate:!0}},mounted:function(){},methods:{handleCancel:function(){this.status=1,this.$emit(\"update:visible\",!1)},handleConfirm:function(){var e=this,t=this.selectionList.map(function(t){return t[e.crmType+\"Id\"]}).join(\",\"),s={dealStatus:this.status};s.ids=t,this.loading=!0,Object(i.b)(s).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.loading=!1,e.$emit(\"handle\",{type:\"deal_status\"}),e.handleCancel()}).catch(function(){e.loading=!1})}}},n=(s(\"E/pc\"),s(\"KHd+\")),l=Object(n.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],attrs:{visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"客户成交状态\",width:\"400px\"},on:{close:e.handleCancel}},[s(\"div\",{staticClass:\"handle-box\"},[s(\"flexbox\",{staticClass:\"handle-item\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"handle-item-name\",staticStyle:{\"margin-top\":\"8px\"}},[e._v(\"成交状态：\")]),e._v(\" \"),s(\"el-select\",{staticClass:\"handle-item-content\",model:{value:e.status,callback:function(t){e.status=t},expression:\"status\"}},e._l(e.options,function(e){return s(\"el-option\",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1)])},[],!1,null,\"5fb62a3b\",null);l.options.__file=\"DealStatusHandle.vue\";t.default=l.exports},oSbd:function(e,t,s){},\"p3/6\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"8GhS\"),a=s(\"7Dod\"),n=s(\"d9x6\"),l=s(\"ERJp\"),o={name:\"TeamsHandle\",components:{XhUserCell:i.p},mixins:[],props:{dialogVisible:{type:Boolean,required:!0,default:!1},title:{type:String,default:\"\"},crmType:{type:String,default:\"\"},selectionList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,visible:!1,usersList:[],handleType:1,addsTypes:[]}},computed:{},watch:{dialogVisible:{handler:function(e){this.visible=e,e||this.resetData()},deep:!0,immediate:!0}},mounted:function(){this.visible=this.dialogVisible},methods:{resetData:function(){this.usersList=[],this.handleType=1,this.addsTypes=[]},handleCancel:function(){this.visible=!1,this.$emit(\"update:dialogVisible\",!1)},userChage:function(e){this.usersList=e.value},handleConfirm:function(){var e=this;if(0===this.usersList.length)this.$message.error(\"请选择团队成员\");else{var t={ids:this.selectionList.map(function(t){return t[e.crmType+\"Id\"]}),memberIds:this.usersList.map(function(e){return e.userId})};\"customer\"===this.crmType&&\"添加团队成员\"==this.title&&(t.changeType=this.addsTypes.map(function(e){return parseInt(e)}));var s=void 0;\"添加团队成员\"==this.title?(t.power=this.handleType,s={customer:a.U,contract:n.q,business:l.s}[this.crmType]):s={customer:a.T,contract:n.p,business:l.r}[this.crmType],this.loading=!0,s(t).then(function(t){e.$message({type:\"success\",message:\"操作成功\"}),e.loading=!1,e.handleCancel(),e.$emit(\"handle\",{type:\"添加团队成员\"==e.title?\"add_user\":\"delete_user\"})}).catch(function(){e.loading=!1})}}}},c=(s(\"xmeh\"),s(\"KHd+\")),r=Object(c.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"el-dialog\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],attrs:{title:e.title,visible:e.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,width:\"400px\"},on:{\"update:visible\":function(t){e.visible=t},close:e.handleCancel}},[s(\"div\",{staticClass:\"handle-box\"},[s(\"flexbox\",{staticClass:\"handle-item\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"handle-item-name\",staticStyle:{\"margin-top\":\"8px\"}},[e._v(\"选择团队成员：\")]),e._v(\" \"),s(\"xh-user-cell\",{staticClass:\"handle-item-content\",attrs:{radio:!1,value:e.usersList,placeholder:\"点击选择（多选）\"},on:{\"value-change\":e.userChage}}),e._v(\" \"),\"添加团队成员\"!=e.title?s(\"div\",{staticClass:\"tips\"},[e._v(\"此操作不可移除数据负责人\")]):e._e()],1),e._v(\" \"),\"添加团队成员\"==e.title?s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"权限：\")]),e._v(\" \"),s(\"el-radio-group\",{model:{value:e.handleType,callback:function(t){e.handleType=t},expression:\"handleType\"}},[s(\"el-radio\",{attrs:{label:1}},[e._v(\"只读\")]),e._v(\" \"),s(\"el-radio\",{attrs:{label:2}},[e._v(\"读写\")])],1)],1):e._e(),e._v(\" \"),\"添加团队成员\"==e.title&&\"customer\"===e.crmType?s(\"flexbox\",{staticClass:\"handle-item\"},[s(\"div\",{staticClass:\"handle-item-name\"},[e._v(\"同时添加至：\")]),e._v(\" \"),s(\"el-checkbox-group\",{model:{value:e.addsTypes,callback:function(t){e.addsTypes=t},expression:\"addsTypes\"}},[s(\"el-checkbox\",{attrs:{label:\"2\"}},[e._v(\"商机\")]),e._v(\" \"),s(\"el-checkbox\",{attrs:{label:\"3\"}},[e._v(\"合同\")])],1)],1):e._e()],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v(\"取消\")]),e._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:e.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[e._v(\"保存\")])],1)])},[],!1,null,\"3390e593\",null);r.options.__file=\"TeamsHandle.vue\";t.default=r.exports},p3hS:function(e,t,s){var i={\"./board.png\":\"5XBl\",\"./business.png\":\"dTTw\",\"./contacts.png\":\"JAjk\",\"./contract.png\":\"U4MQ\",\"./customer.png\":\"wfwE\",\"./customer_not.png\":\"cLla\",\"./expense-examines.png\":\"aKrz\",\"./expense.png\":\"ugew\",\"./invoice.png\":\"R1k5\",\"./leads.png\":\"keIY\",\"./leads_not.png\":\"K4QM\",\"./marketing.png\":\"ShYU\",\"./nearby.png\":\"t4Dm\",\"./nearby_not.png\":\"L+lS\",\"./product.png\":\"wbJn\",\"./receivables.png\":\"bok9\",\"./seas.png\":\"riSQ\",\"./seas_not.png\":\"goM+\",\"./todo.png\":\"0Dkb\",\"./visit.png\":\"9cPJ\"};function a(e){var t=n(e);return s(t)}function n(e){var t=i[e];if(!(t+1)){var s=new Error(\"Cannot find module '\"+e+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}return t}a.keys=function(){return Object.keys(i)},a.resolve=n,e.exports=a,a.id=\"p3hS\"},p6ZA:function(e,t,s){\"use strict\";var i=s(\"FD7p\");s.n(i).a},riSQ:function(e,t,s){e.exports=s.p+\"static/img/seas.83becad.png\"},\"sR+e\":function(e,t,s){\"use strict\";s.r(t);var i=s(\"gDS+\"),a=s.n(i),n=s(\"QbLZ\"),l=s.n(n),o=s(\"L2JU\"),c=s(\"ZoMv\"),r=s(\"4XAY\"),u=s(\"c2Co\"),d=s(\"7Dod\"),h=s(\"AAeT\"),p=s(\"ERJp\"),m=s(\"d9x6\"),f=s(\"1DpC\"),v=s(\"Y4Le\"),y=s(\"zhwh\"),g=s(\"X5SI\"),b=s(\"TAVA\"),_=s(\"j4Q1\"),C=s(\"94wX\"),w=s(\"MvHO\"),T=s(\"0/jB\"),k=s(\"+lNB\"),x=s(\"p3/6\"),I=s(\"WGjG\"),S=s(\"nslc\"),D=s(\"JCWM\"),L=s(\"XJYT\"),N=s(\"7Qib\"),O={name:\"CRMTableHead\",components:{FilterForm:b.default,FilterContent:_.default,SceneList:C.default,TransferHandle:k.default,TeamsHandle:x.default,AllocHandle:I.default,SceneCreate:T.default,SceneSet:w.default,DealStatusHandle:S.default,PutPoolHandle:D.default},props:{title:{type:String,default:\"\"},crmType:{type:String,default:\"\"},isSeas:{type:Boolean,default:!1},poolId:[String,Number],poolAuth:Object},data:function(){return{loading:!1,loadingObj:null,sceneType:null,showScene:!1,showFilter:!1,fieldList:[],filterObj:{form:[]},sceneData:{id:\"\",bydata:\"\",name:\"\"},showSceneSet:!1,showSceneCreate:!1,sceneFilterObj:{form:[]},selectionList:[],transferDialogShow:!1,teamsDialogShow:!1,teamsTitle:\"\",allocDialogShow:!1,dealStatusShow:!1,putPoolShow:!1}},computed:l()({},Object(o.b)([\"crm\"]),{iconClass:function(){return this.showScene?\"arrow-up\":\"arrow-down\"},sceneName:function(){return this.sceneData.name||this.getDefaultSceneName()},showSceneView:function(){return!this.isSeas},showFilterView:function(){return![].includes(this.crmType)}}),watch:{loading:function(e){e?this.loadingObj=L.Loading.service({target:document.querySelector(\"#crm-main-container\")}):this.loadingObj&&this.loadingObj.close()}},mounted:function(){},methods:{handleTypeDrop:function(e){this.sceneType=e},showFilterClick:function(){this.getFilterFieldInfo()},getFilterFieldInfo:function(){var e=this,t={};this.isSeas?t.poolId=this.poolId:t.label=c.default[this.crmType],(this.isSeas?r.D:r.E)(t).then(function(t){e.fieldList=t.data,e.showFilter=!0}).catch(function(){})},handleFilter:function(e){var t=this;this.filterObj=e,this.showFilter=!1,e.saveChecked&&Object(r.t)({type:c.default[this.crmType],isDefault:e.saveDefault?1:0,name:e.saveName,data:a()(e.obj)}).then(function(e){t.updateSceneList()}).catch(function(){}),this.$emit(\"filter\",e.obj)},handleDeleteField:function(e){this.filterObj=e.obj,this.$emit(\"filter\",this.filterObj.obj)},sceneSelect:function(e){this.sceneData=e,this.$emit(\"scene\",e)},sceneHandle:function(e){var t=this;\"set\"==e.type?this.showSceneSet=!0:\"add\"==e.type&&Object(r.E)({label:c.default[this.crmType]}).then(function(e){t.fieldList=e.data,t.showSceneCreate=!0}).catch(function(){})},updateSceneList:function(){this.$refs.sceneList.getSceneList()},headSelectionChange:function(e){this.selectionList=e},selectionBarClick:function(e){var t=this;if(\"transfer\"==e)this.transferDialogShow=!0;else if(\"export\"==e){var s={},i=null;this.isSeas?(i=d.r,s.poolId=this.poolId,s.ids=this.selectionList.map(function(e){return e.customerId}).join(\",\")):(i={customer:d.g,leads:u.d,contacts:h.d,business:p.d,contract:m.d,receivables:f.c,product:v.d,expense:g.h}[this.crmType],s=this.selectionList.map(function(e){return e[t.crmType+\"Id\"]})),i(s).then(function(e){Object(N.c)(e)}).catch(function(){})}else if(\"transform\"==e||\"delete\"==e||\"lock\"==e||\"unlock\"==e||\"start\"==e||\"disable\"==e||\"get\"==e){var a=\"\";\"transform\"==e?a=\"确定将这些线索转换为客户吗?\":\"delete\"==e?a=this.isSeas?\"若客户下有联系人，联系人将一并删除。确定删除？\":\"确定删除?\":\"lock\"==e?a=\"确定要锁定这些客户吗？锁定后将不会掉入公海。\":\"unlock\"==e?a=\"确定要解锁这些客户吗？\":\"start\"==e?a=\"确定要上架这些产品吗?\":\"disable\"==e?a=\"确定要下架这些产品吗?\":\"get\"==e&&(a=\"确定要领取该客户吗?\"),this.$confirm(a,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.confirmHandle(e)}).catch(function(){})}else\"add_user\"==e?(this.teamsTitle=\"添加团队成员\",this.teamsDialogShow=!0):\"delete_user\"==e?(this.teamsTitle=\"移除团队成员\",this.teamsDialogShow=!0):\"alloc\"==e?this.allocDialogShow=!0:\"deal_status\"==e?this.dealStatusShow=!0:\"put_seas\"==e&&(this.putPoolShow=!0)},confirmHandle:function(e){var t=this;if(\"lock\"===e||\"unlock\"===e)this.loading=!0,Object(d.n)({status:\"lock\"===e?\"2\":\"1\",ids:this.selectionList.map(function(e){return e.customerId}).join(\",\")}).then(function(s){t.loading=!1,t.$message({type:\"success\",message:\"操作成功\"}),t.$emit(\"handle\",{type:e})}).catch(function(){t.loading=!1});else if(\"transform\"===e)this.loading=!0,Object(u.n)(this.selectionList.map(function(e){return e.leadsId})).then(function(s){t.loading=!1,t.$message({type:\"success\",message:\"转化成功\"}),t.$store.dispatch(\"GetMessageNum\"),t.$emit(\"handle\",{type:e})}).catch(function(){t.loading=!1});else if(\"start\"===e||\"disable\"===e)this.loading=!0,Object(v.l)({ids:this.selectionList.map(function(e){return e.productId}),status:\"start\"===e?\"1\":\"0\"}).then(function(s){t.loading=!1,t.$message({type:\"success\",message:\"操作成功\"}),t.$emit(\"handle\",{type:e})}).catch(function(){t.loading=!1});else if(\"delete\"===e){var s=this.selectionList.map(function(e){return e[t.crmType+\"Id\"]}),i={leads:u.a,customer:this.isSeas?d.p:d.c,contacts:h.a,business:p.b,contract:m.b,receivables:f.a,visit:y.a,product:v.a,expense:g.b}[this.crmType],a={};this.isSeas&&(a.poolId=this.poolId),a.ids=s,this.loading=!0,i(this.isSeas?a:s).then(function(s){t.loading=!1,t.$message({type:\"success\",message:\"删除成功\"}),t.$emit(\"handle\",{type:e})}).catch(function(){t.loading=!1})}else\"get\"===e&&(this.loading=!0,Object(d.P)({ids:this.selectionList.map(function(e){return e.customerId}),poolId:this.poolId}).then(function(s){t.loading=!1,t.$message({type:\"success\",message:\"操作成功\"}),t.$store.dispatch(\"GetMessageNum\"),t.$emit(\"handle\",{type:e})}).catch(function(){t.loading=!1}))},getSelectionHandleItemsInfo:function(){var e={transfer:{name:\"转移\",type:\"transfer\",icon:\"transfer\"},transform:{name:\"转化为客户\",type:\"transform\",icon:\"transform\"},export:{name:\"导出选中\",type:\"export\",icon:\"export\"},delete:{name:\"删除\",type:\"delete\",icon:\"delete\"},put_seas:{name:\"放入公海\",type:\"put_seas\",icon:\"seas\"},lock:{name:\"锁定\",type:\"lock\",icon:\"lock\"},unlock:{name:\"解锁\",type:\"unlock\",icon:\"unlock\"},add_user:{name:\"添加团队成员\",type:\"add_user\",icon:\"add\"},delete_user:{name:\"移除团队成员\",type:\"delete_user\",icon:\"remove\"},alloc:{name:\"分配\",type:\"alloc\",icon:\"alloc\"},get:{name:\"领取\",type:\"get\",icon:\"receive\"},start:{name:\"上架\",type:\"start\",icon:\"shelves\"},disable:{name:\"下架\",type:\"disable\",icon:\"sold-out\"},deal_status:{name:\"更改成交状态\",type:\"deal_status\",icon:\"s-status\"}};return\"leads\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"transform\",\"export\",\"delete\"]):\"customer\"==this.crmType?this.isSeas?this.forSelectionHandleItems(e,[\"alloc\",\"get\",\"export\",\"delete\"]):this.forSelectionHandleItems(e,[\"transfer\",\"put_seas\",\"deal_status\",\"export\",\"delete\",\"lock\",\"unlock\",\"add_user\",\"delete_user\"]):\"contacts\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"export\",\"delete\"]):\"business\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"export\",\"delete\",\"add_user\",\"delete_user\"]):\"contract\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"export\",\"delete\",\"add_user\",\"delete_user\"]):\"receivables\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"export\",\"delete\"]):\"product\"==this.crmType?this.forSelectionHandleItems(e,[\"transfer\",\"export\",\"delete\",\"start\",\"disable\"]):\"product\"==this.crmType?this.forSelectionHandleItems(e,[\"export\",\"start\",\"disable\"]):\"visit\"==this.crmType?this.forSelectionHandleItems(e,[\"delete\"]):\"expense\"==this.crmType?this.forSelectionHandleItems(e,[\"export\",\"delete\"]):void 0},forSelectionHandleItems:function(e,t){for(var s=[],i=0;i<t.length;i++)s.push(e[t[i]]);return s},whetherTypeShowByPermision:function(e){if(\"transfer\"==e)return\"transform\"!=this.sceneData.bydata&&this.crm[this.crmType].transfer;if(\"transform\"==e)return\"transform\"!=this.sceneData.bydata&&this.crm[this.crmType].transform;if(\"export\"==e)return this.isSeas?this.poolId?this.poolAuth.excelexport:this.crm.pool.excelexport:!this.crm[this.crmType]||this.crm[this.crmType].excelexport;if(\"delete\"==e)return this.isSeas?this.poolId?this.poolAuth.delete:this.crm.pool.delete:this.crm[this.crmType].delete;if(\"put_seas\"==e)return this.crm[this.crmType].putinpool;if(\"lock\"==e||\"unlock\"==e)return this.crm[this.crmType].lock;if(\"add_user\"==e||\"delete_user\"==e)return this.crm[this.crmType].teamsave;if(\"alloc\"==e)return this.poolId?this.poolAuth.distribute:this.crm.pool.distribute;if(\"get\"==e)return this.poolId?this.poolAuth.receive:this.crm.pool.receive;if(\"start\"==e){for(var t=0;t<this.selectionList.length;t++){if(1==this.selectionList[t].status)return!1}return this.crm[this.crmType].status}if(\"disable\"==e){for(var s=0;s<this.selectionList.length;s++){if(0==this.selectionList[s].status)return!1}return this.crm[this.crmType].status}return\"deal_status\"!=e||this.crm[this.crmType].dealStatus},handleCallBack:function(e){this.$emit(\"handle\",{type:e.type})},getDefaultSceneName:function(){return\"leads\"==this.crmType?\"全部线索\":\"customer\"==this.crmType?\"全部客户\":\"contacts\"==this.crmType?\"全部联系人\":\"business\"==this.crmType?\"全部商机\":\"contract\"==this.crmType?\"全部合同\":\"receivables\"==this.crmType?\"全部回款\":\"product\"==this.crmType?\"全部产品\":\"visit\"===this.crmType?\"全部回访\":\"expense\"===this.crmType?\"全部费用\":void 0}}},$=(s(\"IHka\"),s(\"KHd+\")),j=Object($.a)(O,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"table-head-container\"},[s(\"flexbox\",{directives:[{name:\"show\",rawName:\"v-show\",value:0==e.selectionList.length,expression:\"selectionList.length == 0\"}],staticClass:\"th-container\"},[e._t(\"custom\"),e._v(\" \"),e.showSceneView?s(\"div\",[e._v(\"场景：\")]):e._e(),e._v(\" \"),e.showSceneView?s(\"el-popover\",{attrs:{trigger:\"click\",\"popper-class\":\"no-padding-popover\",width:\"180\"},model:{value:e.showScene,callback:function(t){e.showScene=t},expression:\"showScene\"}},[s(\"el-input\",{staticClass:\"scene-select\",attrs:{slot:\"reference\",readonly:!0},slot:\"reference\",model:{value:e.sceneName,callback:function(t){e.sceneName=t},expression:\"sceneName\"}},[s(\"i\",{class:[\"el-input__icon\",\"el-icon-\"+e.iconClass],attrs:{slot:\"suffix\"},slot:\"suffix\"})]),e._v(\" \"),s(\"scene-list\",{ref:\"sceneList\",attrs:{\"crm-type\":e.crmType},on:{scene:e.sceneSelect,\"scene-handle\":e.sceneHandle,\"hidden-scene\":function(t){e.showScene=!1}}})],1):e._e(),e._v(\" \"),e.showFilterView?s(\"el-button\",{staticClass:\"filter-button\",attrs:{type:\"primary\",icon:\"wk wk-screening\"},on:{click:e.showFilterClick}},[e._v(\"高级筛选\")]):e._e(),e._v(\" \"),e.showFilterView?s(\"filter-form\",{attrs:{\"field-list\":e.fieldList,\"dialog-visible\":e.showFilter,obj:e.filterObj,\"crm-type\":e.crmType,\"save-scene\":!e.isSeas},on:{\"update:dialogVisible\":function(t){e.showFilter=t},filter:e.handleFilter}}):e._e(),e._v(\" \"),e._t(\"default\")],2),e._v(\" \"),e.selectionList.length>0?s(\"flexbox\",{staticClass:\"selection-bar\"},[s(\"div\",{staticClass:\"selected—title\"},[e._v(\"已选中 \"),s(\"span\",{staticClass:\"selected—count\"},[e._v(e._s(e.selectionList.length))]),e._v(\" 项\")]),e._v(\" \"),s(\"flexbox\",{staticClass:\"selection-items-box\"},e._l(e.getSelectionHandleItemsInfo(),function(t,i){return e.whetherTypeShowByPermision(t.type)?s(\"el-button\",{key:i,attrs:{icon:e._f(\"wkIconPre\")(t.icon),type:\"primary\"},nativeOn:{click:function(s){e.selectionBarClick(t.type)}}},[e._v(e._s(t.name))]):e._e()}))],1):e._e(),e._v(\" \"),e.filterObj.form&&e.filterObj.form.length>0?s(\"filter-content\",{attrs:{obj:e.filterObj},on:{delete:e.handleDeleteField}}):e._e(),e._v(\" \"),s(\"transfer-handle\",{attrs:{\"crm-type\":e.crmType,\"selection-list\":e.selectionList,\"dialog-visible\":e.transferDialogShow},on:{\"update:dialogVisible\":function(t){e.transferDialogShow=t},handle:e.handleCallBack}}),e._v(\" \"),s(\"teams-handle\",{attrs:{\"crm-type\":e.crmType,title:e.teamsTitle,\"selection-list\":e.selectionList,\"dialog-visible\":e.teamsDialogShow},on:{\"update:dialogVisible\":function(t){e.teamsDialogShow=t},handle:e.handleCallBack}}),e._v(\" \"),s(\"alloc-handle\",{attrs:{\"crm-type\":e.crmType,\"pool-id\":e.poolId,\"selection-list\":e.selectionList,\"dialog-visible\":e.allocDialogShow},on:{\"update:dialogVisible\":function(t){e.allocDialogShow=t},handle:e.handleCallBack}}),e._v(\" \"),s(\"deal-status-handle\",{attrs:{\"crm-type\":e.crmType,\"selection-list\":e.selectionList,visible:e.dealStatusShow},on:{\"update:visible\":function(t){e.dealStatusShow=t},handle:e.handleCallBack}}),e._v(\" \"),s(\"scene-set\",{attrs:{\"dialog-visible\":e.showSceneSet,\"crm-type\":e.crmType},on:{\"update:dialogVisible\":function(t){e.showSceneSet=t},\"save-success\":e.updateSceneList}}),e._v(\" \"),s(\"scene-create\",{attrs:{\"field-list\":e.fieldList,\"crm-type\":e.crmType,\"dialog-visible\":e.showSceneCreate,obj:e.sceneFilterObj},on:{\"update:dialogVisible\":function(t){e.showSceneCreate=t},\"save-success\":e.updateSceneList}}),e._v(\" \"),s(\"put-pool-handle\",{attrs:{visible:e.putPoolShow,\"selection-list\":e.selectionList},on:{\"update:visible\":function(t){e.putPoolShow=t},handle:e.handleCallBack}})],1)},[],!1,null,\"8518d54e\",null);j.options.__file=\"CRMTableHead.vue\";t.default=j.exports},t4Dm:function(e,t,s){e.exports=s.p+\"static/img/nearby.2d86e3c.png\"},tUbT:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"8OTK\"),l=s(\"L2JU\"),o=s(\"yPq4\"),c=s(\"FT/l\"),r=s(\"5QVi\"),u={name:\"CustomerIndex\",components:{CRMAllDetail:o.default,BusinessCheck:c.default,CRMAllCreate:n.default},filters:{dealIcon:function(e){return 1==e?\"wk wk-success deal-suc\":\"wk wk-close deal-un\"},dealName:function(e){return 1==e?\"已成交\":\"未成交\"}},mixins:[r.default],data:function(){return{crmType:\"customer\",createType:\"customer\",createAction:{type:\"save\",id:\"\",data:{}},createShow:!1}},computed:a()({},Object(l.b)([\"CRMConfig\"]),{menuItems:function(){var e=[];return this.crm&&this.crm.customer&&e.push({title:\"客户\",path:\"customer\",icon:s(\"wfwE\")}),this.crm&&this.crm.pool&&e.push({title:\"公海\",path:\"seas\",icon:s(\"goM+\")}),this.crm&&this.crm.customer&&this.crm.customer.nearbyCustomer&&e.push({title:\"附近客户\",path:\"nearby\",icon:s(\"L+lS\")}),e}}),mounted:function(){},activated:function(){this.isRequested&&this.getList()},deactivated:function(){this.$refs.elMenu.activeIndex=this.crmType},methods:{menuSelect:function(e,t){this.$emit(\"menu-select\",e,t)},relativeBusinessClick:function(e){this.rowID=e.businessId,this.rowType=\"business\",this.showDview=!0},cellClassName:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return\"customerName\"===t.property?\"can-visit--underline\":\"businessCheck\"===t.property?\"can-visit\":\"\"},businessCheckClick:function(e,t){if(0!=t.row.businessCount){var s=e.target.parentNode;this.$set(t.row,\"show\",!t.row.show),s.__vue__.showPopper=!t.row.show}},businessClose:function(e,t){e.parentNode.__vue__.showPopper=!1,this.$set(t.row,\"show\",!1)},createClick:function(){this.createType=this.crmType,this.createAction={type:\"save\",id:\"\",data:{}},this.createShow=!0},saveSuccess:function(e){\"customer\"==e.type&&(this.handleHandle(e),e.createContacts&&(this.createType=\"contacts\",this.createAction={type:\"relative\",crmType:\"customer\",data:{customer:e.data}},this.createShow=!0))}}},d=(s(\"M4wA\"),s(\"KHd+\")),h=Object(d.a)(u,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",[i(\"c-r-m-list-head\",{attrs:{search:e.search,\"crm-type\":e.crmType,\"create-fun\":e.createClick,title:\"客户管理\",placeholder:\"请输入客户名称/手机/电话\",\"main-title\":\"新建客户\"},on:{\"update:search\":function(t){e.search=t},\"on-handle\":e.listHeadHandle,\"on-search\":e.crmSearch,\"on-export\":e.exportInfos}},[i(\"el-menu\",{ref:\"elMenu\",attrs:{slot:\"icon\",\"default-active\":e.crmType,mode:\"horizontal\",\"active-text-color\":\"#2362FB\"},on:{select:e.menuSelect},slot:\"icon\"},e._l(e.menuItems,function(t,a){return i(\"el-menu-item\",{key:a,attrs:{index:t.path}},[i(\"img\",{attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:t.icon}}),e._v(\" \"),i(\"span\",[e._v(e._s(t.title))])])}))],1),e._v(\" \"),i(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:!e.crm.customer.index,expression:\"!crm.customer.index\"}],staticClass:\"crm-container\",attrs:{\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"}},[i(\"c-r-m-table-head\",{ref:\"crmTableHead\",attrs:{\"crm-type\":e.crmType},on:{filter:e.handleFilter,handle:e.handleHandle,scene:e.handleScene}}),e._v(\" \"),i(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticClass:\"n-table--border\",staticStyle:{width:\"100%\"},attrs:{id:\"crm-table\",\"row-height\":40,data:e.list,height:e.tableHeight,\"cell-class-name\":e.cellClassName,\"use-virtual\":\"\",stripe:\"\",border:\"\",\"highlight-current-row\":\"\"},on:{\"row-click\":e.handleRowClick,\"sort-change\":e.sortChange,\"header-dragend\":e.handleHeaderDragend,\"selection-change\":e.handleSelectionChange}},[i(\"el-table-column\",{attrs:{\"show-overflow-tooltip\":\"\",type:\"selection\",align:\"center\",width:\"55\"}}),e._v(\" \"),i(\"el-table-column\",{attrs:{resizable:!1,prop:\"businessCheck\",fixed:\"\",label:\"\",width:\"38\"},scopedSlots:e._u([{key:\"header\",fn:function(e){return[i(\"i\",{staticClass:\"wk wk-business\",staticStyle:{cursor:\"not-allowed\",color:\"#9DA9C2\"}})]}},{key:\"default\",fn:function(t){return[i(\"el-popover\",{attrs:{disabled:0==t.row.businessCount,offset:250,placement:\"right\",\"popper-class\":\"no-padding-popover\",width:\"500\",trigger:\"click\"}},[i(\"business-check\",{attrs:{data:t,show:t.row.show},on:{click:e.relativeBusinessClick,close:function(s){e.businessClose(s,t)}}}),e._v(\" \"),i(\"i\",{staticClass:\"wk wk-business\",staticStyle:{color:\"#FC6E51\"},style:{opacity:t.row.businessCount>0?1:0},attrs:{slot:\"reference\"},on:{click:function(s){e.businessCheckClick(s,t)}},slot:\"reference\"})],1)]}}])}),e._v(\" \"),e._l(e.fieldList,function(t,s){return i(\"el-table-column\",{key:s,attrs:{fixed:0==s,prop:t.prop,label:t.label,width:t.width,sortable:\"poolDay\"!=t.prop&&\"custom\",\"show-overflow-tooltip\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(s){return[\"dealStatus\"==t.prop?[i(\"i\",{class:e._f(\"dealIcon\")(s.row[t.prop])}),e._v(\" \"),i(\"span\",[e._v(e._s(e._f(\"dealName\")(s.row[t.prop])))])]:\"status\"==t.prop?[2==s.row.status?i(\"i\",{staticClass:\"wk wk-circle-password customer-lock\"}):e._e()]:[e._v(e._s(e.fieldFormatter(s.row,s.column)))]]}}])})}),e._v(\" \"),i(\"el-table-column\"),e._v(\" \"),i(\"el-table-column\",{attrs:{label:\"关注\",align:\"center\",fixed:\"right\",width:\"60\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[i(\"el-tooltip\",{attrs:{content:0==t.row.star?\"添加关注\":\"取消关注\",effect:\"dark\",placement:\"top\"}},[i(\"i\",{staticClass:\"wk wk-focus-on focus-icon\",class:{active:0!=t.row.star},on:{click:function(s){e.toggleStar(t.row)}}})])]}}])}),e._v(\" \"),i(\"el-table-column\",{attrs:{resizable:!1,fixed:\"right\",width:\"40\"},scopedSlots:e._u([{key:\"header\",fn:function(t){return[i(\"field-set\",{attrs:{\"crm-type\":e.crmType},on:{change:e.setSave}})]}}])})],2),e._v(\" \"),i(\"div\",{staticClass:\"p-contianer\"},[i(\"el-pagination\",{staticClass:\"p-bar\",attrs:{\"current-page\":e.currentPage,\"page-sizes\":e.pageSizes,\"page-size\":e.pageSize,total:e.total,\"pager-count\":5,background:\"\",layout:\"prev, pager, next, sizes, total, jumper\"},on:{\"update:pageSize\":function(t){e.pageSize=t},\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)],1),e._v(\" \"),i(\"c-r-m-all-detail\",{staticClass:\"d-view\",attrs:{visible:e.showDview,\"crm-type\":e.rowType,id:e.rowID},on:{\"update:visible\":function(t){e.showDview=t},handle:e.handleHandle}}),e._v(\" \"),e.createShow?i(\"c-r-m-all-create\",{attrs:{\"crm-type\":e.createType,action:e.createAction},on:{close:function(t){e.createShow=!1},\"save-success\":e.saveSuccess}}):e._e()],1)},[],!1,null,\"5930102a\",null);h.options.__file=\"index.vue\";t.default=h.exports},ugew:function(e,t,s){e.exports=s.p+\"static/img/expense.29e9174.png\"},wbJn:function(e,t,s){e.exports=s.p+\"static/img/product.663b457.png\"},wfwE:function(e,t,s){e.exports=s.p+\"static/img/customer.6f13c37.png\"},wjQc:function(e,t,s){\"use strict\";var i=s(\"On0+\");s.n(i).a},\"wu/m\":function(e,t,s){e.exports=s.p+\"static/img/check_create.09736ed.png\"},xmeh:function(e,t,s){\"use strict\";var i=s(\"cBfe\");s.n(i).a},y4JV:function(e,t,s){e.exports=s.p+\"static/img/check_suc.e52db27.png\"},zowB:function(e,t,s){\"use strict\";var i=s(\"GzrR\");s.n(i).a},zqSx:function(e,t,s){\"use strict\";s.r(t);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"tUbT\"),l=s(\"BRlT\"),o=s(\"TnB8\"),c=s(\"L2JU\"),r={name:\"CustomerAllIndex\",components:{CustomerIndex:n.default,NearbyIndex:l.default,SeasIndex:o.default},props:{},data:function(){return{componentName:\"\"}},computed:a()({},Object(c.b)([\"crm\"])),watch:{},mounted:function(){this.crm&&this.crm.customer?this.componentName=\"CustomerIndex\":this.crm&&this.crm.pool?this.componentName=\"SeasIndex\":this.crm&&this.crm.customer&&this.crm.customer.nearbyCustomer&&(this.componentName=\"NearbyIndex\")},beforeDestroy:function(){},methods:{menuSelect:function(e,t){this.componentName={customer:\"CustomerIndex\",seas:\"SeasIndex\",nearby:\"NearbyIndex\"}[e]}}},u=(s(\"5ttW\"),s(\"KHd+\")),d=Object(u.a)(r,function(){var e=this.$createElement,t=this._self._c||e;return t(\"keep-alive\",[t(this.componentName,{tag:\"component\",on:{\"menu-select\":this.menuSelect}})],1)},[],!1,null,\"6bff6ce0\",null);d.options.__file=\"AllIndex.vue\";t.default=d.exports},zsVz:function(e,t,s){\"use strict\";s.d(t,\"g\",function(){return a}),s.d(t,\"e\",function(){return n}),s.d(t,\"a\",function(){return l}),s.d(t,\"b\",function(){return o}),s.d(t,\"d\",function(){return c}),s.d(t,\"c\",function(){return r}),s.d(t,\"f\",function(){return u}),s.d(t,\"h\",function(){return d});var i=s(\"t3Un\");function a(e){return Object(i.a)({url:\"oaTask/queryTaskList\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function n(e){return Object(i.a)({url:\"workTask/saveWorkTask\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function l(e){return Object(i.a)({url:\"workTask/queryTaskInfo/\"+e.taskId,method:\"post\"})}function o(e){return Object(i.a)({url:\"workTask/queryTrashTaskInfo\",method:\"post\",data:e})}function c(e){return Object(i.a)({url:\"workTaskLog/queryTaskLog/\"+e.taskId,method:\"post\"})}function r(e){return Object(i.a)({url:\"workTaskRelation/saveWorkTaskRelation\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function u(e){return Object(i.a)({url:\"oaTask/deleteWorkTaskLabel\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function d(e){return Object(i.a)({url:\"oaTask/oaTaskExport\",method:\"post\",data:e,responseType:\"blob\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}}}]);","extractedComments":[]}