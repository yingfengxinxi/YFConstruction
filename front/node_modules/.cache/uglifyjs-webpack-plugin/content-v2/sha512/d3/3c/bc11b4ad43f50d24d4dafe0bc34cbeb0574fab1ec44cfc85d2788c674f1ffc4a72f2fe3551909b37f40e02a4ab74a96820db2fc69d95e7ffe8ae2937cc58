{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-620e\"],{Cbuk:function(e,t,n){},EBQf:function(e,t,n){\"use strict\";var s=n(\"QbLZ\"),i=n.n(s),a=n(\"mkuN\"),o=n(\"/407\"),c=n(\"L2JU\"),l={name:\"RelatedBusiness\",components:{CrmRelative:a.a,RelatedBusinessCell:o.default},props:{marginLeft:{type:String,default:\"20px\"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},showFoot:{type:Boolean,default:!1},showAdd:{type:Boolean,default:!0}},data:function(){return{showTypes:[\"customer\",\"contacts\",\"business\",\"contract\"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1}},computed:i()({},Object(c.b)([\"crm\"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(e){var t=this;this.showPopover=!1,this.relatedListData=e.data;var n=function(n){var s=e.data[n];t.relevanceAll[n+\"Ids\"]=s.map(function(e){return e[n+\"Id\"]})};for(var s in e.data)n(s);this.$emit(\"checkInfos\",this.relevanceAll,e.data)},delRelevance:function(e,t,n){this.$emit(\"unbind\",e,n,t)},checkRelatedDetail:function(e,t){t.key=t[e+\"Id\"]||t.id,this.$emit(\"checkRelatedDetail\",e,t)}}},r=(n(\"PdhK\"),n(\"KHd+\")),u=Object(r.a)(l,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"related-business\",style:{\"margin-left\":e.marginLeft}},[e.showAdd?n(\"el-popover\",{attrs:{placement:\"right-end\",width:\"800\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:\"showPopover\"}},[e.showRelative?n(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:e.showPopover,radio:!1,\"selected-data\":e.relatedListData,\"show-types\":e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(\" \"),e.showCRMPermission?n(\"span\",{staticClass:\"add-btn\",attrs:{slot:\"reference\"},on:{click:function(t){e.showRelative=!0}},slot:\"reference\"},[n(\"i\",{staticClass:\"wk wk-l-plus\"}),e._v(\" \"),n(\"span\",{staticClass:\"label\"},[e._v(\"关联业务\")])]):e._e()],1):e._e(),e._v(\" \"),e._l(e.relatedListData,function(t,s){return n(\"div\",{key:s,staticStyle:{\"margin-top\":\"10px\"}},e._l(t,function(t,i){return n(\"related-business-cell\",{key:i,attrs:{data:t,\"cell-index\":i,type:s,\"show-foot\":e.showFoot},on:{unbind:e.delRelevance,detail:function(n){e.checkRelatedDetail(s,t)}}})}))})],2)},[],!1,null,\"2724a194\",null);u.options.__file=\"RelatedBusiness.vue\";t.a=u.exports},HtQe:function(e,t,n){\"use strict\";var s=n(\"OM3V\");n.n(s).a},\"Ir+r\":function(e,t,n){\"use strict\";n.d(t,\"c\",function(){return i}),n.d(t,\"a\",function(){return a}),n.d(t,\"b\",function(){return o});var s=n(\"t3Un\");function i(e){return Object(s.a)({url:\"workTaskComment/setComment\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function a(e){return Object(s.a)({url:\"workTaskComment/deleteComment\",method:\"post\",data:e})}function o(e){return Object(s.a)({url:\"workTaskComment/queryCommentList\",method:\"post\",data:e})}},OM3V:function(e,t,n){},OdVz:function(e,t,n){\"use strict\";var s=n(\"VlxE\");n.n(s).a},PdhK:function(e,t,n){\"use strict\";var s=n(\"Cbuk\");n.n(s).a},VlxE:function(e,t,n){},d5Rn:function(e,t,n){},dPzk:function(e,t,n){\"use strict\";var s=n(\"Xjjk\"),i=n.n(s),a={name:\"ReplyComment\",components:{Emoji:n(\"u+Mw\").a},data:function(){return{commentLoading:!1,blurIndex:0,commentsTextarea:\"\",showEmoji:!1,showNoFocus:!1}},methods:{blurFun:function(e){this.blurIndex=e.target.selectionEnd},selectEmoji:function(e){if(this.commentsTextarea&&this.commentsTextarea.length+e.length<=2e3||!this.commentsTextarea){var t=this.commentsTextarea.split(\"\");t.splice(this.blurIndex,0,e),this.commentsTextarea=t.join(\"\"),this.showEmoji=!1}},commentSubmit:function(){this.commentsTextarea?this.$emit(\"reply\",i()(this.commentsTextarea)):this.$message.error(\"回复内容不能为空\")},closeComment:function(){this.showEmoji=!1,this.$emit(\"close\"),this.toggleFocus()},toggleFocus:function(e){this.showNoFocus=\"boolean\"==typeof e?e:!this.showNoFocus,this.$emit(\"toggle\",this.showNoFocus)}}},o=(n(\"szeO\"),n(\"KHd+\")),c=Object(o.a)(a,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.commentLoading,expression:\"commentLoading\"}],staticClass:\"reply-comment\"},[e.showNoFocus?n(\"div\",{staticClass:\"no-focus\",on:{click:function(t){e.toggleFocus()}}},[e._v(\"\\n    请输入回复内容\\n  \")]):[n(\"el-input\",{attrs:{rows:3,maxlength:2e3,\"show-word-limit\":\"\",type:\"textarea\",placeholder:\"请输入回复内容\"},on:{blur:e.blurFun},model:{value:e.commentsTextarea,callback:function(t){e.commentsTextarea=t},expression:\"commentsTextarea\"}}),e._v(\" \"),n(\"div\",{staticClass:\"btn-group\"},[n(\"el-popover\",{attrs:{placement:\"top\",width:\"400\",trigger:\"click\"},model:{value:e.showEmoji,callback:function(t){e.showEmoji=t},expression:\"showEmoji\"}},[n(\"emoji\",{on:{select:e.selectEmoji}}),e._v(\" \"),n(\"i\",{staticClass:\"wk wk-expression smiling-img\",attrs:{slot:\"reference\"},slot:\"reference\"})],1),e._v(\" \"),n(\"div\",{staticClass:\"btn-box\"},[n(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.commentSubmit}},[e._v(\"回复\")]),e._v(\" \"),n(\"el-button\",{on:{click:e.closeComment}},[e._v(\"取消\")])],1)],1)]],2)},[],!1,null,\"cdcf716e\",null);c.options.__file=\"ReplyComment.vue\";t.a=c.exports},szeO:function(e,t,n){\"use strict\";var s=n(\"d5Rn\");n.n(s).a},\"u+Mw\":function(e,t,n){\"use strict\";var s=n(\"GQeE\"),i=n.n(s),a=n(\"sCIN\"),o={name:\"Emoji\",data:function(){return{emojiData:a.a,pannels:[\"表情\",\"自然\",\"物品\",\"地点\",\"符号\"],activeIndex:0}},computed:{emojis:function(){var e=this;return this.pannels.map(function(t){return i()(e.emojiData[t])})}},created:function(){},methods:{changeActive:function(e){this.activeIndex=e},getPureName:function(e){return e.replace(/:/g,\"\")},selectItem:function(e){this.$emit(\"select\",e)}}},c=(n(\"HtQe\"),n(\"KHd+\")),l=Object(c.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"emoji\"},[n(\"ul\",{staticClass:\"emoji-controller\"},e._l(e.pannels,function(t,s){return n(\"li\",{key:s,class:{active:s===e.activeIndex},on:{click:function(t){e.changeActive(s)}}},[e._v(\"\\n      \"+e._s(t)+\"\\n    \")])})),e._v(\" \"),n(\"ul\",{staticClass:\"emoji-container\"},e._l(e.emojis,function(t,s){return s===e.activeIndex?n(\"li\",{key:s,staticStyle:{padding:\"0\"}},[e._v(\"\\n      \"+e._s(t)+\"--\"+e._s(s)+\"\\n      \"),e._l(t,function(t,s){return n(\"a\",{key:s,attrs:{href:\"javascript:;\"},on:{click:function(n){e.selectItem(t)}}},[n(\"span\",{staticClass:\"emoji-item\",class:\"sprite-\"+e.getPureName(t),attrs:{title:t}})])})],2):e._e()}))])},[],!1,null,\"36243ed9\",null);l.options.__file=\"Emoji.vue\";t.a=l.exports},z7oh:function(e,t,n){\"use strict\";var s=n(\"QbLZ\"),i=n.n(s),a=n(\"dPzk\"),o=n(\"Ir+r\"),c=n(\"L2JU\"),l=n(\"Xjjk\"),r=n.n(l),u={name:\"CommentList\",components:{ReplyComment:a.a},props:{list:{type:Array,required:!0},id:{type:[String,Number],required:!0},type:[String,Number]},data:function(){return{replyIndex:null,commentLoading:!1}},computed:i()({},Object(c.b)([\"userInfo\"])),methods:{handleToReply:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e+(null!==t?\"-\"+t:\"\");this.$emit(\"close-other-reply\"),n!==this.replyIndex&&(this.replyIndex=n)},closeReply:function(){this.replyIndex=null},handleReply:function(e){var t=this,n={type:this.type,content:r()(e),typeId:this.id},s=null,i=this.replyIndex.split(\"-\"),a=this.list[i[0]];i[1]&&(s=a.childCommentList[i[1]]),a&&(n.mainId=a.commentId,n.pid=a.userId),s&&(n.pid=s.userId),this.commentLoading=!0,Object(o.c)(n).then(function(e){e.data.user={userId:t.userInfo.id,realname:t.userInfo.realname,img:t.userInfo.img},e.data.replyUser=s?s.user:a.user,t.list[i[0]].childCommentList.push(e.data),t.replyIndex=null,t.commentLoading=!1}).catch(function(){t.commentLoading=!1})},handleToDelete:function(e,t){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(o.a)({commentId:e.commentId}).then(function(e){n.$message({type:\"success\",message:\"删除成功!\"}),s>=0?n.list[t].childCommentList.splice(s,1):n.$emit(\"delete\",t)})}).catch(function(){n.$message({type:\"info\",message:\"已取消删除\"})})}}},m=(n(\"OdVz\"),n(\"KHd+\")),d=Object(m.a)(u,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"comment-list\"},e._l(e.list,function(t,s){return n(\"div\",{key:s,staticClass:\"comment-list-item\"},[n(\"div\",{staticClass:\"parent-reply reply\"},[n(\"div\",{staticClass:\"user-info\"},[n(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:t.user.realname,id:t.user.userId,size:34,src:t.user.img,disabled:!1}}),e._v(\" \"),n(\"div\",{staticClass:\"user-info__bd\"},[n(\"div\",{staticClass:\"user\"},[e._v(e._s(t.user.realname))]),e._v(\" \"),n(\"div\",{staticClass:\"time\"},[e._v(\"\\n            \"+e._s(t.createTime)+\"\\n          \")])]),e._v(\" \"),n(\"div\",{staticClass:\"control\"},[n(\"span\",{staticClass:\"reply-btn\",on:{click:function(t){e.handleToReply(s)}}},[n(\"i\",{staticClass:\"wk wk-reply\"}),e._v(\" \"),n(\"span\",[e._v(\"回复\")])]),e._v(\" \"),n(\"span\",{staticClass:\"delete-btn\",on:{click:function(n){e.handleToDelete(t,s)}}},[n(\"i\",{staticClass:\"wk wk-s-delete\"}),e._v(\" \"),n(\"span\",[e._v(\"删除\")])])])],1),e._v(\" \"),n(\"div\",{staticClass:\"content\",domProps:{innerHTML:e._s(e.emoji(t.content))}}),e._v(\" \"),e.replyIndex===String(s)?n(\"reply-comment\",{on:{reply:e.handleReply,close:function(t){e.replyIndex=null}}}):e._e()],1),e._v(\" \"),t.childCommentList&&t.childCommentList.length>0?e._l(t.childCommentList,function(t,i){return n(\"div\",{key:i},[n(\"div\",{staticClass:\"child-reply reply\"},[n(\"div\",{staticClass:\"user-info\"},[n(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:t.user.realname,id:t.user.userId,size:34,src:t.user.img,disabled:!1}}),e._v(\" \"),n(\"div\",{staticClass:\"user-info__bd\"},[n(\"div\",{staticClass:\"user\"},[e._v(\"\\n                \"+e._s(t.user.realname)+\"\\n              \")]),e._v(\" \"),n(\"div\",{staticClass:\"time\"},[e._v(\"\\n                \"+e._s(t.createTime)+\"\\n              \")])]),e._v(\" \"),n(\"div\",{staticClass:\"control\"},[n(\"span\",{staticClass:\"reply-btn\",on:{click:function(t){e.handleToReply(s,i)}}},[n(\"i\",{staticClass:\"wk wk-reply\"}),e._v(\" \"),n(\"span\",[e._v(\"回复\")])]),e._v(\" \"),n(\"span\",{staticClass:\"delete-btn\",on:{click:function(n){e.handleToDelete(t,s,i)}}},[n(\"i\",{staticClass:\"wk wk-s-delete\"}),e._v(\" \"),n(\"span\",[e._v(\"删除\")])])])],1),e._v(\" \"),n(\"div\",{staticClass:\"child-content\"},[n(\"span\",[e._v(\"\\n              回复 @\"+e._s(t.replyUser.realname)+\"：\\n            \")]),e._v(\" \"),n(\"span\",{staticClass:\"content\",domProps:{innerHTML:e._s(e.emoji(t.content))}})]),e._v(\" \"),e.replyIndex===s+\"-\"+i?n(\"reply-comment\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.commentLoading,expression:\"commentLoading\"}],on:{reply:e.handleReply,close:function(t){e.replyIndex=null}}}):e._e()],1)])}):e._e()],2)}))},[],!1,null,\"714ff9da\",null);d.options.__file=\"CommentList.vue\";t.a=d.exports}}]);","extractedComments":[]}