{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-01b8\"],{\"7rD8\":function(t,e,a){\"use strict\";a.r(e);var i=a(\"FyfS\"),l=a.n(i),s=a(\"Ajln\"),n=a(\"4dIA\"),o=a(\"pKm3\"),c=a(\"9GgJ\"),d={components:{TaskDetail:o.default,TaskCell:n.default,XrHeader:c.a},data:function(){return{loading:!0,labelId:\"\",taskList:[],colorList:[\"#53D397\",\"#20C1BD\",\"#58DADA\",\"#0FC9E7\",\"#3498DB\",\"#4586FF\",\"#8983F3\",\"#AEA1EA\",\"#FF6699\",\"#F24D70\",\"#FF6F6F\"],labelName:\"\",labelColor:\"#53D397\",collapseNames:[],editLabelName:\"\",editLabelColor:\"\",labelSetShow:!1,taskID:\"\",detailIndex:-1,detailSection:-1,taskDetailShow:!1}},beforeRouteUpdate:function(t,e,a){this.labelId=t.params.id,this.taskList=[],this.collapseNames=[],this.getDetail({labelId:t.params.id}),this.getList(),a()},created:function(){this.labelId=this.$route.params.id,this.getDetail({labelId:this.$route.params.id}),this.getList()},mounted:function(){document.getElementById(\"project-container\").addEventListener(\"click\",this.taskShowHandle,!1)},methods:{getDetail:function(t){var e=this;Object(s.d)(t).then(function(t){e.labelName=t.data.name,e.labelColor=t.data.color}).catch(function(){})},getList:function(){var t=this;this.loading=!0,Object(s.b)({labelId:this.labelId}).then(function(e){t.taskList=e.data||[];var a=!0,i=!1,s=void 0;try{for(var n,o=l()(t.taskList);!(a=(n=o.next()).done);a=!0){var c=n.value,d=!0,r=!1,u=void 0;try{for(var h,b=l()(c.list);!(d=(h=b.next()).done);d=!0){var m=h.value;5==m.status&&(m.checked=!0)}}catch(t){r=!0,u=t}finally{try{!d&&b.return&&b.return()}finally{if(r)throw u}}}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}t.collapseNames=e.data.map(function(t){return t.workId}),t.loading=!1}).catch(function(){t.loading=!1})},labelSetSave:function(){var t=this;Object(s.f)({name:this.editLabelName,labelId:this.labelId,color:this.editLabelColor}).then(function(e){t.labelName=t.editLabelName,t.labelColor=t.editLabelColor,t.labelSetShow=!1})},labelSetClick:function(){this.editLabelName=this.labelName,this.editLabelColor=this.labelColor},taskCellHandle:function(t){if(\"view\"==t.type){var e=t.data;this.taskID=e.item.taskId,this.detailIndex=e.index,this.detailSection=e.section,this.taskDetailShow=!0}},closeBtn:function(){this.taskDetailShow=!1},detailHandle:function(t){if(0==t.index||t.index)if(\"title-check\"==t.type)this.$set(this.taskList[t.section].list[t.index],\"checked\",t.value);else if(\"delete\"==t.type||\"activate-task\"==t.type||\"recover-task\"==t.type||\"thorough-delete-task\"==t.type)this.taskList.splice(t.index,1);else if(\"change-stop-time\"==t.type){new Date(t.value).getTime()/1e3+86399>(new Date).getTime()/1e3?this.taskList[t.section].list[t.index].isEnd=!1:this.taskList[t.section].list[t.index].isEnd=!0,this.taskList[t.section].list[t.index].stopTime=t.value}else if(\"change-priority\"==t.type)this.taskList[t.section].list[t.index].priority=t.value.id;else if(\"change-name\"==t.type)this.taskList[t.section].list[t.index].name=t.value;else if(\"change-comments\"==t.type){var e=this.taskList[t.section].list[t.index].commentCount;\"add\"==t.value?this.taskList[t.section].list[t.index].commentCount=e+1:this.taskList[t.section].list[t.index].commentCount=e-1}else\"change-sub-task\"==t.type?(this.taskList[t.section].list[t.index].childWCCount=t.value.subdonecount,this.taskList[t.section].list[t.index].childAllCount=t.value.allcount):\"change-main-user\"==t.type?this.taskList[t.section].list[t.index].mainUser=t.value:\"change-label\"==t.type&&(this.taskList[t.section].list[t.index].labelList=t.value)},taskShowHandle:function(t){if(this.$refs.particulars&&!this.$refs.particulars.$el.contains(t.target)){for(var e=!0,a=document.getElementsByClassName(\"board-column\"),i=0;i<a.length;i++){if(a[i].contains(t.target)){e=!1;break}}this.taskDetailShow=!e}}}},r=(a(\"I7XJ\"),a(\"KHd+\")),u=Object(r.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"project-tag\"},[a(\"xr-header\",{staticClass:\"xr-header\",attrs:{\"icon-color\":t.labelColor||\"#4AB8B8\",\"icon-class\":\"wk wk-label\"}},[a(\"span\",{attrs:{slot:\"label\"},slot:\"label\"},[t._v(t._s(t.labelName))]),t._v(\" \"),a(\"el-popover\",{attrs:{slot:\"label\",placement:\"bottom-start\",width:\"300\",trigger:\"click\"},slot:\"label\",model:{value:t.labelSetShow,callback:function(e){t.labelSetShow=e},expression:\"labelSetShow\"}},[a(\"div\",{staticClass:\"new-tag-dialog\"},[a(\"div\",{staticClass:\"title\"},[a(\"span\",[t._v(\"标签设置\")]),t._v(\" \"),a(\"span\",{staticClass:\"el-icon-close rt\",on:{click:function(e){t.labelSetShow=!1}}})]),t._v(\" \"),a(\"div\",{staticClass:\"search\"},[a(\"el-input\",{attrs:{size:\"mini\",placeholder:\"输入标签名\"},model:{value:t.editLabelName,callback:function(e){t.editLabelName=e},expression:\"editLabelName\"}}),t._v(\" \"),a(\"span\",{staticClass:\"checked-color\",style:{background:t.editLabelColor}})],1),t._v(\" \"),a(\"div\",{staticClass:\"color-box\"},t._l(t.colorList,function(e,i){return a(\"span\",{key:i,style:{background:e},on:{click:function(a){t.editLabelColor=e}}})})),t._v(\" \"),a(\"div\",{staticClass:\"footer\"},[a(\"el-button\",{attrs:{type:\"primary\",size:\"medium\"},on:{click:t.labelSetSave}},[t._v(\"保存\")]),t._v(\" \"),a(\"el-button\",{attrs:{size:\"medium\"},on:{click:function(e){t.labelSetShow=!1}}},[t._v(\"取消\")])],1)]),t._v(\" \"),a(\"i\",{staticClass:\"wk wk-manage img-set\",attrs:{slot:\"reference\"},on:{click:t.labelSetClick},slot:\"reference\"})])],1),t._v(\" \"),a(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"content\"},[a(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:0==t.taskList.length&&0==t.loading,expression:\"taskList.length == 0 && loading == false\"}],staticClass:\"content-body-items\"},[a(\"el-collapse\",{model:{value:t.collapseNames,callback:function(e){t.collapseNames=e},expression:\"collapseNames\"}},t._l(t.taskList,function(e,i){return a(\"el-collapse-item\",{key:i,staticClass:\"list-box\",attrs:{name:e.workId}},[a(\"i\",{staticClass:\"wukong wukong-subproject\",style:{color:e.color?e.color:\"#4AB8B8\"},attrs:{slot:\"title\"},slot:\"title\"}),t._v(\" \"),a(\"span\",{staticClass:\"title\",attrs:{slot:\"title\"},slot:\"title\"},[t._v(t._s(e.name))]),t._v(\" \"),t._l(e.list,function(e,l){return a(\"task-cell\",{key:l,staticClass:\"item-list\",attrs:{data:e,\"data-section\":i,\"data-index\":l},on:{\"on-handle\":t.taskCellHandle}})})],2)}))],1)]),t._v(\" \"),t.taskDetailShow?a(\"task-detail\",{ref:\"particulars\",attrs:{id:t.taskID,\"detail-index\":t.detailIndex,\"detail-section\":t.detailSection},on:{\"on-handle\":t.detailHandle,close:t.closeBtn}}):t._e()],1)},[],!1,null,\"876b51b6\",null);u.options.__file=\"index.vue\";e.default=u.exports},Ebat:function(t,e,a){},I7XJ:function(t,e,a){\"use strict\";var i=a(\"Ebat\");a.n(i).a}}]);","extractedComments":[]}