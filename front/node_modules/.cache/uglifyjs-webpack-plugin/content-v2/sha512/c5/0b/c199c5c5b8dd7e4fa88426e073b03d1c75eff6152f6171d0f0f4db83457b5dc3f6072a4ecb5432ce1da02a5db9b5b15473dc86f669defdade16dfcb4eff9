{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-1603\"],{\"+xXq\":function(t,e,s){t.exports=s.p+\"static/img/check_revoke.0500d70.png\"},\"1CbL\":function(t,e,s){},\"31UX\":function(t,e,s){\"use strict\";s.r(e);var i=s(\"4d7F\"),a=s.n(i),n=s(\"CMIa\"),o=s(\"ehos\"),l=s(\"7Qib\");e.default={data:function(){return{chartObj:null,chartOtherObj:null,chartColors:[\"#6CA2FF\",\"#6AC9D7\",\"#72DCA2\",\"#48E78D\",\"#FECD51\",\"#DBB375\",\"#FF7474\",\"#F59561\",\"#A3AEBC\",\"#4C84FF\",\"#0DBEB4\",\"#00DEDE\",\"#FFAA00\",\"#C7C116\",\"#F7A57C\",\"#F661AC\",\"#8652EE\"],currentPage:1,pageSizes:[15,30,45,60],pageSize:0,total:0,toolbox:{showTitle:!1,feature:{saveAsImage:{show:!0,pixelRatio:2}}}}},components:{FiltrateHandleView:n.default},props:{},computed:{},watch:{},mounted:function(){var t=this;this.debouncedResize=Object(o.debounce)(300,this.resizeFn),this.$nextTick(function(){window.addEventListener(\"resize\",t.debouncedResize)})},beforeDestroy:function(){window.removeEventListener(\"resize\",this.debouncedResize)},methods:{resizeFn:function(){this.chartObj&&this.chartObj.resize(),this.chartOtherObj&&this.chartOtherObj.resize()},handleSizeChange:function(t){this.pageData.limit=t,this.getList(this.pageData)},handleCurrentChange:function(t){this.pageData.page=t,this.getList(this.pageData)},requestExportInfo:function(t,e){return new a.a(function(s,i){t(e).then(function(t){Object(l.c)(t),s&&s(t)}).catch(function(t){i&&i(t)})})}},deactivated:function(){}}},\"5pSV\":function(t,e,s){\"use strict\";var i=s(\"Rq8O\");s.n(i).a},\"6pZM\":function(t,e,s){t.exports=s.p+\"static/img/check_wait.81cfb8e.png\"},\"74lk\":function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return a}),s.d(e,\"b\",function(){return n}),s.d(e,\"d\",function(){return o}),s.d(e,\"e\",function(){return l}),s.d(e,\"c\",function(){return c});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"bi/bi/taskCompleteStatistics\",method:\"post\",data:t})}function n(t){return Object(i.a)({url:\"bi/bi/taskCompleteStatisticsExport\",method:\"post\",data:t,responseType:\"blob\"})}function o(t){return Object(i.a)({url:\"bi/bi/productStatistics\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function l(t){return Object(i.a)({url:\"bi/bi/productStatisticsExport\",method:\"post\",data:t,responseType:\"blob\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function c(t){return Object(i.a)({url:\"biFunnel/sellFunnel\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}},\"77fj\":function(t,e,s){\"use strict\";var i=s(\"Btlj\");s.n(i).a},AVjW:function(t,e,s){\"use strict\";var i=s(\"gIBH\");s.n(i).a},Btlj:function(t,e,s){},BzA1:function(t,e,s){\"use strict\";s.r(e);var i=s(\"a/5N\"),a={name:\"ImportInfo\",components:{},props:{list:Array},data:function(){return{}},computed:{showList:function(){return this.list.filter(function(t){return\"file\"!==t.formType})}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{getValueContent:function(t){if(\"map_address\"===t.formType)return t.value?t.value.detailAddress:\"\";if(\"structure\"===t.formType||\"user\"===t.formType||\"checkbox\"===t.formType){if(Object(i.a)(t.value)){var e={structure:\"name\",user:\"realname\",checkbox:\"\"}[t.formType];return t.value.map(function(t){return e?t[e]:t}).join(\"，\")}return\"\"}if(\"single_user\"===t.formType)return Object(i.c)(t.value)&&t.value.realname?t.value.realname:\"\";if(\"customer\"===t.formType||\"business\"===t.formType||\"contract\"===t.formType||\"contacts\"===t.formType||\"category\"===t.formType||\"statusName\"===t.formType||\"typeName\"===t.formType){var s={customer:\"customerName\",business:\"businessName\",contract:\"contractNum\",contacts:\"contactsName\",category:\"categoryName\",statusName:\"statusName\",typeName:\"typeName\"}[t.formType];return Object(i.a)(t.value)?t.value.length>0?t.value[0][s]:\"\":t.value?t.value[s]:\"\"}return t.value}}},n=(s(\"AVjW\"),s(\"KHd+\")),o=Object(n.a)(a,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"content\"},[s(\"div\",{staticClass:\"content-title\"},[t._v(\"基本信息\")]),t._v(\" \"),t._l(t.showList,function(e,i){return s(\"p\",{key:i,staticClass:\"detail-cell\"},[s(\"span\",{staticClass:\"detail-cell__label\"},[t._v(\"\\n      \"+t._s(e.name)+\"\\n    \")]),s(\"br\"),t._v(\" \"),s(\"span\",{staticClass:\"detail-cell__value\"},[t._v(\"\\n      \"+t._s(t.getValueContent(e))+\"\\n    \")])])})],2)},[],!1,null,\"74c3ac7c\",null);o.options.__file=\"ImportInfo.vue\";e.default=o.exports},C3Po:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"8GhS\"),o=s(\"zsVz\"),l={name:\"TaskQuickAdd\",components:{XhUserCell:n.p},props:{params:Object},data:function(){return{sendLoading:!1,isUnfold:!1,sendContent:\"\",sendStopTime:\"\",mainUser:[]}},computed:{createMainUser:function(){return this.mainUser&&this.mainUser.length?this.mainUser[0]:null}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{inputFocus:function(){var t=this;this.$emit(\"focus\"),this.isUnfold=!0,this.$nextTick(function(){t.$refs.input.focus()})},selectMainUser:function(t){this.mainUser=t.value},send:function(){var t=this;if(this.sendContent.length){this.sendLoading=!0;var e={name:this.sendContent,stopTime:this.sendStopTime,mainUserId:this.createMainUser?this.createMainUser.userId:\"\"};this.params&&(e=a()({},e,this.params)),Object(o.e)(e).then(function(e){t.sendLoading=!1,t.$message.success(\"新建成功\"),t.resetSendData(),t.$emit(\"send\")}).catch(function(){t.sendLoading=!1})}else this.$message.error(\"请填写任务标题\")},resetSendData:function(){this.sendContent=\"\",this.sendStopTime=\"\",this.mainUser=[],this.isUnfold=!1},addClose:function(){this.isUnfold=!1}}},c=(s(\"5pSV\"),s(\"KHd+\")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.sendLoading,expression:\"sendLoading\"}],staticClass:\"task-quick-add\",class:[\"add\",{unfold:t.isUnfold,\"is-close\":!t.isUnfold}]},[t.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:t.addClose}}):t._e(),t._v(\" \"),s(\"el-input\",{ref:\"input\",staticClass:\"input\",attrs:{maxlength:100,\"prefix-icon\":t.isUnfold?\"\":\"el-icon-plus\",placeholder:\"添加任务\"},on:{focus:t.inputFocus},model:{value:t.sendContent,callback:function(e){t.sendContent=e},expression:\"sendContent\"}}),t._v(\" \"),s(\"flexbox\",{staticClass:\"add-info\"},[s(\"el-date-picker\",{ref:\"endTime\",class:{\"no-time-top\":!t.sendStopTime},attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"\"},model:{value:t.sendStopTime,callback:function(e){t.sendStopTime=e},expression:\"sendStopTime\"}}),t._v(\" \"),s(\"xh-user-cell\",{attrs:{value:t.mainUser,radio:\"\",placement:\"top\"},on:{\"value-change\":t.selectMainUser}},[s(\"div\",{staticClass:\"select-user\",attrs:{slot:\"reference\"},slot:\"reference\"},[t.createMainUser?s(\"xr-avatar\",{attrs:{name:t.createMainUser.realname,size:24,src:t.createMainUser.img}}):s(\"i\",{staticClass:\"wk wk-persons add-info--person\"})],1)])],1),t._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.send,expression:\"send\"}],staticClass:\"send-btn\",attrs:{icon:\"wk wk-top\",type:\"primary\"}},[t._v(\"发布\")])],1)},[],!1,null,\"38430333\",null);r.options.__file=\"TaskQuickAdd.vue\";e.default=r.exports},CMIa:function(t,e,s){\"use strict\";s.r(e);var i=s(\"KTTK\"),a=s(\"ERJp\"),n=s(\"6iAj\"),o=s(\"UCfG\"),l=s(\"HHBN\"),c=s(\"ZX9L\"),r=s(\"wd/R\"),u=s.n(r),d={name:\"FiltrateHandleView\",components:{TimeTypeSelect:c.a,XhStructureCell:o.a,XhUserCell:l.a},props:{moduleType:{type:String},title:{type:String,default:\"\"},showFilterView:{default:!0,type:Boolean},showYearSelect:{default:!1,type:Boolean},showBusinessSelect:{default:!1,type:Boolean},showUserSelect:{default:!0,type:Boolean},showCustomSelect:{default:!1,type:Boolean},customDefault:\"\",customOptions:{default:function(){return[]},type:Array},showProductSelect:{default:!1,type:Boolean}},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},yearValue:\"\",timeTypeValue:{},dataSelect:1,structuresSelectValue:[],userSelectValue:[],businessOptions:[],businessStatusValue:\"\",productValue:[],productOptions:[],customValue:\"\"}},computed:{showUserStrucSelect:function(){return this.showUserSelect}},watch:{},mounted:function(){var t=this;this.showCustomSelect&&(this.customValue=this.customDefault),this.showYearSelect&&(this.yearValue=u()(new Date).year().toString()),this.$emit(\"load\"),this.showBusinessSelect?this.getBusinessStatusList(function(){t.postFiltrateValue()}):this.postFiltrateValue(),this.showProductSelect&&this.getProductCategoryIndex()},beforeDestroy:function(){},methods:{structureChange:function(t){this.structuresSelectValue=t.value||[]},userChange:function(t){this.userSelectValue=t.value||[]},customSelectChange:function(){this.$emit(\"typeChange\",this.customValue)},timeTypeChange:function(t){this.timeTypeValue=t},structuresValueChange:function(t){this.showUserSelect&&(this.userSelectValue=\"\",this.userOptions=[],this.getUserList())},getUserList:function(){var t=this,e={};e.deptId=this.structuresSelectValue,Object(i.u)(e).then(function(e){t.userOptions=e.data}).catch(function(){t.$emit(\"error\")})},getBusinessStatusList:function(t){var e=this;Object(a.v)().then(function(s){var i=s.data||[];e.businessOptions=i.filter(function(t){return 1===t.status}),e.businessOptions.length>0&&(e.businessStatusValue=e.businessOptions[0].typeId),t(!0)}).catch(function(){e.$emit(\"error\")})},getProductCategoryIndex:function(){var t=this;Object(n.L)({type:\"tree\"}).then(function(e){t.productOptions=e.data}).catch(function(){})},postFiltrateValue:function(){var t={};this.showUserStrucSelect?1==this.dataSelect&&(t.deptId=this.structuresSelectValue.length>0?this.structuresSelectValue[0].id:\"\"):t.deptId=this.structuresSelectValue.length>0?this.structuresSelectValue[0].id:\"\",this.showUserStrucSelect&&(t.isUser=2==this.dataSelect?1:0),this.showUserSelect&&2==this.dataSelect&&(t.userId=this.userSelectValue.length>0?this.userSelectValue[0].userId:\"\"),this.showBusinessSelect&&(t.typeId=this.businessStatusValue),this.showProductSelect&&(t.categoryId=this.productValue.length>0?this.productValue[this.productValue.length-1]:\"\"),this.showYearSelect?t.year=this.yearValue:\"custom\"==this.timeTypeValue.type?(t.startTime=this.timeTypeValue.startTime,t.endTime=this.timeTypeValue.endTime):t.type=this.timeTypeValue.value,this.$emit(\"change\",t)}}},p=(s(\"yl8z\"),s(\"KHd+\")),h=Object(p.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"flexbox\",{staticClass:\"filtrate-content\",attrs:{justify:\"flex-start\"}},[s(\"flexbox\",{staticClass:\"title-box\",attrs:{justify:\"flex-start\"}},[s(\"div\",{staticClass:\"icon-box\"},[s(\"span\",{staticClass:\"wk wk-my-task icon\"})]),t._v(\" \"),s(\"span\",{staticClass:\"text\"},[t._v(t._s(t.title))])]),t._v(\" \"),t.showFilterView?[t.showYearSelect?t._e():s(\"time-type-select\",{on:{change:t.timeTypeChange}}),t._v(\" \"),t.showYearSelect?s(\"el-date-picker\",{attrs:{clearable:!1,\"picker-options\":t.pickerOptions,type:\"year\",\"value-format\":\"yyyy\",placeholder:\"选择年\"},model:{value:t.yearValue,callback:function(e){t.yearValue=e},expression:\"yearValue\"}}):t._e(),t._v(\" \"),t.showUserStrucSelect?s(\"el-select\",{model:{value:t.dataSelect,callback:function(e){t.dataSelect=e},expression:\"dataSelect\"}},t._l([{label:\"按部门\",value:1},{label:\"按员工\",value:2}],function(t){return s(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})):t._e(),t._v(\" \"),1==t.dataSelect?s(\"xh-structure-cell\",{staticClass:\"xh-structure-cell\",attrs:{radio:\"\",placeholder:\"选择部门（默认为本部门及下属部门）\"},on:{\"value-change\":t.structureChange}}):t._e(),t._v(\" \"),2==t.dataSelect&&t.showUserSelect?s(\"xh-user-cell\",{staticClass:\"xh-user-cell\",attrs:{radio:\"\",placeholder:\"选择员工（默认为本人及下属）\\n\"},on:{\"value-change\":t.userChange}}):t._e(),t._v(\" \"),t.showBusinessSelect?s(\"el-select\",{attrs:{placeholder:\"商机组\"},model:{value:t.businessStatusValue,callback:function(e){t.businessStatusValue=e},expression:\"businessStatusValue\"}},t._l(t.businessOptions,function(t){return s(\"el-option\",{key:t.typeId,attrs:{label:t.name,value:t.typeId}})})):t._e(),t._v(\" \"),t.showProductSelect?s(\"el-cascader\",{staticStyle:{width:\"100%\"},attrs:{options:t.productOptions,\"show-all-levels\":!1,props:{children:\"children\",label:\"label\",value:\"categoryId\"},\"change-on-select\":\"\"},model:{value:t.productValue,callback:function(e){t.productValue=e},expression:\"productValue\"}}):t._e(),t._v(\" \"),t.showCustomSelect?s(\"el-select\",{on:{change:t.customSelectChange},model:{value:t.customValue,callback:function(e){t.customValue=e},expression:\"customValue\"}},t._l(t.customOptions,function(t){return s(\"el-option\",{key:t.value,attrs:{label:t.name,value:t.value}})})):t._e(),t._v(\" \"),t._t(\"append\"),t._v(\" \"),s(\"el-button\",{attrs:{type:\"primary\"},nativeOn:{click:function(e){t.postFiltrateValue()}}},[t._v(\"搜索\")]),t._v(\" \"),t._t(\"default\")]:t._e()],2)},[],!1,null,\"4dd77065\",null);h.options.__file=\"FiltrateHandleView.vue\";e.default=h.exports},\"I+NK\":function(t,e,s){\"use strict\";var i=s(\"PWYh\");s.n(i).a},\"La+m\":function(t,e,s){},Nbko:function(t,e,s){\"use strict\";var i=s(\"La+m\");s.n(i).a},PWYh:function(t,e,s){},QSP8:function(t,e,s){\"use strict\";var i=s(\"WWx0\");s.n(i).a},Rq8O:function(t,e,s){},Rw0F:function(t,e,s){\"use strict\";s.r(e);var i=s(\"74lk\"),a=s(\"mVxz\"),n=s(\"1bNe\"),o=s(\"tMlD\"),l=s(\"31UX\"),c=s(\"7Qib\"),r={name:\"ProductStatistics\",components:{ContractDetail:a.default,CustomerDetail:n.default,ProductDetail:o.default},mixins:[l.default],data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-170,postParams:{},headFieldList:[{field:\"categoryName\",name:\"产品分类\",width:\"115px\"},{field:\"productName\",name:\"产品名称\",width:\"115px\"},{field:\"contracNum\",name:\"合同编号\",width:\"115px\"},{field:\"ownerUserName\",name:\"负责人\",width:\"115px\"},{field:\"customerName\",name:\"客户名称\",width:\"115px\"},{field:\"productPrice\",name:\"销售单价\",width:\"115px\"},{field:\"productNum\",name:\"数量\",width:\"115px\"},{field:\"productSubtotal\",name:\"订单产品小计\",width:\"115px\"}],list:[],spanList:[],newList:[],showContractview:!1,showCustomerView:!1,showProductview:!1,rowID:\"\"}},computed:{},mounted:function(){var t=this;window.onresize=function(){var e=document.documentElement.clientHeight;t.tableHeight=e-170}},methods:{objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,s=t.columnIndex,i=this.spanList[e];return 0==s?0==i.rowspan?{rowspan:0,colspan:0}:{rowspan:i.rowspan,colspan:1}:1==s?0==i.productRowspan?{rowspan:0,colspan:0}:{rowspan:i.productRowspan,colspan:1}:void 0},handleRowClick:function(t,e,s){\"customerName\"===e.property?(this.showProductview&&(this.showProductview=!1),this.showContractview&&(this.showContractview=!1),this.rowID=t.customerId,this.showCustomerView=!0):\"productName\"===e.property?(this.showCustomerView&&(this.showCustomerView=!1),this.showContractview&&(this.showContractview=!1),this.rowID=t.productId,this.showProductview=!0):\"contracNum\"===e.property&&(this.showProductview&&(this.showProductview=!1),this.showCustomerView&&(this.showCustomerView=!1),this.rowID=t.contractId,this.showContractview=!0)},cellStyle:function(t){t.row,t.column;var e=t.rowIndex,s=t.columnIndex,i=this.spanList[e];return 1==i.isSum?{backgroundColor:\"#FFF9F2\",borderRight:\"0 none\",fontWeight:\"bold\"}:1==i.isAllSum?{backgroundColor:\"#FFF3E8\",borderRight:\"0 none\",fontWeight:\"bold\"}:1===s||2===s||4===s?{color:\"#2362FB\",cursor:\"pointer\"}:void 0},getProductDatalist:function(t){var e=this;this.postParams=t,this.loading=!0,Object(i.d)(t).then(function(t){t.data&&t.data.length>0?(e.list=t.data,e.handleShowInfo()):(e.list=[],e.spanList=[],e.newList=[]),e.loading=!1}).catch(function(){e.loading=!1})},handleShowInfo:function(){for(var t=[],e=[],s=0,i=0,a=0,n=0,o=0,l=0,r=0;r<this.list.length;r++){var u=this.list[r];if(0==e.length)s=0,i=0,a=parseFloat(u.productNum),n=parseFloat(u.productSubtotal),o=parseFloat(u.productNum),l=parseFloat(u.productSubtotal),e.push({rowspan:1,productRowspan:1}),t.push(u);else if(u.categoryId!=this.list[r-1].categoryId){(d=e[s]).rowspan+=1,t.push({productPrice:\"合计\",productNum:a,productSubtotal:n}),e.push({rowspan:0,productRowspan:1,isSum:!0}),t.push({productPrice:\"总计\",productNum:o,productSubtotal:l}),e.push({rowspan:1,productRowspan:1,isAllSum:!0}),e.push({rowspan:1,productRowspan:1}),a=parseFloat(u.productNum),n=parseFloat(u.productSubtotal),o=parseFloat(u.productNum),l=parseFloat(u.productSubtotal),t.push(u),s=e.length-1,i=e.length-1}else{var d;if((d=e[s]).rowspan+=1,u.productId==this.list[r-1].productId)e[i].productRowspan+=1,e.push({rowspan:0,productRowspan:0}),a=Object(c.i)(a,parseFloat(u.productNum)),n=Object(c.i)(n,parseFloat(u.productSubtotal)),o=Object(c.i)(o,parseFloat(u.productNum)),l=Object(c.i)(l,parseFloat(u.productSubtotal)),t.push(u);else d.rowspan+=1,t.push({productPrice:\"合计\",productNum:a,productSubtotal:n}),e.push({rowspan:0,productRowspan:1,isSum:!0}),e.push({rowspan:0,productRowspan:1}),i=e.length-1,a=parseFloat(u.productNum),n=parseFloat(u.productSubtotal),o=Object(c.i)(o,parseFloat(u.productNum)),l=Object(c.i)(l,parseFloat(u.productSubtotal)),t.push(u)}if(this.list.length-1==r)(d=e[s]).rowspan+=1,t.push({productPrice:\"合计\",productNum:a,productSubtotal:n}),a=0,n=0,e.push({rowspan:0,productRowspan:1,isSum:!0}),t.push({productPrice:\"合计\",productNum:o,productSubtotal:l}),o=0,l=0,e.push({rowspan:1,productRowspan:1,isAllSum:!0})}this.spanList=e,t[t.length-1].productPrice=\"总计\",this.newList=t},exportClick:function(){this.requestExportInfo(i.e,this.postParams)}}},u=(s(\"XiKJ\"),s(\"KHd+\")),d=Object(u.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"main-container\"},[s(\"filtrate-handle-view\",{staticClass:\"filtrate-bar\",attrs:{title:\"产品销售情况统计\",\"module-type\":\"product\"},on:{load:function(e){t.loading=!0},change:t.getProductDatalist}},[s(\"el-button\",{staticClass:\"export-button\",attrs:{type:\"primary\"},nativeOn:{click:function(e){return t.exportClick(e)}}},[t._v(\"导出\")])],1),t._v(\" \"),s(\"div\",{staticClass:\"content\"},[s(\"el-table\",{attrs:{id:\"crm-table\",data:t.newList,height:t.tableHeight,\"span-method\":t.objectSpanMethod,\"cell-style\":t.cellStyle,border:\"\"},on:{\"row-click\":t.handleRowClick}},t._l(t.headFieldList,function(t,e){return s(\"el-table-column\",{key:e,attrs:{prop:t.field,label:t.name,align:\"center\",\"header-align\":\"center\",\"show-overflow-tooltip\":\"\"}})}))],1),t._v(\" \"),t.showContractview&&t.rowID?s(\"contract-detail\",{staticClass:\"d-view\",attrs:{id:t.rowID},on:{\"hide-view\":function(e){t.showContractview=!1}}}):t._e(),t._v(\" \"),t.showCustomerView&&t.rowID?s(\"customer-detail\",{staticClass:\"d-view\",attrs:{id:t.rowID},on:{\"hide-view\":function(e){t.showCustomerView=!1}}}):t._e(),t._v(\" \"),t.showProductview&&t.rowID?s(\"product-detail\",{staticClass:\"d-view\",attrs:{id:t.rowID},on:{\"hide-view\":function(e){t.showProductview=!1}}}):t._e()],1)},[],!1,null,\"c956100c\",null);d.options.__file=\"ProductStatistics.vue\";e.default=d.exports},Vm8M:function(t,e,s){\"use strict\";var i=s(\"7Qib\"),a={name:\"MapView\",components:{},props:{title:{type:String,default:\"\"},lat:{type:[String,Number],default:0},lng:{type:[String,Number],default:0}},data:function(){return{}},computed:{},mounted:function(){var t=this;this.$el.style.zIndex=Object(i.q)(),document.body.appendChild(this.$el),Object(i.l)().then(function(){var e=new BMap.Map(\"choicemap\",{enableMapClick:!1}),s=new BMap.Point(parseFloat(t.lng),parseFloat(t.lat));e.centerAndZoom(s,18),e.enableScrollWheelZoom();var i=new BMap.Marker(s);e.addOverlay(i);var a=new BMap.InfoWindow(t.title);i.addEventListener(\"click\",function(){e.openInfoWindow(a,s)})})},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit(\"hidden\")}}},n=(s(\"I+NK\"),s(\"KHd+\")),o=Object(n.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",{staticClass:\"map-view\"},[e(\"div\",{attrs:{id:\"choicemap\"}}),this._v(\" \"),e(\"i\",{staticClass:\"el-icon-close map-close\",on:{click:this.hiddenView}})])},[],!1,null,\"33a9f6bf\",null);o.options.__file=\"MapView.vue\";e.a=o.exports},WWx0:function(t,e,s){},XiKJ:function(t,e,s){\"use strict\";var i=s(\"xQiF\");s.n(i).a},ZX9L:function(t,e,s){\"use strict\";var i={name:\"TimeTypeSelect\",props:{defaultType:[String,Object],width:{type:Number,default:200},options:{type:Array,default:function(){return[{label:\"今天\",value:\"today\"},{label:\"昨天\",value:\"yesterday\"},{label:\"本周\",value:\"week\"},{label:\"上周\",value:\"lastWeek\"},{label:\"本月\",value:\"month\"},{label:\"上月\",value:\"lastMonth\"},{label:\"本季度\",value:\"quarter\"},{label:\"上季度\",value:\"lastQuarter\"},{label:\"本年\",value:\"year\"},{label:\"去年\",value:\"lastYear\"}]}}},data:function(){return{selectType:{label:\"本年\",value:\"year\"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:\"\",endTime:\"\"}},computed:{typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||\"\")+\"-\"+(this.endTime||\"\"):\"\":this.selectType.label}},watch:{defaultType:function(){this.selectType.value!=this.defaultType&&(this.selectType=this.getDefaultTypeValue(this.defaultType))}},mounted:function(){void 0!==this.defaultType?\"string\"==typeof this.defaultType?this.selectType=this.getDefaultTypeValue(this.defaultType):this.defaultType.label?this.selectType=this.defaultType:\"default\"==this.defaultType.type?this.selectType=this.getDefaultTypeValue(this.defaultType.value):\"custom\"==this.defaultType.type&&(this.sureCustomContent=!0,this.showCustomContent=!0,this.startTime=this.defaultType.startTime,this.endTime=this.defaultType.endTime):this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},methods:{getDefaultTypeValue:function(t){for(var e=0;e<this.options.length;e++){var s=this.options[e];if(s.value==t)return s}return{label:\"本年\",value:\"year\"}},typeSelectClick:function(t){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=t,this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit(\"change\",{type:\"custom\",startTime:this.startTime,endTime:this.endTime}))}}},a=(s(\"77fj\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-popover\",{staticClass:\"time-type-select\",attrs:{width:t.width,placement:\"bottom\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showTypePopover,callback:function(e){t.showTypePopover=e},expression:\"showTypePopover\"}},[s(\"div\",{staticClass:\"type-popper\"},[s(\"div\",{staticClass:\"type-content\"},[t._l(t.options,function(e,i){return s(\"div\",{key:i,staticClass:\"type-content-item\",class:{selected:t.selectType.value==e.value&&!t.showCustomContent},on:{click:function(s){t.typeSelectClick(e)}}},[s(\"div\",{staticClass:\"mark\"}),t._v(t._s(e.label)+\"\\n      \")])}),t._v(\" \"),s(\"div\",{staticClass:\"type-content-item\",class:{selected:t.showCustomContent},on:{click:function(e){t.showCustomContent=!0}}},[s(\"div\",{staticClass:\"mark\"}),t._v(\"自定义\\n      \")])],2),t._v(\" \"),t.showCustomContent?s(\"div\",{staticClass:\"type-content-custom\"},[s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:\"startTime\"}}),t._v(\" \"),s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:\"endTime\"}}),t._v(\" \"),s(\"el-button\",{on:{click:t.customSureClick}},[t._v(\"确定\")])],1):t._e()]),t._v(\" \"),s(\"el-input\",{staticClass:\"type-select\",style:{width:t.width+\"px\"},attrs:{slot:\"reference\",readonly:!0},slot:\"reference\",model:{value:t.typeShowValue,callback:function(e){t.typeShowValue=e},expression:\"typeShowValue\"}},[s(\"i\",{class:[\"el-icon-arrow-up\",{\"is-reverse\":t.showTypePopover}],attrs:{slot:\"suffix\"},slot:\"suffix\"})])],1)},[],!1,null,\"20503202\",null);n.options.__file=\"index.vue\";e.a=n.exports},dAOq:function(t,e,s){\"use strict\";e.a={methods:{getStatusColor:function(t){return 0==t?\"#ffc539\":1==t?\"#20b559\":2==t?\"#f95a5a\":3==t?\"#398dff\":4==t?\"#999\":5==t?\"#d9d9d9\":6==t?\"#2362FB\":8==t?\"#bfbfbf\":void 0},getStatusName:function(t){return 0==t?\"待审核\":1==t?\"通过\":2==t?\"拒绝\":3==t?\"审核中\":4==t?\"撤回\":5==t?\"未提交\":6==t?\"创建\":8==t?\"已作废\":\"\"},getStatusIcon:function(t){return 0==t?\"wk wk-time\":1==t?\"wk wk-success\":2==t?\"wk wk-close\":3==t?\"wk wk-time\":4==t?\"wk wk-reset\":5==t?\"wk wk-time\":6==t?\"wk wk-l-plus\":8==t?\"wk wk-invalid\":\"\"},getXhStatusList:function(){return[{label:\"待审核\",value:0},{label:\"通过\",value:1},{label:\"拒绝\",value:2},{label:\"审核中\",value:3},{label:\"撤回\",value:4}]},getStatusImageIcon:function(t){return 0==t||3==t||5==t?s(\"6pZM\"):1==t?s(\"y4JV\"):2==t?s(\"migV\"):4==t?s(\"+xXq\"):6==t?s(\"wu/m\"):\"\"}}}},eOwn:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"7Dod\"),o=s(\"6iAj\"),l=s(\"4XAY\"),c=s(\"giPm\"),r=s(\"O8VQ\"),u=s(\"/G0b\"),d=s(\"8OTK\"),p=s(\"C3Po\"),h=s(\"ZoMv\"),f=s(\"7Qib\"),m=s(\"Z+Ht\"),v=s(\"vvxI\"),y=s(\"ZX9L\"),w=s(\"ehos\"),g=s(\"L2JU\"),b={name:\"Activity\",components:{LogAdd:c.default,LogCell:r.default,CRMAllCreate:d.default,TaskQuickAdd:p.default,TimeTypeSelect:y.a,LogEditDialog:u.default,CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-66f9\"),s.e(\"chunk-63bb\"),s.e(\"chunk-7029\"),s.e(\"chunk-0aaf\"),s.e(\"chunk-24c6\")]).then(s.bind(null,\"3z7q\"))}},mixins:[m.a,v.default],props:{handle:{type:Array,default:function(){return[]}},id:[String,Number],contactsId:[String,Number],crmType:{type:String,default:\"\"},isSeas:{type:Boolean,default:!1},typeList:{type:Array,default:function(){return[]}},detail:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,filterValue:{},timeOptions:[{label:\"全部\",value:\"\"},{label:\"最近7天\",value:\"7\"},{label:\"最近30天\",value:\"30\"},{label:\"最近60天\",value:\"60\"}],contacts:[],followTypes:[],handleType:\"\",activityType:{icon:\"all\",color:\"#2362FB\",command:\"\",label:\"全部活动\"},list:[],noMore:!1,page:1,isCRMCreate:!1,createActionInfo:{type:\"relative\",crmType:this.crmType,data:{}},createCRMType:\"\",isTaskCreate:!1,showFullDetail:!1,relationID:\"\",relationCrmType:\"\",scrollKey:Date.now(),logEditData:null,logEditPosition:{seciton:0,index:0},logEditDialogVisible:!1}},computed:a()({},Object(g.b)([\"crm\"]),{canCreateFollowRecord:function(){return this.crm&&this.crm.followRecord&&this.crm.followRecord.save},showRelate:function(){return\"customer\"==this.crmType},scrollDisabled:function(){return this.loading||this.noMore},taskParams:function(){var t={};return t[this.crmType+\"Ids\"]=this.id,t}}),watch:{id:function(){this.initInfo(),this.refreshLogList()}},created:function(){this.debouncedRefreshLogList=Object(w.debounce)(300,this.refreshLogList),this.initInfo()},methods:{getLogTypeList:function(){var t=this;Object(o.s)().then(function(e){t.followTypes=e.data.map(function(t){return{value:t,label:t}})}).catch(function(){})},getContactsList:function(){var t=this;Object(n.H)({customerId:this.id}).then(function(e){t.contacts=e.data.list}).catch(function(){})},sendLog:function(t){var e=this;if(t.content){var s={};s.activityType=h.default[this.crmType],s.activityTypeId=t.id,s.content=t.content,s.category=t.followType;var i=t.business.map(function(t){return t.businessId});s.batchId=t.batchId,s.businessIds=i.join(\",\"),s.contactsIds=t.contactsId,s.nextTime=t.nextTime||\"\",s.isEvent=0,this.sendLoading=!0,Object(l.a)(s).then(function(t){e.sendLoading=!1,e.$message.success(\"发布成功\"),e.$refs.logAdd&&e.$refs.logAdd.resetInfo(),e.refreshLogList()}).catch(function(){e.sendLoading=!1})}else this.$message.error(\"请输入跟进内容\")},handleClick:function(t){var e=this;if(this.handleType==t?this.handleType=\"\":this.handleType=t,\"log\"==t)this.isTaskCreate=!1,this.$nextTick(function(){e.$refs.logAdd&&(e.$refs.logAdd.isUnfold=e.handleType==t)});else if(\"task\"==t)this.isTaskCreate=!0,this.$nextTick(function(){e.$refs.taskAdd.inputFocus()});else{this.isTaskCreate=!1;var s={type:\"relative\",crmType:this.crmType,data:{}};\"contacts\"==this.crmType?(s.data.customer=Object(f.t)(this.detail),\"business\"==t&&(s.relativeData={contactsId:this.detail.contactsId})):\"customer\"==this.crmType?s.data.customer=Object(f.t)(this.detail):\"business\"==this.crmType?(s.data.customer=Object(f.t)(this.detail),s.data.business=Object(f.t)(this.detail),\"contacts\"==t&&(s.relativeData={businessId:this.detail.businessId})):\"contract\"==this.crmType&&(s.data.customer=Object(f.t)(this.detail),s.data.contract=Object(f.t)(this.detail)),this.createActionInfo=s,this.createCRMType=t,this.isCRMCreate=!0}},initInfo:function(){var t=this;this.$nextTick(function(){t.$refs.logAdd&&t.$refs.logAdd.resetInfo(),t.$refs.taskAdd&&t.$refs.taskAdd.resetSendData()}),this.filterValue={search:\"\",timeLine:{label:\"全部\",value:\"\"}},this.getLogTypeList(),this.showRelate&&this.getContactsList()},refreshLogList:function(){this.page=1,this.noMore=!1,this.list=[],this.scrollKey=Date.now()},handleSelectClick:function(t){this.activityType=t,this.refreshLogList()},timeTypeChange:function(t){this.filterValue.timeLine=t,this.refreshLogList()},getLogList:function(){var t=this;this.loading=!0;var e={page:this.page,crmType:h.default[this.crmType],activityType:this.activityType.command,activityTypeId:this.id};this.filterValue.search&&(e.search=this.filterValue.search),this.filterValue.timeLine.type&&(\"custom\"===this.filterValue.timeLine.type?(e.startDate=this.filterValue.timeLine.startTime.replace(/\\./g,\"-\"),e.endDate=this.filterValue.timeLine.endTime.replace(/\\./g,\"-\")):e.intervalDay=this.filterValue.timeLine.value||\"\"),Object(l.c)(e).then(function(e){if(t.loading=!1,!t.noMore)if(t.page++,t.list.length){var s=t.list[t.list.length-1];e.data.time&&e.data.list.length&&s.time!=e.data.time&&t.list.push(e.data)}else e.data.time&&e.data.list.length&&t.list.push(e.data);t.noMore=e.data.lastPage}).catch(function(){t.noMore=!0,t.loading=!1})},createCRMSuccess:function(){this.handleType=\"\",this.refreshLogList()},createCRMClose:function(){this.isCRMCreate=!1,this.handleType=\"\"},checkCRMDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0},getActivityIcon:function(t){return this.getXrIcon(this.getActivityType(t))},getActivityTypeColor:function(t){return this.getXrIconColor(this.getActivityType(t))},logCellDelete:function(t,e,s){this.list[s].list.splice(e,1),0==this.list[s].list.length&&this.list.splice(s,1),this.scrollKey=Date.now()},logCellEdit:function(t,e,s){this.logEditData=t,this.logEditPosition={seciton:s,index:e},this.logEditDialogVisible=!0},logEditSave:function(t){this.logEditPosition.seciton>=0&&this.logEditPosition.index>=0&&this.list[this.logEditPosition.seciton].list.splice(this.logEditPosition.index,1,t)}}},T=(s(\"QSP8\"),s(\"KHd+\")),C=Object(T.a)(b,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:t.getLogList,expression:\"getLogList\"}],key:t.scrollKey,staticClass:\"main\",attrs:{\"infinite-scroll-distance\":\"100\",\"infinite-scroll-disabled\":\"scrollDisabled\"}},[s(\"div\",[!t.isSeas&&t.handle&&t.handle.length?s(\"div\",{staticClass:\"main-handle\"},t._l(t.handle,function(e,i){return s(\"el-button\",{key:i,class:{\"is-select\":t.handleType===e.type},attrs:{type:\"primary\",icon:\"wk wk-add\"},on:{click:function(s){t.handleClick(e.type)}}},[t._v(\"\\n        \"+t._s(e.label)+\"\\n      \")])})):t._e(),t._v(\" \"),!t.isSeas&&t.handle&&t.handle.length?[!t.isTaskCreate&&t.canCreateFollowRecord?s(\"log-add\",{ref:\"logAdd\",staticClass:\"log-add\",attrs:{id:t.id,\"show-business\":t.showRelate,\"show-contacts\":t.showRelate,contacts:t.contacts,\"contacts-id\":t.contactsId,\"follow-types\":t.followTypes,\"crm-type\":t.crmType},on:{send:t.sendLog,focus:function(e){t.handleType=\"log\"},close:function(e){t.handleClick(t.handleType)}}}):s(\"task-quick-add\",{ref:\"taskAdd\",staticClass:\"task-quick-add\",attrs:{params:t.taskParams},on:{focus:function(e){t.handleType=\"task\"},send:t.refreshLogList}})]:t._e(),t._v(\" \"),s(\"div\",{staticClass:\"log\",class:{\"is-top\":t.handle&&0==t.handle.length}},[s(\"flexbox\",{staticClass:\"log__header\",attrs:{justify:\"flex-end\"}},[s(\"el-input\",{attrs:{placeholder:\"关键字搜索\",\"prefix-icon\":\"el-icon-search\"},on:{input:t.debouncedRefreshLogList},model:{value:t.filterValue.search,callback:function(e){t.$set(t.filterValue,\"search\",e)},expression:\"filterValue.search\"}}),t._v(\" \"),s(\"time-type-select\",{attrs:{width:190,options:t.timeOptions,\"default-type\":t.filterValue.timeLine},on:{change:t.timeTypeChange}}),t._v(\" \"),t.typeList.length>1?s(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:t.handleSelectClick}},[s(\"span\",{staticClass:\"el-dropdown-link\"},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+t.activityType.icon],style:{backgroundColor:t.activityType.color}}),t._v(t._s(t.activityType.label)),s(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),t._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},t._l(t.typeList,function(e,i){return s(\"el-dropdown-item\",{key:i,attrs:{command:e}},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+e.icon],style:{backgroundColor:e.color}}),t._v(t._s(e.label))])}))],1):t._e()],1),t._v(\" \"),t._l(t.list,function(e,i){return s(\"div\",{key:i,staticClass:\"log-section\"},[s(\"div\",{staticClass:\"log-section__title\"},[s(\"span\",{staticClass:\"section-title\"},[s(\"span\",{staticClass:\"section-title__time\"},[t._v(t._s(e.time))])])]),t._v(\" \"),t._l(e.list,function(a,n){return[1==a.type?s(\"div\",{key:n,staticClass:\"log-cell\",class:{\"only-one\":1==e.list.length}},[s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":!t.isSeas},on:{\"crm-detail\":t.checkCRMDetail,delete:t.logCellDelete,edit:t.logCellEdit}}),t._v(\" \"),s(\"i\",{staticClass:\"wk wk-message log-cell__mark\"})],1):s(\"div\",{key:n,staticClass:\"log-cell activity-cell\",class:{\"only-one\":1==e.list.length}},[2==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[t._v(t._s(a.createTime)+\" \"+t._s(a.realname)+\"创建了\"+t._s(t.getActivityTypeName(a.activityType))+\"：\")]),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(e){t.checkCRMDetail(t.getActivityType(a.activityType),a.activityTypeId)}}},[t._v(t._s(a.activityTypeName||\"查看详情\"))])]):3==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[t._v(t._s(a.createTime)+\" \"+t._s(a.realname)+\"将商机：\")]),t._v(\" \"),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(e){t.checkCRMDetail(\"business\",a.activityTypeId)}}},[t._v(t._s(a.activityTypeName))]),t._v(\" \"),s(\"span\",[t._v(t._s(\" 阶段变为 \"+a.content))])]):4==a.type?s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":\"\"},on:{\"crm-detail\":t.checkCRMDetail,delete:t.logCellDelete}}):t._e(),t._v(\" \"),s(\"i\",{staticClass:\"log-cell__mark\",class:t.getActivityIcon(a.activityType),staticStyle:{\"background-color\":\"#FB9323\"},style:{backgroundColor:t.getActivityTypeColor(a.activityType)}})],1)]})],2)}),t._v(\" \"),t.loading?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"加载中...\")]):t._e(),t._v(\" \"),t.noMore?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"没有更多了\")]):t._e()],2)],2),t._v(\" \"),t.isCRMCreate?s(\"c-r-m-all-create\",{attrs:{\"crm-type\":t.createCRMType,action:t.createActionInfo},on:{\"save-success\":t.createCRMSuccess,close:t.createCRMClose}}):t._e(),t._v(\" \"),s(\"c-r-m-full-screen-detail\",{attrs:{visible:t.showFullDetail,\"crm-type\":t.relationCrmType,id:t.relationID},on:{\"update:visible\":function(e){t.showFullDetail=e}}}),t._v(\" \"),s(\"log-edit-dialog\",{attrs:{visible:t.logEditDialogVisible,data:t.logEditData},on:{\"update:visible\":function(e){t.logEditDialogVisible=e},save:t.logEditSave}})],1)},[],!1,null,\"7955f64b\",null);C.options.__file=\"index.vue\";e.default=C.exports},gIBH:function(t,e,s){},giPm:function(t,e,s){\"use strict\";s.r(e);var i=s(\"KTTK\"),a=s(\"mkuN\"),n=s(\"zMq1\"),o=s(\"ye9D\"),l=s(\"NYF1\"),c=s(\"YIeP\"),r=s(\"7Qib\");var u={methods:{dispatch:function(t,e,s){for(var i=this.$parent||this.$root,a=i.$options.componentName;i&&(!a||a!==t);)(i=i.$parent)&&(a=i.$options.componentName);i&&i.$emit.apply(i,[e].concat(s))},broadcast:function(t,e,s){(function t(e,s,i){this.$children.forEach(function(a){a.$options.componentName===e?a.$emit.apply(a,[s].concat(i)):t.apply(a,[e,s].concat([i]))})}).call(this,t,e,s)}}},d={name:\"LogAdd\",components:{CrmRelative:a.a,AddImageList:n.a,AddFileList:o.a,AddRelateList:l.a,CommonWords:c.a},mixins:[u],props:{showBusiness:{type:Boolean,default:!1},showContacts:{type:Boolean,default:!1},contacts:Array,contactsId:[String,Number],followTypes:Array,id:[String,Number],crmType:{type:String,default:\"\"}},data:function(){return{isUnfold:!1,content:\"\",imgFiles:[],businessAction:{},files:[],showBusinessPopover:!1,business:[],selectContactsId:\"\",followType:\"\",nextTime:\"\",showRelativeType:\"\",batchId:Object(r.r)()}},computed:{autosize:function(){return this.isUnfold?{minRows:3,maxRows:6}:{minRows:1,maxRows:1}}},watch:{followTypes:function(){this.getDefalutFollowType()},content:function(t){var e=!!(t&&t.length>0);this.dispatch(\"SlideView\",\"setEditClose\",[e])},contactsId:function(){this.selectContactsId=this.contactsId||\"\"},id:{handler:function(){this.businessAction={type:\"condition\",data:{moduleType:this.crmType,customerId:this.id}}},immediate:!0}},created:function(){this.selectContactsId=this.contactsId||\"\",this.getDefalutFollowType()},beforeDestroy:function(){},methods:{getDefalutFollowType:function(){this.followTypes&&this.followTypes.length>0?this.followType=this.followTypes[0].value:this.followType=\"\"},resetInfo:function(){this.nextTime=\"\",this.isUnfold=!1,this.content=\"\",this.dispatch(\"SlideView\",\"setEditClose\",[!1]),this.imgFiles=[],this.files=[],this.business=[],this.selectContactsId=this.contactsId||\"\",this.showRelativeType=\"\",this.batchId=Object(r.r)(),this.getDefalutFollowType()},commonWordsSelect:function(t){var e=this;this.content?this.$confirm(\"您选中的常用语将覆盖当前填写内容?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){e.content=t}).catch(function(){}):this.content=t},checkRelativeInfos:function(t){\"business\"==this.showRelativeType&&(this.business=t.data)},barClick:function(t){this.showRelativeType=t,\"business\"==t?this.showBusinessPopover=!0:\"file\"==t?this.$refs.fileInput.click():\"img\"==t&&this.$refs.imgInput.click()},uploadFile:function(t){var e=t.target.files;if(e.length){for(var s=0;s<e.length;s++){if(-1==e[s].type.indexOf(\"image\")&&\"img\"==this.showRelativeType)return void this.$message.error(\"请上传正确的文件类型\")}for(var i=\"image/*\"==t.target.accept?\"img\":\"file\",a=0;a<e.length;a++){var n=e[a];this.uploadFileRequest(n,i)}t.target.value=\"\"}},uploadFileRequest:function(t,e,s){var i=this;this.$wkUploadFile.upload({file:t,params:{type:e,batchId:this.batchId}}).then(function(a){var n=a.res.data||{};n.size=Object(r.h)(t.size),\"img\"==e?i.imgFiles.push(n):(n.icon=Object(r.o)(t),i.files.push(n)),s&&s()}).catch(function(){})},deleteImage:function(t,e){this.deleteImgOrFile(\"image\",t,e)},deleteFile:function(t,e){this.deleteImgOrFile(\"file\",t,e)},deleteImgOrFile:function(t,e,s){var a=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.g)({id:e.fileId}).then(function(e){\"image\"==t?a.imgFiles.splice(s,1):a.files.splice(s,1),a.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteAllFile:function(t){var e=this;this.batchId&&this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.i)({batchId:e.batchId,type:t}).then(function(s){2==t?e.imgFiles=[]:e.files=[],e.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteRelate:function(t,e){this.business.splice(e,1)},inputFocus:function(){var t=this;this.isUnfold=!0,this.$nextTick(function(){t.$refs.textarea.focus(),t.$emit(\"focus\")})},sendClick:function(){this.$emit(\"send\",{id:this.id,content:this.content,files:this.files,images:this.imgFiles,business:this.business,contactsId:this.selectContactsId,batchId:this.batchId,followType:this.followType,nextTime:this.nextTime})},close:function(){this.isUnfold=!1,this.$emit(\"close\")}}},p=(s(\"Nbko\"),s(\"KHd+\")),h=Object(p.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{class:[\"mix-content\",{unfold:!t.isUnfold}]},[t.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:t.close}}):t._e(),t._v(\" \"),t.isUnfold?s(\"div\",{staticClass:\"mix-content-select\"},[t.showContacts?s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择联系人\"},model:{value:t.selectContactsId,callback:function(e){t.selectContactsId=e},expression:\"selectContactsId\"}},t._l(t.contacts,function(t){return s(\"el-option\",{key:t.contactsId,attrs:{label:t.name,value:t.contactsId}})})):t._e(),t._v(\" \"),s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择跟进方式\"},model:{value:t.followType,callback:function(e){t.followType=e},expression:\"followType\"}},t._l(t.followTypes,function(t){return s(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(\" \"),s(\"el-date-picker\",{attrs:{editable:!1,type:\"datetime\",placeholder:\"选择下次联系时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:t.nextTime,callback:function(e){t.nextTime=e},expression:\"nextTime\"}}),t._v(\" \"),s(\"common-words\",{on:{select:t.commonWordsSelect}})],1):t._e(),t._v(\" \"),s(\"div\",{class:[\"i-cont\",{unfold:!t.isUnfold}]},[t.isUnfold?t._e():s(\"i\",{staticClass:\"wk wk-write\"}),t._v(\" \"),s(\"el-input\",{ref:\"textarea\",attrs:{autosize:t.autosize,maxlength:800,type:\"textarea\",clearable:\"\",resize:\"none\",placeholder:\"请输入内容\"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:\"content\"}})],1),t._v(\" \"),t.imgFiles.length>0&&t.isUnfold?s(\"add-image-list\",{attrs:{data:t.imgFiles},on:{delete:t.deleteImage,\"delete-all\":function(e){t.deleteAllFile(2)},upload:t.uploadFile}}):t._e(),t._v(\" \"),t.files.length>0&&t.isUnfold?s(\"add-file-list\",{attrs:{data:t.files},on:{delete:t.deleteFile,\"delete-all\":function(e){t.deleteAllFile(1)}}}):t._e(),t._v(\" \"),t.business.length>0&&t.isUnfold?s(\"add-relate-list\",{attrs:{data:t.business,type:\"business\"},on:{delete:t.deleteRelate}}):t._e(),t._v(\" \"),t.isUnfold?s(\"div\",{staticClass:\"bar-cont\"},[s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-picture\"},on:{click:function(e){t.barClick(\"img\")}}},[t._v(\"图片\")]),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-file\"},on:{click:function(e){t.barClick(\"file\")}}},[t._v(\"附件\")]),t._v(\" \"),t.showBusiness?s(\"el-popover\",{attrs:{placement:\"bottom\",width:\"700\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showBusinessPopover,callback:function(e){t.showBusinessPopover=e},expression:\"showBusinessPopover\"}},[s(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:t.showBusinessPopover,radio:!1,action:t.businessAction,\"selected-data\":{business:t.business},\"crm-type\":\"business\"},on:{close:function(e){t.showBusinessPopover=!1},changeCheckout:t.checkRelativeInfos}}),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",staticStyle:{\"margin-left\":\"10px\"},attrs:{slot:\"reference\",type:\"text\",icon:\"wk wk-associate\"},on:{click:function(e){t.barClick(\"business\")}},slot:\"reference\"},[t._v(\"关联商机\")])],1):t._e(),t._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.sendClick,expression:\"sendClick\"}],staticClass:\"send-btn\",attrs:{type:\"primary\"}},[t._v(\"发布\")])],1):t._e(),t._v(\" \"),s(\"input\",{ref:\"fileInput\",staticClass:\"file-input\",attrs:{accept:\"*.*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}}),t._v(\" \"),s(\"input\",{ref:\"imgInput\",staticClass:\"file-input\",attrs:{accept:\"image/*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}})],1)},[],!1,null,\"670c00a3\",null);h.options.__file=\"LogAdd.vue\";e.default=h.exports},migV:function(t,e,s){t.exports=s.p+\"static/img/check_fail.f446ba8.png\"},\"wu/m\":function(t,e,s){t.exports=s.p+\"static/img/check_create.09736ed.png\"},xQiF:function(t,e,s){},y4JV:function(t,e,s){t.exports=s.p+\"static/img/check_suc.e52db27.png\"},yl8z:function(t,e,s){\"use strict\";var i=s(\"1CbL\");s.n(i).a},zsVz:function(t,e,s){\"use strict\";s.d(e,\"g\",function(){return a}),s.d(e,\"e\",function(){return n}),s.d(e,\"a\",function(){return o}),s.d(e,\"b\",function(){return l}),s.d(e,\"d\",function(){return c}),s.d(e,\"c\",function(){return r}),s.d(e,\"f\",function(){return u}),s.d(e,\"h\",function(){return d});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"oaTask/queryTaskList\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function n(t){return Object(i.a)({url:\"workTask/saveWorkTask\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function o(t){return Object(i.a)({url:\"workTask/queryTaskInfo/\"+t.taskId,method:\"post\"})}function l(t){return Object(i.a)({url:\"workTask/queryTrashTaskInfo\",method:\"post\",data:t})}function c(t){return Object(i.a)({url:\"workTaskLog/queryTaskLog/\"+t.taskId,method:\"post\"})}function r(t){return Object(i.a)({url:\"workTaskRelation/saveWorkTaskRelation\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function u(t){return Object(i.a)({url:\"oaTask/deleteWorkTaskLabel\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function d(t){return Object(i.a)({url:\"oaTask/oaTaskExport\",method:\"post\",data:t,responseType:\"blob\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}}}]);","extractedComments":[]}