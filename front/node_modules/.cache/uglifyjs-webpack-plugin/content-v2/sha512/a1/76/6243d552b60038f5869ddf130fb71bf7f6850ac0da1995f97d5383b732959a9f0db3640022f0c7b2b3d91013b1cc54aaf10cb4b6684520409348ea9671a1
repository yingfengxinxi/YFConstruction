{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-5a74\",\"chunk-0aaf\",\"chunk-620e\",\"chunk-9dc6\",\"chunk-28d7\",\"chunk-66e8\",\"chunk-3997\",\"chunk-24c6\",\"chunk-682d\",\"chunk-36d0\",\"chunk-fcbe\"],{\"/407\":function(t,e,s){\"use strict\";s.r(e);var i={name:\"RelatedBusinessCell\",props:{type:{type:String,default:\"\"},cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!0}},data:function(){return{}},computed:{typeName:function(){return\"customer\"==this.type?\"客户\":\"contacts\"==this.type?\"联系人\":\"business\"==this.type?\"商机\":\"contract\"==this.type?\"合同\":\"\"},name:function(){return this.data.name||this.data.businessName||this.data.customerName||this.data.number}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{footClick:function(){this.$emit(\"unbind\",this.type,this.cellIndex,this.data)},bodyClick:function(){this.$emit(\"detail\",this.type,this.cellIndex,this.data)}}},a=(s(\"/hyb\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"flexbox\",{staticClass:\"cell\"},[s(\"div\",{staticClass:\"cell-head\"},[s(\"i\",{class:t._f(\"wkIconPre\")(t.type)}),t._v(\" \"),s(\"span\",[t._v(\"\\n      \"+t._s(\"相关\"+t.typeName+\"-\")+\"\\n    \")])]),t._v(\" \"),s(\"div\",{staticClass:\"cell-body text-one-line\",class:{\"cursor-pointer\":t.cursorPointer},on:{click:t.bodyClick}},[t._v(\"\\n    \"+t._s(t.name)+\"\\n  \")]),t._v(\" \"),s(\"div\",{staticClass:\"cell-foot\"},[t.showFoot?s(\"a\",{staticClass:\"cancel-btn\",on:{click:t.footClick}},[t._v(\"取消关联\")]):t._e()])])},[],!1,null,\"061d0168\",null);n.options.__file=\"index.vue\";e.default=n.exports},\"/G0b\":function(t,e,s){\"use strict\";s.r(e);var i=s(\"KTTK\"),a=s(\"6iAj\"),n=s(\"4XAY\"),o=s(\"7Dod\"),c=s(\"7Qib\"),l=s(\"mkuN\"),r=s(\"zMq1\"),u=s(\"ye9D\"),d=s(\"NYF1\"),h=s(\"YIeP\"),p=s(\"ZoMv\"),m={name:\"LogEditDialog\",components:{CrmRelative:l.a,AddImageList:r.a,AddFileList:u.a,AddRelateList:d.a,CommonWords:h.a},props:{visible:{type:Boolean,required:!0,default:!1},data:Object},data:function(){return{loading:!1,crmType:\"\",content:\"\",imgFiles:[],businessAction:{},files:[],showBusinessPopover:!1,business:[],contacts:[],selectContactsId:\"\",followTypes:[],followType:\"\",nextTime:\"\",showRelativeType:\"\",batchId:\"\"}},computed:{autosize:function(){return{minRows:4,maxRows:8}},id:function(){return this.data?this.data.activityTypeId:\"\"},showBusiness:function(){return\"customer\"==this.crmType},showContacts:function(){return this.showBusiness}},watch:{visible:{handler:function(t){if(t){var e=p.default.convertTypeToKey(this.data.activityType);this.crmType!=e&&(this.crmType=e),this.handleDetailInfo(Object(c.t)(this.data))}},immediate:!0,deep:!0},id:{handler:function(){this.businessAction={type:\"condition\",data:{moduleType:this.crmType,customerId:this.id}}},immediate:!0}},created:function(){},beforeDestroy:function(){},methods:{handleDetailInfo:function(t){var e=this;this.showContacts&&this.getContactsList(),0==this.followTypes.length&&this.getLogTypeList(),this.content=t.content,this.imgFiles=t.img||[];var s=t.file||[];this.files=s.map(function(t){return t.icon=e.getFileTypeIcon(t.name),t});var i=t.businessList||[];this.business=i.map(function(t){return{businessName:t.name,businessId:t.id}}),this.selectContactsId=t.contactsList&&t.contactsList.length?t.contactsList[0].id:\"\",this.followType=t.category,this.nextTime=t.nextTime,this.batchId=t.batchId},getFileTypeIcon:function(t){if(!t)return\"\";var e=t?t.split(\".\"):[],s=\"\";return s=e.length>0?e[e.length-1]:\"\",Object(c.n)(s)},getLogTypeList:function(){var t=this;Object(a.s)().then(function(e){t.followTypes=e.data.map(function(t){return{value:t,label:t}})}).catch(function(){})},getContactsList:function(){var t=this;Object(o.H)({customerId:this.id}).then(function(e){t.contacts=e.data.list}).catch(function(){})},getDefalutFollowType:function(){this.followTypes&&this.followTypes.length>0?this.followType=this.followTypes[0].value:this.followType=\"\"},resetInfo:function(){this.nextTime=\"\",this.content=\"\",this.imgFiles=[],this.files=[],this.business=[],this.selectContactsId=this.contactsId||\"\",this.showRelativeType=\"\",this.batchId=\"\",this.getDefalutFollowType()},commonWordsSelect:function(t){var e=this;this.content?this.$confirm(\"您选中的常用语将覆盖当前填写内容?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){e.content=t}).catch(function(){}):this.content=t},checkRelativeInfos:function(t){\"business\"==this.showRelativeType&&(this.business=t.data)},barClick:function(t){this.showRelativeType=t,\"business\"==t?this.showBusinessPopover=!0:\"file\"==t?this.$refs.fileInput.click():\"img\"==t&&this.$refs.imgInput.click()},uploadFile:function(t){var e=t.target.files;if(e.length){for(var s=0;s<e.length;s++){if(-1==e[s].type.indexOf(\"image\")&&\"img\"==this.showRelativeType)return void this.$message.error(\"请上传正确的文件类型\")}for(var i=\"image/*\"==t.target.accept?\"img\":\"file\",a=0;a<e.length;a++){var n=e[a];this.uploadFileRequest(n,i)}t.target.value=\"\"}},uploadFileRequest:function(t,e,s){var i=this;this.$wkUploadFile.upload({file:t,params:{type:e,batchId:this.batchId}}).then(function(a){var n=a.res.data||{};n.size=Object(c.h)(t.size),\"img\"==e?i.imgFiles.push(n):(n.icon=Object(c.o)(t),i.files.push(n)),s&&s()}).catch(function(){})},deleteImage:function(t,e){this.deleteImgOrFile(\"image\",t,e)},deleteFile:function(t,e){this.deleteImgOrFile(\"file\",t,e)},deleteImgOrFile:function(t,e,s){var a=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.g)({id:e.fileId}).then(function(e){\"image\"==t?a.imgFiles.splice(s,1):a.files.splice(s,1),a.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteAllFile:function(t){var e=this;this.batchId&&this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.i)({batchId:e.batchId,type:t}).then(function(s){2==t?e.imgFiles=[]:e.files=[],e.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteRelate:function(t,e){this.business.splice(e,1)},inputFocus:function(){var t=this;this.$nextTick(function(){t.$refs.textarea.focus(),t.$emit(\"focus\")})},handleConfirm:function(){var t=this;if(this.content){var e={};e.activityId=this.data.activityId,e.activityType=this.data.activityType,e.activityTypeId=this.id,e.content=this.content,e.category=this.followType;var s=this.business.map(function(t){return t.businessId||t.id});e.batchId=this.batchId,e.businessIds=s.join(\",\"),e.contactsIds=this.contactsId,e.nextTime=this.nextTime||\"\",e.isEvent=0,this.loading=!0,Object(n.e)(e).then(function(e){t.loading=!1,t.$message.success(\"编辑成功\"),t.$emit(\"save\",e.data),t.handleCancel()}).catch(function(){t.loading=!1})}else this.$message.error(\"请输入跟进内容\")},handleCancel:function(){this.$emit(\"update:visible\",!1)}}},f=(s(\"B2DG\"),s(\"KHd+\")),v=Object(f.a)(m,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-dialog\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],attrs:{visible:t.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"编辑跟进记录\",width:\"700px\",\"custom-class\":\"no-padding-dialog\"},on:{close:t.handleCancel}},[s(\"div\",{staticClass:\"mix-content\"},[s(\"div\",{staticClass:\"mix-content__body\"},[s(\"div\",{staticClass:\"mix-content-select\"},[t.showContacts?s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择联系人\"},model:{value:t.selectContactsId,callback:function(e){t.selectContactsId=e},expression:\"selectContactsId\"}},t._l(t.contacts,function(t){return s(\"el-option\",{key:t.contactsId,attrs:{label:t.name,value:t.contactsId}})})):t._e(),t._v(\" \"),s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择跟进方式\"},model:{value:t.followType,callback:function(e){t.followType=e},expression:\"followType\"}},t._l(t.followTypes,function(t){return s(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(\" \"),s(\"el-date-picker\",{attrs:{editable:!1,type:\"datetime\",placeholder:\"选择下次联系时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:t.nextTime,callback:function(e){t.nextTime=e},expression:\"nextTime\"}}),t._v(\" \"),s(\"common-words\",{on:{select:t.commonWordsSelect}})],1),t._v(\" \"),s(\"div\",{staticClass:\"i-cont\"},[s(\"el-input\",{ref:\"textarea\",attrs:{autosize:t.autosize,maxlength:800,type:\"textarea\",clearable:\"\",resize:\"none\",placeholder:\"请输入内容\"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:\"content\"}})],1),t._v(\" \"),t.imgFiles.length>0?s(\"add-image-list\",{attrs:{data:t.imgFiles},on:{delete:t.deleteImage,\"delete-all\":function(e){t.deleteAllFile(2)},upload:t.uploadFile}}):t._e(),t._v(\" \"),t.files.length>0?s(\"add-file-list\",{attrs:{data:t.files},on:{delete:t.deleteFile,\"delete-all\":function(e){t.deleteAllFile(1)}}}):t._e(),t._v(\" \"),t.business.length>0?s(\"add-relate-list\",{attrs:{data:t.business,type:\"business\"},on:{delete:t.deleteRelate}}):t._e()],1),t._v(\" \"),s(\"div\",{staticClass:\"bar-cont\"},[s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-picture\"},on:{click:function(e){t.barClick(\"img\")}}},[t._v(\"图片\")]),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-file\"},on:{click:function(e){t.barClick(\"file\")}}},[t._v(\"附件\")]),t._v(\" \"),t.showBusiness?s(\"el-popover\",{attrs:{placement:\"bottom\",width:\"700\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showBusinessPopover,callback:function(e){t.showBusinessPopover=e},expression:\"showBusinessPopover\"}},[s(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:t.showBusinessPopover,radio:!1,action:t.businessAction,\"selected-data\":{business:t.business},\"crm-type\":\"business\"},on:{close:function(e){t.showBusinessPopover=!1},changeCheckout:t.checkRelativeInfos}}),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",staticStyle:{\"margin-left\":\"10px\"},attrs:{slot:\"reference\",type:\"text\",icon:\"wk wk-associate\"},on:{click:function(e){t.barClick(\"business\")}},slot:\"reference\"},[t._v(\"关联商机\")])],1):t._e()],1),t._v(\" \"),s(\"input\",{ref:\"fileInput\",staticClass:\"file-input\",attrs:{accept:\"*.*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}}),t._v(\" \"),s(\"input\",{ref:\"imgInput\",staticClass:\"file-input\",attrs:{accept:\"image/*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}})]),t._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{nativeOn:{click:function(e){return t.handleCancel(e)}}},[t._v(\"取消\")]),t._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.handleConfirm,expression:\"handleConfirm\"}],attrs:{type:\"primary\"}},[t._v(\"确定\")])],1)])},[],!1,null,\"60b478b5\",null);v.options.__file=\"LogEditDialog.vue\";e.default=v.exports},\"/hyb\":function(t,e,s){\"use strict\";var i=s(\"KOLf\");s.n(i).a},\"08m3\":function(t,e,s){},\"1F+2\":function(t,e,s){},\"1Wof\":function(t,e,s){},\"1Xy/\":function(t,e,s){\"use strict\";var i=s(\"3dm0\");s.n(i).a},\"2MCj\":function(t,e,s){\"use strict\";var i=s(\"1F+2\");s.n(i).a},\"2X1c\":function(t,e,s){\"use strict\";s.d(e,\"b\",function(){return a}),s.d(e,\"a\",function(){return n}),s.d(e,\"c\",function(){return o});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"workTask/queryTrashList\",method:\"post\",data:t})}function n(t){return Object(i.a)({url:\"workTask/deleteTask/\"+t,method:\"post\"})}function o(t){return Object(i.a)({url:\"workTask/restore/\"+t,method:\"post\"})}},\"3Qrg\":function(t,e,s){\"use strict\";var i=s(\"XFCB\");s.n(i).a},\"3dm0\":function(t,e,s){},\"3z7q\":function(t,e,s){\"use strict\";s.r(e);var i=s(\"7Qib\"),a=s(\"3ojK\"),n=s(\"1bNe\"),o=s(\"gwiD\"),c=s(\"vV2+\"),l=s(\"mVxz\"),r=s(\"tMlD\"),u=s(\"ALhW\"),d=s(\"slnp\"),h=s(\"pKm3\"),p=s(\"GEWF\"),m=s(\"U63j\"),f=s(\"0dur\"),v=s(\"uSKd\"),g=s(\"f462\"),b=s(\"AWvD\"),k={name:\"CRMFullScreenDetail\",components:{LeadsDetail:a.default,CustomerDetail:n.default,ContactsDetail:o.default,BusinessDetail:c.default,ContractDetail:l.default,ProductDetail:r.default,ReceivablesDetail:u.default,ExamineDetail:d.default,TaskDetail:h.default,LogDetail:p.default,NoticeDetail:m.default,VisitDetail:f.default,InvoiceDetail:v.default,ExpenseDetail:g.default,ExpenseExamineDetail:b.default},props:{id:[String,Number],crmType:{type:String,default:\"\"},visible:{type:Boolean,default:!1}},data:function(){return{showDetail:!1}},computed:{tabName:function(){return\"leads\"==this.crmType?\"LeadsDetail\":\"customer\"==this.crmType?\"CustomerDetail\":\"contacts\"==this.crmType?\"ContactsDetail\":\"business\"==this.crmType?\"BusinessDetail\":\"contract\"==this.crmType?\"ContractDetail\":\"product\"==this.crmType?\"ProductDetail\":\"receivables\"==this.crmType?\"ReceivablesDetail\":\"examine\"==this.crmType?\"ExamineDetail\":\"task\"==this.crmType?\"TaskDetail\":\"log\"==this.crmType?\"LogDetail\":\"announcement\"==this.crmType?\"NoticeDetail\":\"visit\"==this.crmType?\"VisitDetail\":\"invoice\"==this.crmType?\"InvoiceDetail\":\"expense\"==this.crmType?\"ExpenseDetail\":\"expense-examines\"==this.crmType?\"ExpenseExamineDetail\":\"\"}},watch:{visible:function(t){this.showDetail=t,t&&(document.body.appendChild(this.$el),this.$el.addEventListener(\"click\",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(i.q)())},showDetail:function(t){var e=this;t||setTimeout(function(){e.$emit(\"update:visible\",!1)},350)}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.addEventListener(\"click\",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(i.q)())},beforeDestroy:function(){this.$el&&this.$el.parentNode&&(this.$el.parentNode.removeChild(this.$el),this.$el.removeEventListener(\"click\",this.handleDocumentClick,!1))},methods:{hiddenView:function(){this.showDetail=!1},handleDocumentClick:function(t){this.$el==t.target&&(this.showDetail=!1)},detailHandle:function(t){\"alloc\"!==t.type&&\"get\"!==t.type&&\"transfer\"!==t.type&&\"transform\"!==t.type&&\"delete\"!==t.type&&\"put_seas\"!==t.type||(this.showDetail=!1),this.$emit(\"handle\",t)}}},y=(s(\"F+K4\"),s(\"KHd+\")),_=Object(y.a)(k,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.visible,expression:\"visible\"}],staticClass:\"full-container\"},[t.id&&t.showDetail?s(t.tabName,{tag:\"component\",staticClass:\"d-view\",attrs:{\"crm-type\":t.crmType,id:t.id},on:{handle:t.detailHandle,\"hide-view\":t.hiddenView}}):t._e()],1)},[],!1,null,\"6a746c2c\",null);_.options.__file=\"CRMFullScreenDetail.vue\";e.default=_.exports},\"4lzj\":function(t,e,s){},\"5pSV\":function(t,e,s){\"use strict\";var i=s(\"Rq8O\");s.n(i).a},\"6o/o\":function(t,e,s){},\"77fj\":function(t,e,s){\"use strict\";var i=s(\"Btlj\");s.n(i).a},\"936R\":function(t,e,s){\"use strict\";var i=s(\"Rw8k\");s.n(i).a},\"9Y/r\":function(t,e,s){\"use strict\";var i=s(\"6o/o\");s.n(i).a},ANtS:function(t,e,s){\"use strict\";var i=s(\"fRE+\");s.n(i).a},AVjW:function(t,e,s){\"use strict\";var i=s(\"gIBH\");s.n(i).a},B2DG:function(t,e,s){\"use strict\";var i=s(\"lebS\");s.n(i).a},BLKJ:function(t,e,s){\"use strict\";var i=s(\"dow+\");s.n(i).a},Bd1s:function(t,e,s){\"use strict\";var i=s(\"08m3\");s.n(i).a},BsgX:function(t,e,s){\"use strict\";s.r(e);var i={name:\"ReportMenu\",components:{},mixins:[s(\"Z+Ht\").a],props:{list:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{itemClick:function(t){this.$emit(\"select\",t)}}},a=(s(\"2MCj\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"span\",{staticClass:\"report-menu\"},t._l(t.list,function(e,i){return s(\"span\",{key:i,staticClass:\"report-menu-btn\",on:{click:function(s){t.itemClick(e)}}},[s(\"i\",{staticClass:\"report-menu-btn__icon\",class:t.getXrIcon(e.type),style:{color:t.getXrIconColor(e.type)}}),t._v(\" \"),s(\"span\",{staticClass:\"report-menu-btn__name\"},[t._v(t._s(e.name))])])}))},[],!1,null,\"37799401\",null);n.options.__file=\"ReportMenu.vue\";e.default=n.exports},Btlj:function(t,e,s){},BzA1:function(t,e,s){\"use strict\";s.r(e);var i=s(\"a/5N\"),a={name:\"ImportInfo\",components:{},props:{list:Array},data:function(){return{}},computed:{showList:function(){return this.list.filter(function(t){return\"file\"!==t.formType})}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{getValueContent:function(t){if(\"map_address\"===t.formType)return t.value?t.value.detailAddress:\"\";if(\"structure\"===t.formType||\"user\"===t.formType||\"checkbox\"===t.formType){if(Object(i.a)(t.value)){var e={structure:\"name\",user:\"realname\",checkbox:\"\"}[t.formType];return t.value.map(function(t){return e?t[e]:t}).join(\"，\")}return\"\"}if(\"single_user\"===t.formType)return Object(i.c)(t.value)&&t.value.realname?t.value.realname:\"\";if(\"customer\"===t.formType||\"business\"===t.formType||\"contract\"===t.formType||\"contacts\"===t.formType||\"category\"===t.formType||\"statusName\"===t.formType||\"typeName\"===t.formType){var s={customer:\"customerName\",business:\"businessName\",contract:\"contractNum\",contacts:\"contactsName\",category:\"categoryName\",statusName:\"statusName\",typeName:\"typeName\"}[t.formType];return Object(i.a)(t.value)?t.value.length>0?t.value[0][s]:\"\":t.value?t.value[s]:\"\"}return t.value}}},n=(s(\"AVjW\"),s(\"KHd+\")),o=Object(n.a)(a,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"content\"},[s(\"div\",{staticClass:\"content-title\"},[t._v(\"基本信息\")]),t._v(\" \"),t._l(t.showList,function(e,i){return s(\"p\",{key:i,staticClass:\"detail-cell\"},[s(\"span\",{staticClass:\"detail-cell__label\"},[t._v(\"\\n      \"+t._s(e.name)+\"\\n    \")]),s(\"br\"),t._v(\" \"),s(\"span\",{staticClass:\"detail-cell__value\"},[t._v(\"\\n      \"+t._s(t.getValueContent(e))+\"\\n    \")])])})],2)},[],!1,null,\"74c3ac7c\",null);o.options.__file=\"ImportInfo.vue\";e.default=o.exports},C3Po:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"8GhS\"),o=s(\"zsVz\"),c={name:\"TaskQuickAdd\",components:{XhUserCell:n.p},props:{params:Object},data:function(){return{sendLoading:!1,isUnfold:!1,sendContent:\"\",sendStopTime:\"\",mainUser:[]}},computed:{createMainUser:function(){return this.mainUser&&this.mainUser.length?this.mainUser[0]:null}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{inputFocus:function(){var t=this;this.$emit(\"focus\"),this.isUnfold=!0,this.$nextTick(function(){t.$refs.input.focus()})},selectMainUser:function(t){this.mainUser=t.value},send:function(){var t=this;if(this.sendContent.length){this.sendLoading=!0;var e={name:this.sendContent,stopTime:this.sendStopTime,mainUserId:this.createMainUser?this.createMainUser.userId:\"\"};this.params&&(e=a()({},e,this.params)),Object(o.e)(e).then(function(e){t.sendLoading=!1,t.$message.success(\"新建成功\"),t.resetSendData(),t.$emit(\"send\")}).catch(function(){t.sendLoading=!1})}else this.$message.error(\"请填写任务标题\")},resetSendData:function(){this.sendContent=\"\",this.sendStopTime=\"\",this.mainUser=[],this.isUnfold=!1},addClose:function(){this.isUnfold=!1}}},l=(s(\"5pSV\"),s(\"KHd+\")),r=Object(l.a)(c,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.sendLoading,expression:\"sendLoading\"}],staticClass:\"task-quick-add\",class:[\"add\",{unfold:t.isUnfold,\"is-close\":!t.isUnfold}]},[t.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:t.addClose}}):t._e(),t._v(\" \"),s(\"el-input\",{ref:\"input\",staticClass:\"input\",attrs:{maxlength:100,\"prefix-icon\":t.isUnfold?\"\":\"el-icon-plus\",placeholder:\"添加任务\"},on:{focus:t.inputFocus},model:{value:t.sendContent,callback:function(e){t.sendContent=e},expression:\"sendContent\"}}),t._v(\" \"),s(\"flexbox\",{staticClass:\"add-info\"},[s(\"el-date-picker\",{ref:\"endTime\",class:{\"no-time-top\":!t.sendStopTime},attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"\"},model:{value:t.sendStopTime,callback:function(e){t.sendStopTime=e},expression:\"sendStopTime\"}}),t._v(\" \"),s(\"xh-user-cell\",{attrs:{value:t.mainUser,radio:\"\",placement:\"top\"},on:{\"value-change\":t.selectMainUser}},[s(\"div\",{staticClass:\"select-user\",attrs:{slot:\"reference\"},slot:\"reference\"},[t.createMainUser?s(\"xr-avatar\",{attrs:{name:t.createMainUser.realname,size:24,src:t.createMainUser.img}}):s(\"i\",{staticClass:\"wk wk-persons add-info--person\"})],1)])],1),t._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.send,expression:\"send\"}],staticClass:\"send-btn\",attrs:{icon:\"wk wk-top\",type:\"primary\"}},[t._v(\"发布\")])],1)},[],!1,null,\"38430333\",null);r.options.__file=\"TaskQuickAdd.vue\";e.default=r.exports},Cbuk:function(t,e,s){},EBQf:function(t,e,s){\"use strict\";var i=s(\"QbLZ\"),a=s.n(i),n=s(\"mkuN\"),o=s(\"/407\"),c=s(\"L2JU\"),l={name:\"RelatedBusiness\",components:{CrmRelative:n.a,RelatedBusinessCell:o.default},props:{marginLeft:{type:String,default:\"20px\"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},showFoot:{type:Boolean,default:!1},showAdd:{type:Boolean,default:!0}},data:function(){return{showTypes:[\"customer\",\"contacts\",\"business\",\"contract\"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1}},computed:a()({},Object(c.b)([\"crm\"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var s=function(s){var i=t.data[s];e.relevanceAll[s+\"Ids\"]=i.map(function(t){return t[s+\"Id\"]})};for(var i in t.data)s(i);this.$emit(\"checkInfos\",this.relevanceAll,t.data)},delRelevance:function(t,e,s){this.$emit(\"unbind\",t,s,e)},checkRelatedDetail:function(t,e){e.key=e[t+\"Id\"]||e.id,this.$emit(\"checkRelatedDetail\",t,e)}}},r=(s(\"PdhK\"),s(\"KHd+\")),u=Object(r.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"related-business\",style:{\"margin-left\":t.marginLeft}},[t.showAdd?s(\"el-popover\",{attrs:{placement:\"right-end\",width:\"800\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:\"showPopover\"}},[t.showRelative?s(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:t.showPopover,radio:!1,\"selected-data\":t.relatedListData,\"show-types\":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(\" \"),t.showCRMPermission?s(\"span\",{staticClass:\"add-btn\",attrs:{slot:\"reference\"},on:{click:function(e){t.showRelative=!0}},slot:\"reference\"},[s(\"i\",{staticClass:\"wk wk-l-plus\"}),t._v(\" \"),s(\"span\",{staticClass:\"label\"},[t._v(\"关联业务\")])]):t._e()],1):t._e(),t._v(\" \"),t._l(t.relatedListData,function(e,i){return s(\"div\",{key:i,staticStyle:{\"margin-top\":\"10px\"}},t._l(e,function(e,a){return s(\"related-business-cell\",{key:a,attrs:{data:e,\"cell-index\":a,type:i,\"show-foot\":t.showFoot},on:{unbind:t.delRelevance,detail:function(s){t.checkRelatedDetail(i,e)}}})}))})],2)},[],!1,null,\"2724a194\",null);u.options.__file=\"RelatedBusiness.vue\";e.a=u.exports},\"F+K4\":function(t,e,s){\"use strict\";var i=s(\"1Wof\");s.n(i).a},Flj7:function(t,e,s){\"use strict\";s.d(e,\"f\",function(){return a}),s.d(e,\"h\",function(){return n}),s.d(e,\"g\",function(){return o}),s.d(e,\"o\",function(){return c}),s.d(e,\"p\",function(){return l}),s.d(e,\"e\",function(){return r}),s.d(e,\"r\",function(){return u}),s.d(e,\"i\",function(){return d}),s.d(e,\"a\",function(){return h}),s.d(e,\"k\",function(){return p}),s.d(e,\"q\",function(){return m}),s.d(e,\"j\",function(){return f}),s.d(e,\"m\",function(){return v}),s.d(e,\"l\",function(){return g}),s.d(e,\"n\",function(){return b}),s.d(e,\"b\",function(){return k}),s.d(e,\"d\",function(){return y}),s.d(e,\"c\",function(){return _});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"workTaskClass/saveWorkTaskClass\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function n(t){return Object(i.a)({url:\"workTask/deleteWorkTask/\"+t,method:\"post\"})}function o(t){return Object(i.a)({url:\"workTaskClass/updateWorkTaskClass\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function c(t){return Object(i.a)({url:\"workTask/saveWorkTask\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function l(t){return Object(i.a)({url:\"workTask/setWorkTaskStatus\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function r(t){return Object(i.a)({url:\"workTask/setWorkChildTaskStatus\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function u(t){return Object(i.a)({url:\"workTask/setWorkTaskTitle\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function d(t){return Object(i.a)({url:\"workTask/setWorkTaskDescription\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function h(t){return Object(i.a)({url:\"workTaskMilestone/setTaskMilestone\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function p(t){return Object(i.a)({url:\"workTask/setWorkTaskMainUser\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function m(t){return Object(i.a)({url:\"workTask/setWorkTaskTime\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function f(t){return Object(i.a)({url:\"workTask/setWorkTaskLabel\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function v(t){return Object(i.a)({url:\"workTask/setWorkTaskOwnerUser\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function g(t){return Object(i.a)({url:\"workTask/deleteWorkTaskOwnerUser\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function b(t){return Object(i.a)({url:\"workTask/setWorkTaskPriority\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function k(t){return Object(i.a)({url:\"workTask/addWorkChildTask\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function y(t){return Object(i.a)({url:\"workTask/updateWorkChildTask\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function _(t){return Object(i.a)({url:\"workTask/deleteWorkChildTask/\"+t,method:\"post\"})}},FoeY:function(t,e,s){\"use strict\";s.d(e,\"d\",function(){return a}),s.d(e,\"a\",function(){return n}),s.d(e,\"b\",function(){return o}),s.d(e,\"e\",function(){return c}),s.d(e,\"c\",function(){return l});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"oaAnnouncement/queryList\",method:\"post\",data:t})}function n(t){var e=t.announcementId?\"setAnnouncement\":\"addAnnouncement\";return Object(i.a)({url:\"oaAnnouncement/\"+e,method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function o(t){return Object(i.a)({url:\"oaAnnouncement/delete/\"+t,method:\"post\"})}function c(t){return Object(i.a)({url:\"oaAnnouncement/queryById/\"+t,method:\"post\"})}function l(t){return Object(i.a)({url:\"oaAnnouncement/readAnnouncement\",method:\"post\",data:t})}},GEWF:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"VmBU\"),o=s(\"Ir+r\"),c=s(\"Ew9n\"),l=s(\"MdnP\"),r=s(\"hwzM\"),u=s(\"/407\"),d=s(\"BsgX\"),h=s(\"KmSi\"),p=s(\"dPzk\"),m=s(\"z7oh\"),f=s(\"L2JU\"),v=s(\"jHPx\"),g={name:\"LogDetail\",components:{SlideView:c.a,PictureListView:l.a,FileCell:r.default,RelatedBusinessCell:u.default,ReportMenu:d.default,ReportList:h.default,ReplyComment:p.a,CommentList:m.a,CRMFullScreenDetail:function(){return s.e(\"chunk-66e8\").then(s.bind(null,\"3z7q\"))}},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return[\"el-table__body\"]}}},data:function(){return{loading:!1,detail:null,relatedID:\"\",relatedCRMType:\"\",showRelatedDetail:!1,reportList:[{type:\"customer\",key:\"customerCount\",info:\"今日新增客户\",name:\"今日新增客户 0\"},{type:\"business\",key:\"businessCount\",info:\"今日新增商机\",name:\"今日新增商机 0\"},{type:\"contract\",key:\"contractCount\",info:\"今日新增合同\",name:\"今日新增合同 0\"},{type:\"receivables\",key:\"receivablesMoney\",info:\"今日新增回款\",name:\"今日新增回款 0\"},{type:\"record\",key:\"recordCount\",info:\"今日新增跟进记录\",name:\"今日新增跟进记录 0\"}],reportListShow:!1,fieldReportList:null,reportData:{title:\"\",placeholder:\"\",crmType:\"\",request:null,recordRequest:n.g,params:null,paging:!0,sortable:!1},commentLoading:!1,replyList:[]}},computed:a()({},Object(f.b)([\"userInfo\"]),{relatedListData:function(){for(var t={},e=[\"contacts\",\"customer\",\"business\",\"contract\"],s=0;s<e.length;s++){var i=e[s],a=this.detail[i+\"List\"]||[];a.length>0&&(t[i]=a)}return t}}),watch:{id:function(){this.viewAfterEnter()}},mounted:function(){},beforeDestroy:function(){},methods:{viewAfterEnter:function(){this.detail=null,this.getDetail(),this.getCommentList()},getDetail:function(){var t=this;this.loading=!0,Object(n.h)({logId:this.id}).then(function(e){if(t.detail=e.data,t.detail.getBulletin){var s=t.detail.bulletin||{};t.reportList=t.reportList.map(function(t){return\"receivablesMoney\"==t.key&&(s.receivablesMoney=Object(v.h)(Math.floor(s.receivablesMoney||0))),t.name=t.info+\" \"+s[t.key],t})}t.loading=!1}).catch(function(){t.loading=!1,t.hideView()})},checkRelatedDetail:function(t,e){this.relatedID=e[t+\"Id\"],this.relatedCRMType=t,this.showRelatedDetail=!0},hideView:function(){this.$emit(\"close\"),this.$emit(\"hide-view\")},reportSelect:function(t,e){e=this.detail,t.type&&(this.reportData.title=\"销售简报-\"+t.info,this.reportData.placeholder={customer:\"请输入客户名称\",business:\"请输入商机名称\",contract:\"请输入合同名称\",receivables:\"请输入回款编号\",record:\"\"}[t.type],this.reportData.crmType=t.type,this.reportData.params=e?{logId:e.logId}:{today:1},this.reportData.params.type={customer:1,business:2,contract:3,receivables:4,record:5}[t.type],\"record\"==t.type?(this.fieldReportList=[{label:\"模块\",prop:\"crmType\",width:300},{label:\"新增跟进记录数\",prop:\"count\"}],this.reportData.request=n.i,this.reportData.paging=!1,this.reportData.sortable=!1):(this.fieldReportList=this.getReportFieldList(t.type),this.reportData.request=n.g,this.reportData.paging=!0,this.reportData.sortable=\"custom\"),this.reportListShow=!0)},getReportFieldList:function(t){return{customer:[{label:\"客户名称\",prop:\"customerName\"},{label:\"成交状态\",prop:\"dealStatus\"},{label:\"最后跟进时间\",prop:\"lastTime\"},{label:\"创建时间\",prop:\"createTime\"},{label:\"负责人\",prop:\"ownerUserName\"}],business:[{label:\"商机名称\",prop:\"businessName\"},{label:\"商机阶段\",prop:\"statusName\"},{label:\"最后跟进时间\",prop:\"lastTime\"},{label:\"创建时间\",prop:\"createTime\"},{label:\"负责人\",prop:\"ownerUserName\"}],contract:[{label:\"合同名称\",prop:\"contractName\"},{label:\"合同状态\",prop:\"checkStatus\"},{label:\"创建时间\",prop:\"createTime\"},{label:\"公司签约人\",prop:\"companyUserName\"}],receivables:[{label:\"回款编号\",prop:\"number\"},{label:\"回款时间\",prop:\"returnTime\"},{label:\"负责人\",prop:\"ownerUserName\"}]}[t]},getCommentList:function(){var t=this;Object(o.b)({typeId:this.id,type:2}).then(function(e){var s=e.data||[];t.replyList=s}).catch(function(){})},closeOtherReply:function(t){!t&&this.$refs.comment_list&&this.$refs.comment_list.closeReply()},deleteComment:function(t){this.replyList.splice(t,1)},handleReply:function(t){var e=this;this.commentLoading=!0,Object(o.c)({type:2,content:t,typeId:this.id}).then(function(t){t.data.user={userId:e.userInfo.userId,realname:e.userInfo.realname,img:e.userInfo.img},t.data.childCommentList=[],e.$refs.f_reply.commentsTextarea=\"\",e.replyList.push(t.data),e.commentLoading=!1}).catch(function(){e.commentLoading=!1})}}},b=(s(\"REO3\"),s(\"KHd+\")),k=Object(b.a)(g,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"slide-view\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"d-view\",attrs:{\"no-listener-class\":t.noListenerClass,\"body-style\":{padding:0,height:\"100%\"},\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"},on:{afterEnter:t.viewAfterEnter,close:t.hideView}},[t.detail?s(\"div\",{staticClass:\"main\",attrs:{direction:\"column\",align:\"stretch\"}},[s(\"flexbox\",{staticClass:\"detail-header\"},[s(\"div\",{staticClass:\"header-icon\"},[s(\"i\",{staticClass:\"wk wk-log\"})]),t._v(\" \"),s(\"div\",{staticClass:\"header-name\"},[t._v(\"日志\")])]),t._v(\" \"),s(\"div\",{staticClass:\"main__bd\"},[s(\"div\",{staticClass:\"main__bd--info\"},[s(\"div\",{staticClass:\"content\"},[t.detail.content?s(\"div\",{staticClass:\"content-box\"},[s(\"div\",{staticClass:\"content-title\"},[t._v(\"\\n              今日工作内容：\\n            \")]),t._v(\" \"),s(\"div\",{staticClass:\"content-text\"},[t._v(t._s(t.detail.content))])]):t._e(),t._v(\" \"),t.detail.tomorrow?s(\"div\",{staticClass:\"content-box\"},[s(\"div\",{staticClass:\"content-title\"},[t._v(\"\\n              明日工作的内容：\\n            \")]),t._v(\" \"),s(\"div\",{staticClass:\"content-text\"},[t._v(t._s(t.detail.tomorrow))])]):t._e(),t._v(\" \"),t.detail.question?s(\"div\",{staticClass:\"content-box\"},[s(\"div\",{staticClass:\"content-title\"},[t._v(\"\\n              遇到的问题：\\n            \")]),t._v(\" \"),s(\"div\",{staticClass:\"content-text\"},[t._v(t._s(t.detail.question))])]):t._e()]),t._v(\" \"),0!==t.detail.img.length?s(\"picture-list-view\",{attrs:{list:t.detail.img}}):t._e(),t._v(\" \"),t.detail.sendUserList&&t.detail.sendUserList.length?s(\"flexbox\",{staticClass:\"send-list\"},[s(\"span\",{staticClass:\"send-list__label\"},[t._v(\"发送给：\")]),t._v(\" \"),t._l(t.detail.sendUserList,function(t,e){return s(\"span\",{key:e,staticClass:\"send-list__user\"},[s(\"xr-avatar\",{attrs:{name:t.realname,size:32,src:t.img,id:t.userId,disabled:!1,trigger:\"hover\"}})],1)})],2):t._e(),t._v(\" \"),t.detail.file.length?s(\"div\",{staticClass:\"section\"},[s(\"div\",{staticClass:\"section__hd\"},[s(\"i\",{staticClass:\"wukong wukong-file\"}),t._v(\" \"),s(\"span\",[t._v(\"附件\")]),t._v(\" \"),s(\"span\",[t._v(\"(\"+t._s(t.detail.file.length)+\")\")])]),t._v(\" \"),s(\"div\",{staticClass:\"section__bd\"},t._l(t.detail.file,function(e,i){return s(\"file-cell\",{key:i,attrs:{data:e,list:t.detail.file,\"cell-index\":i}})}))]):t._e(),t._v(\" \"),Object.keys(t.relatedListData).length>0?s(\"div\",{staticClass:\"section\"},[s(\"div\",{staticClass:\"section__hd\"},[s(\"i\",{staticClass:\"wukong wukong-relevance\"}),t._v(\" \"),s(\"span\",[t._v(\"相关信息\")])]),t._v(\" \"),s(\"div\",{staticClass:\"section__bd\"},t._l(t.relatedListData,function(e,i){return s(\"div\",{key:i},t._l(e,function(e,a){return s(\"related-business-cell\",{key:a,attrs:{data:e,\"cell-index\":a,type:i,\"show-foot\":!1},nativeOn:{click:function(s){t.checkRelatedDetail(i,e)}}})}))}))]):t._e(),t._v(\" \"),t.detail.getBulletin?s(\"div\",{staticClass:\"section\"},[s(\"div\",{staticClass:\"section__hd\"},[s(\"i\",{staticClass:\"wk wk-briefing\"}),t._v(\" \"),s(\"span\",[t._v(\"销售简报\")])]),t._v(\" \"),s(\"div\",{staticClass:\"section__bd\"},[s(\"report-menu\",{attrs:{list:t.reportList},on:{select:t.reportSelect}})],1)]):t._e()],1),t._v(\" \"),s(\"el-tabs\",{staticClass:\"commont\",attrs:{value:\"commont\",type:\"border-card\"}},[s(\"el-tab-pane\",{attrs:{label:\"回复\",name:\"commont\"}},[s(\"reply-comment\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.commentLoading,expression:\"commentLoading\"}],ref:\"f_reply\",on:{toggle:t.closeOtherReply,reply:t.handleReply}}),t._v(\" \"),t.replyList.length>0?s(\"comment-list\",{ref:\"comment_list\",attrs:{id:t.id,list:t.replyList,type:\"2\"},on:{delete:t.deleteComment,\"close-other-reply\":function(e){t.$refs.f_reply.toggleFocus(!0)}}}):t._e()],1)],1)],1)],1):t._e(),t._v(\" \"),s(\"c-r-m-full-screen-detail\",{attrs:{visible:t.showRelatedDetail,\"crm-type\":t.relatedCRMType,id:t.relatedID},on:{\"update:visible\":function(e){t.showRelatedDetail=e}}}),t._v(\" \"),s(\"report-list\",{attrs:{show:t.reportListShow,title:t.reportData.title,placeholder:t.reportData.placeholder,\"crm-type\":t.reportData.crmType,request:t.reportData.request,params:t.reportData.params,\"record-request\":t.reportData.recordRequest,\"field-list\":t.fieldReportList,paging:t.reportData.paging,sortable:t.reportData.sortable},on:{\"update:show\":function(e){t.reportListShow=e}}})],1)},[],!1,null,\"6037d098\",null);k.options.__file=\"LogDetail.vue\";e.default=k.exports},HslM:function(t,e,s){\"use strict\";s.r(e);var i=s(\"FyfS\"),a=s.n(i),n=s(\"Vf/o\"),o=s(\"PAIM\"),c=s(\"zsVz\"),l=s(\"Ajln\"),r=s(\"Flj7\"),u={components:{NewTag:n.default,EditTag:o.default},props:{taskData:{type:Object,default:function(){return{}}},placement:String},data:function(){return{tagShow:!1,tagContent:0,tagSearch:\"\",tagList:[],newTagTitle:\"\",newTagInput:\"\",bgColorProps:\"\",editTagId:\"\"}},computed:{showTagList:function(){for(var t=[],e=0;e<this.tagList.length;e++){var s=this.tagList[e];s.name.indexOf(this.tagSearch)>-1&&t.push(s)}return t},popoverWidth:function(){return 1==this.tagContent?330:2==this.tagContent?400:220},workId:function(){return this.taskData.workId}},watch:{},mounted:function(){},methods:{createTagClick:function(){this.newTagTitle=\"创建新标签\",this.newTagInput=\"\",this.tagContent=1},editTagClick:function(t){this.editTagId=t.labelId,this.newTagTitle=\"编辑标签\",this.tagContent=1,this.bgColorProps=t.color,this.newTagInput=t.name},managementTag:function(){this.tagContent=2},tagSelectClick:function(t,e){var s=this;if(t.check)Object(c.f)({taskId:this.taskData.taskId,labelId:t.labelId}).then(function(e){t.check=!1,s.updateDetailList(t,\"delete\")}).catch(function(){t.check=!0});else{var i=this.tagList.filter(function(t){return t.check}).concat(t);Object(r.j)({taskId:this.taskData.taskId,labelId:i.map(function(t){return t.labelId}).join(\",\")}).then(function(e){t.check=!0;var i=[];s.tagList.forEach(function(t){t.check&&(t.labelName=t.name,i.push(t))}),s.taskData.labelList=i}).catch(function(){t.check=!1})}},updateDetailList:function(t,e){for(var s=-1,i=0;i<this.taskData.labelList.length;i++){if(this.taskData.labelList[i].labelId==t.labelId){s=i;break}}s>=0&&(\"delete\"==e?this.taskData.labelList.splice(s,1):this.taskData.labelList.splice(s,1,t))},changeColor:function(t){this.bgColorProps=t},tagClose:function(){this.tagShow=!1},tagCreateSubmit:function(t,e){var s=this;\"创建新标签\"==this.newTagTitle?Object(l.e)({name:t,color:e}).then(function(t){s.getTagList(),s.back(),s.$message.success(\"创建成功\")}):Object(l.f)({name:t,labelId:this.editTagId,color:e}).then(function(i){var n=!0,o=!1,c=void 0;try{for(var l,r=a()(s.tagList);!(n=(l=r.next()).done);n=!0){var u=l.value;u.labelId==s.editTagId&&(u.name=t,u.color=e,u.labelName=u.name,s.updateDetailList(u,\"update\"))}}catch(t){o=!0,c=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw c}}s.tagContent=2})},tagCancel:function(){\"创建新标签\"==this.newTagTitle?(this.tagClose(),this.$message.info(\"已取消创建\")):this.tagContent=2},back:function(){1==this.tagContent?this.tagContent=\"创建新标签\"==this.newTagTitle?0:2:2==this.tagContent&&(this.tagContent=0)},deleteBtn:function(t){var e=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){Object(l.a)({labelId:t.labelId}).then(function(s){for(var i in e.tagList)if(e.tagList[i].labelId==t.labelId){e.tagList.splice(i,1);break}e.$message({type:\"success\",message:\"删除成功!\"}),e.tagShow=!0}).catch(function(){e.tagShow=!0})}).catch(function(){e.$message({type:\"info\",message:\"已取消删除\"}),e.tagShow=!0})},getTagList:function(){var t=this;Object(l.c)().then(function(e){var s=e.data||[],i=(t.taskData.labelList||[]).map(function(t){return t.labelId}),n=!0,o=!1,c=void 0;try{for(var l,r=a()(s);!(n=(l=r.next()).done);n=!0){var u=l.value;u.check=i.includes(u.labelId)}}catch(t){o=!0,c=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw c}}t.tagList=s}).catch(function(){})},referenceFun:function(){this.tagContent=0,this.tagList&&!this.tagList.length&&this.getTagList()}}},d=(s(\"BLKJ\"),s(\"KHd+\")),h=Object(d.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-popover\",{attrs:{placement:t.placement,width:t.popoverWidth,trigger:\"click\"},model:{value:t.tagShow,callback:function(e){t.tagShow=e},expression:\"tagShow\"}},[0==t.tagContent?s(\"div\",{staticClass:\"tag-popover-box\"},[s(\"div\",{staticClass:\"tag-top\"},[s(\"span\",[t._v(\"选择标签\")]),t._v(\" \"),s(\"span\",{staticClass:\"el-icon-close rt cursor-pointer\",on:{click:function(e){t.tagShow=!1}}})]),t._v(\" \"),s(\"el-input\",{attrs:{placeholder:\"搜索标签\",\"prefix-icon\":\"el-icon-search\",size:\"small\"},model:{value:t.tagSearch,callback:function(e){t.tagSearch=e},expression:\"tagSearch\"}}),t._v(\" \"),s(\"div\",{staticClass:\"tag-content\"},t._l(t.showTagList,function(e,i){return s(\"div\",{key:i,staticClass:\"tag-list\",on:{click:function(s){t.tagSelectClick(e,i)}}},[s(\"i\",{staticClass:\"wukong wukong-black-label\",style:{color:e.color}}),t._v(\" \"),s(\"span\",{staticClass:\"item-label\"},[t._v(t._s(e.name))]),t._v(\" \"),e.check?s(\"span\",{staticClass:\"el-icon-check rt\"}):t._e()])})),t._v(\" \"),s(\"div\",{staticClass:\"tag-footer\"},[s(\"p\",{staticClass:\"footer-row cursor-pointer\",on:{click:t.createTagClick}},[s(\"span\",{staticClass:\"el-icon-plus\"}),t._v(\" \"),s(\"span\",[t._v(\"创建新标签\")])]),t._v(\" \"),s(\"p\",{staticClass:\"footer-row cursor-pointer\",on:{click:t.managementTag}},[s(\"span\",{staticClass:\"el-icon-setting\"}),t._v(\" \"),s(\"span\",[t._v(\"标签管理\")])])])],1):1==t.tagContent||3==t.tagContent?s(\"new-tag\",{attrs:{\"new-tag-title\":t.newTagTitle,\"new-tag-input\":t.newTagInput,\"bg-color-props\":t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):2==t.tagContent?s(\"editTag\",{attrs:{\"edit-tag-list\":t.tagList},on:{back:t.back,close:t.tagClose,editBtn:t.editTagClick,deleteBtn:t.deleteBtn}}):t._e(),t._v(\" \"),s(\"span\",{attrs:{slot:\"reference\"},on:{click:t.referenceFun},slot:\"reference\"},[t._t(\"editIndex\")],2)],1)},[],!1,null,\"6fcf0e94\",null);h.options.__file=\"TagIndex.vue\";e.default=h.exports},HtQe:function(t,e,s){\"use strict\";var i=s(\"OM3V\");s.n(i).a},\"I+NK\":function(t,e,s){\"use strict\";var i=s(\"PWYh\");s.n(i).a},IJOA:function(t,e,s){\"use strict\";var i=s(\"ujp9\");s.n(i).a},\"Ir+r\":function(t,e,s){\"use strict\";s.d(e,\"c\",function(){return a}),s.d(e,\"a\",function(){return n}),s.d(e,\"b\",function(){return o});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"workTaskComment/setComment\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function n(t){return Object(i.a)({url:\"workTaskComment/deleteComment\",method:\"post\",data:t})}function o(t){return Object(i.a)({url:\"workTaskComment/queryCommentList\",method:\"post\",data:t})}},KOLf:function(t,e,s){},KmSi:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"4XAY\"),o=s(\"ZoMv\"),c=s(\"yPq4\"),l=s(\"qDfk\"),r=s(\"L2JU\"),u=s(\"4peS\"),d=s.n(u),h=s(\"dAOq\"),p={name:\"ReportList\",components:{CRMAllDetail:c.default,RecordList:l.default},filters:{dealIcon:function(t){return 1==t?\"wk wk-success deal-suc\":\"wk wk-close deal-un\"},dealName:function(t){return 1==t?\"已成交\":\"未成交\"}},mixins:[h.a],props:{show:{type:Boolean,default:!1},title:String,placeholder:{type:String,default:\"请输入搜索内容\"},crmType:String,fieldList:Array,recordRequest:Function,request:Function,params:Object,paging:{type:Boolean,default:!0},sortable:{type:[Boolean,String],default:!1}},data:function(){return{inputContent:\"\",loading:!1,tableHeight:this.getTableHeight(),list:[],showFieldList:[],sortData:{},currentPage:1,pageSize:d.a.get(\"crmPageSizes\")||15,pageSizes:[15,30,60,100],total:0,rowID:\"\",rowType:\"\",showDview:!1,recordParams:{},recordShow:!1}},computed:a()({},Object(r.b)([\"crm\"]),{showExamineStatus:function(){return\"contract\"==this.crmType&&\"receivables\"==this.crmType},showFillColumn:function(){return!this.fieldList||!this.fieldList.length}}),watch:{show:function(t){t&&this.initInfo()}},mounted:function(){this.$el.addEventListener(\"click\",this.handleDocumentClick,!1)},destroyed:function(){this.$el&&this.$el.removeEventListener(\"click\",this.handleDocumentClick,!1)},methods:{getTableHeight:function(){var t=document.documentElement.clientHeight;return t-.2*t-200},initInfo:function(){var t=this;this.inputContent=\"\",this.showFieldList=[],this.sortData={},this.$nextTick(function(){t.$refs.crmTable.clearSort()}),this.list=[],this.currentPage=1,window.onresize=function(){t.tableHeight=t.getTableHeight()},this.fieldList?(this.showFieldList=this.fieldList,this.getList()):this.getFieldList()},searchInput:function(){this.currentPage=1,this.getList()},getList:function(){var t=this;this.loading=!0;var e={};this.paging&&(e={page:this.currentPage,limit:this.pageSize}),this.placeholder&&(e.search=this.inputContent),this.sortData.order&&(e.sortField=this.sortData.prop,e.order=\"ascending\"==this.sortData.order?2:1),this.request(a()({},e,this.params)).then(function(e){t.paging?(t.list=e.data.list,t.total=e.data.totalRow):t.list=e.data,t.loading=!1}).catch(function(){t.loading=!1})},getFieldList:function(){var t=this;if(0==this.showFieldList.length){this.loading=!0;var e=\"business_status\"==this.crmType?\"business\":this.crmType,s={label:o.default[e]};Object(n.A)(s).then(function(e){for(var s=0;s<e.data.length;s++){var i=e.data[s],a=0;a=i.width?i.width:i.name&&i.name.length<=6?15*i.name.length+45:140,t.showFieldList.push({prop:i.fieldName,label:i.name,width:a})}t.getList()}).catch(function(){t.loading=!1})}else this.getList()},fieldFormatter:function(t,e){return this.fieldList&&this.fieldList.length&&\"crmType\"==e.property?o.default.convertTypeToName(t[e.property]):\"\"===t[e.property]||null===t[e.property]?\"--\":t[e.property]},sortChange:function(t,e,s){this.sortData=t,this.getList()},handleSizeChange:function(t){d.a.set(\"crmPageSizes\",t),this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.currentPage=t,this.getList()},handleRowClick:function(t,e,s){\"leads\"===this.crmType?\"leadsName\"===e.property?(this.rowID=t.leadsId,this.showDview=!0):this.showDview=!1:\"customer\"===this.crmType?\"customerName\"===e.property?(this.rowID=t.customerId,this.rowType=\"customer\",this.showDview=!0):this.showDview=!1:\"contacts\"===this.crmType?\"customerName\"===e.property?(this.rowID=t.customerId,this.rowType=\"customer\",this.showDview=!0):\"name\"===e.property?(this.rowID=t.contactsId,this.rowType=\"contacts\",this.showDview=!0):this.showDview=!1:\"business\"===this.crmType||\"business_status\"===this.crmType?\"customerName\"===e.property?(this.rowID=t.customerId,this.rowType=\"customer\",this.showDview=!0):\"businessName\"===e.property?(this.rowID=t.businessId,this.rowType=\"business\",this.showDview=!0):this.showDview=!1:\"contract\"===this.crmType?\"customerName\"===e.property?(this.rowID=t.customerId,this.rowType=\"customer\",this.showDview=!0):\"businessName\"===e.property?(this.rowID=t.businessId,this.rowType=\"business\",this.showDview=!0):\"contactsName\"===e.property?(this.rowID=t.contactsId,this.rowType=\"contacts\",this.showDview=!0):\"num\"===e.property||\"name\"===e.property?(this.rowID=t.contractId,this.rowType=\"contract\",this.showDview=!0):this.showDview=!1:\"product\"===this.crmType?\"name\"===e.property?(this.rowID=t.productId,this.showDview=!0):this.showDview=!1:\"receivables\"===this.crmType?\"customerName\"===e.property?(this.rowID=t.customerId,this.rowType=\"customer\",this.showDview=!0):\"contractNum\"===e.property?(this.rowID=t.contractId,this.rowType=\"contract\",this.showDview=!0):\"number\"===e.property?(this.rowID=t.receivablesId,this.rowType=\"receivables\",this.showDview=!0):this.showDview=!1:\"record\"===this.crmType&&(\"count\"===e.property&&t.count?(this.rowType=\"crm_\"+o.default.convertTypeToKey(t.crmType),this.recordParams=a()({crmType:t.crmType,queryType:0},this.params),this.recordShow=!0):this.recordShow=!1)},handleHandle:function(t){\"alloc\"!==t.type&&\"get\"!==t.type&&\"transfer\"!==t.type&&\"transform\"!==t.type&&\"delete\"!==t.type&&\"put_seas\"!==t.type||(this.showDview=!1),\"edit\"!==t.type&&this.getList()},cellClassName:function(t){var e=t.row,s=t.column;t.rowIndex,t.columnIndex;return this.crmType&&(\"customerName\"===s.property||\"businessName\"===s.property||\"name\"===s.property||\"contactsName\"===s.property||\"num\"===s.property||\"contractNum\"===s.property||\"number\"===s.property||\"record\"===this.crmType&&\"count\"===s.property&&e[s.property])?\"can-visit--underline\":\"\"},hideView:function(){this.$emit(\"update:show\",!1),this.$emit(\"hide\")},handleDocumentClick:function(t){var e=!0,s=document.getElementsByClassName(\"el-table__row\");if(s&&e)for(var i=0;i<s.length;i++){if(s[i].contains(t.target)){e=!1;break}}document.getElementById(\"slide\")&&document.getElementById(\"slide\").contains(t.target)&&(e=!1),e&&(this.showDview=!1)}}},m=(s(\"hr1e\"),s(\"KHd+\")),f=Object(m.a)(p,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-dialog\",{attrs:{visible:t.show,\"append-to-body\":!0,\"close-on-click-modal\":!1,top:\"10vh\",width:\"80%\",\"custom-class\":\"no-padding-dialog\"},on:{close:t.hideView}},[s(\"div\",{staticClass:\"header\",attrs:{slot:\"title\"},on:{click:function(e){t.showDview=!1}},slot:\"title\"},[s(\"span\",{staticClass:\"title\"},[t._v(t._s(t.title))]),t._v(\" \"),t.placeholder?s(\"el-input\",{staticClass:\"search-input\",attrs:{placeholder:t.placeholder},nativeOn:{keyup:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.searchInput(e):null}},model:{value:t.inputContent,callback:function(e){t.inputContent=e},expression:\"inputContent\"}},[s(\"el-button\",{attrs:{slot:\"append\",icon:\"el-icon-search\"},nativeOn:{click:function(e){return t.searchInput(e)}},slot:\"append\"})],1):t._e()],1),t._v(\" \"),s(\"div\",{staticClass:\"container\"},[s(\"div\",{staticClass:\"content\"},[s(\"div\",{staticClass:\"list-body\"},[s(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],ref:\"crmTable\",staticStyle:{width:\"100%\"},attrs:{id:\"crm-table\",data:t.list,height:t.tableHeight,\"cell-class-name\":t.cellClassName,stripe:\"\",border:\"\",\"highlight-current-row\":\"\"},on:{\"row-click\":t.handleRowClick,\"sort-change\":t.sortChange}},[t._l(t.showFieldList,function(e,i){return s(\"el-table-column\",{key:i,attrs:{sortable:\"poolDay\"!=e.prop&&\"custom\",fixed:0==i,prop:e.prop,label:e.label,width:e.width,\"show-overflow-tooltip\":\"\"},scopedSlots:t._u([{key:\"default\",fn:function(i){return[\"dealStatus\"==e.prop?[s(\"i\",{class:t._f(\"dealIcon\")(i.row[e.prop])}),t._v(\" \"),s(\"span\",[t._v(t._s(t._f(\"dealName\")(i.row[e.prop])))])]:\"status\"==e.prop?[2==i.row.status?s(\"i\",{staticClass:\"wk wk-circle-password customer-lock\"}):t._e()]:\"checkStatus\"==e.prop?[s(\"span\",{staticClass:\"status-mark\",style:{backgroundColor:t.getStatusColor(i.row.checkStatus)}}),t._v(\" \"),s(\"span\",[t._v(t._s(t.getStatusName(i.row.checkStatus)))])]:[t._v(t._s(t.fieldFormatter(i.row,i.column)))]]}}])})}),t._v(\" \"),t.showFillColumn?s(\"el-table-column\"):t._e()],2),t._v(\" \"),t.paging?s(\"div\",{staticClass:\"p-contianer\"},[s(\"el-pagination\",{staticClass:\"p-bar\",attrs:{\"current-page\":t.currentPage,\"page-sizes\":t.pageSizes,\"page-size\":t.pageSize,total:t.total,background:\"\",layout:\"prev, pager, next, sizes, total, jumper\"},on:{\"update:pageSize\":function(e){t.pageSize=e},\"size-change\":t.handleSizeChange,\"current-change\":t.handleCurrentChange}})],1):t._e()],1)]),t._v(\" \"),s(\"c-r-m-all-detail\",{staticClass:\"d-view\",attrs:{visible:t.showDview,\"crm-type\":t.rowType,id:t.rowID},on:{\"update:visible\":function(e){t.showDview=e},handle:t.handleHandle}}),t._v(\" \"),t.recordShow?s(\"record-list\",{attrs:{\"crm-type\":t.rowType,request:t.recordRequest,params:t.recordParams},on:{handle:t.getList,hide:function(e){t.recordShow=!1}}}):t._e()],1)])},[],!1,null,\"a44b35be\",null);f.options.__file=\"index.vue\";e.default=f.exports},\"La+m\":function(t,e,s){},MdnP:function(t,e,s){\"use strict\";var i={name:\"PictureListView\",props:{list:{type:Array,required:!0}},methods:{imgZoom:function(t,e){this.$bus.emit(\"preview-image-bus\",{index:e,data:t.map(function(t,e,s){return{url:t.filePath||t.url,name:t.name}})})}}},a=(s(\"IJOA\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"picture-list-view\"},t._l(t.list,function(e,a){return i(\"div\",{key:a,staticClass:\"img-list-item\",on:{click:function(e){t.imgZoom(t.list,a)}}},[i(\"img\",{directives:[{name:\"src\",rawName:\"v-src\",value:e.filePath||e.url,expression:\"imgItem.filePath || imgItem.url\"}],key:e.filePath||e.url,attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"'}})])}))},[],!1,null,\"29b203af\",null);n.options.__file=\"PictureListView.vue\";e.a=n.exports},NYF1:function(t,e,s){\"use strict\";var i={name:\"AddRelateList\",components:{},props:{data:Array,type:{type:[String,Number],require:!0},label:String},data:function(){return{}},computed:{typeName:function(){return this.label?this.label:{customer:\"客户\",contacts:\"联系人\",business:\"商机\",contract:\"合同\"}[this.type]}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{getItemName:function(t){return t[{customer:\"customerName\",contacts:\"name\",business:\"businessName\",contract:\"name\"}[this.type]]||t.name},deleteItem:function(t,e){this.$emit(\"delete\",t,e,this.type)}}},a=(s(\"s357\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"section\",{staticClass:\"c-cont\"},[s(\"flexbox\",{staticClass:\"c-header\"},[s(\"i\",{class:[\"wk\",\"wk-\"+t.type]}),t._v(\" \"),s(\"div\",{staticClass:\"c-name\"},[t._v(t._s(t.typeName))])]),t._v(\" \"),s(\"div\",{staticClass:\"c-body\"},[s(\"flexbox\",{attrs:{wrap:\"wrap\"}},t._l(t.data,function(e,i){return s(\"flexbox\",{key:i,staticClass:\"c-item\"},[s(\"div\",{staticClass:\"c-item-name\"},[t._v(t._s(t.getItemName(e)))]),t._v(\" \"),s(\"div\",{staticClass:\"c-item-close\",on:{click:function(s){t.deleteItem(e,i)}}},[t._v(\"×\")])])}))],1)],1)},[],!1,null,\"60fd2091\",null);n.options.__file=\"AddRelateList.vue\";e.a=n.exports},Nbko:function(t,e,s){\"use strict\";var i=s(\"La+m\");s.n(i).a},O8VQ:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"4XAY\"),o=s(\"Vm8M\"),c=s(\"7Qib\"),l=s(\"Z+Ht\"),r=s(\"vvxI\"),u=s(\"L2JU\"),d={name:\"LogCell\",components:{MapView:o.a},filters:{getFileSize:function(t){return Object(c.h)(t)}},mixins:[l.a,r.default],props:{item:{type:Object,default:function(){return{}}},section:[String,Number],index:[String,Number],canDelete:{type:Boolean,default:!0}},data:function(){return{showMapView:!1,mapViewInfo:{}}},computed:a()({},Object(u.b)([\"crm\"]),{hasEditAuth:function(){return this.crm&&this.crm.followRecord&&this.crm.followRecord.update},hasDeleteAuth:function(){return this.crm&&this.crm.followRecord&&this.crm.followRecord.delete},activityIcon:function(){return this.getXrIcon(this.getActivityType(this.item.activityType))},activityIconColor:function(){return this.getXrIconColor(this.getActivityType(this.item.activityType))}}),mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit(\"preview-image-bus\",{index:e,data:t})},downloadFile:function(t){Object(c.d)({path:t.url,name:t.name})},handleCommand:function(t){var e=this;\"delete\"==t?this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){(4==e.item.type?n.d:n.b)({activityId:e.item.activityId}).then(function(t){e.$emit(\"delete\",e.item,e.index,e.section),e.$store.dispatch(\"GetMessageNum\"),e.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){}):\"edit\"==t&&this.$emit(\"edit\",this.item,this.index,this.section)},checkRelationDetail:function(t,e){this.$emit(\"crm-detail\",t,e)},checkMapView:function(t){t.address&&(this.mapViewInfo={title:t.address,lat:t.lat,lng:t.lng},this.showMapView=!0)}}},h=(s(\"3Qrg\"),s(\"KHd+\")),p=Object(h.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"fl-c\"},[s(\"flexbox\",{staticClass:\"fl-h\"},[s(\"xr-avatar\",{staticClass:\"fl-h-img\",attrs:{name:t.item.realname,id:t.item.createUserId,size:30,src:t.item.userImg,disabled:!1}}),t._v(\" \"),s(\"div\",{staticClass:\"fl-h-b\"},[s(\"div\",{staticClass:\"fl-h-name\"},[t._v(t._s(t.item.realname))]),t._v(\" \"),s(\"div\",{staticClass:\"fl-h-time\"},[t._v(t._s(t.item.createTime))])]),t._v(\" \"),t.item.category?s(\"div\",{staticClass:\"follow\"},[s(\"span\",{staticClass:\"follow-info\"},[t._v(t._s(t.item.category))])]):t._e(),t._v(\" \"),s(\"span\",{staticClass:\"log-mark\",style:{right:t.canDelete?\"40px\":\"15px\"}},[s(\"i\",{class:t.activityIcon,style:{color:t.activityIconColor}}),t._v(\" \"),s(\"span\",{staticClass:\"log-mark__label\"},[t._v(t._s(t.getActivityTypeName(t.item.activityType)+\"-\"+t.getRecordLogTypeName(t.item.type)))])]),t._v(\" \"),t.canDelete&&(t.hasDeleteAuth||t.hasEditAuth)?s(\"el-dropdown\",{staticClass:\"more-drop\",attrs:{trigger:\"click\"},on:{command:t.handleCommand}},[s(\"i\",{staticClass:\"el-icon-arrow-down el-icon-more\"}),t._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[t.hasEditAuth?s(\"el-dropdown-item\",{attrs:{command:\"edit\"}},[t._v(\"编辑\")]):t._e(),t._v(\" \"),t.hasDeleteAuth?s(\"el-dropdown-item\",{attrs:{command:\"delete\"}},[t._v(\"删除\")]):t._e()],1)],1):t._e()],1),t._v(\" \"),s(\"div\",{staticClass:\"fl-b\"},[s(\"div\",{staticClass:\"fl-b-content\"},[t._v(t._s(t.item.content))]),t._v(\" \"),t.item.img&&t.item.img.length>0?s(\"flexbox\",{staticClass:\"fl-b-images\",attrs:{wrap:\"wrap\"}},t._l(t.item.img,function(e,i){return s(\"div\",{directives:[{name:\"src\",rawName:\"v-src:background-image\",value:e.url,expression:\"file.url\",arg:\"background-image\"}],key:e.url,staticClass:\"fl-b-img-item\",on:{click:function(e){t.previewImg(t.item.img,i)}}})})):t._e(),t._v(\" \"),t.item.file&&t.item.file.length>0?s(\"div\",t._l(t.item.file,function(e,i){return s(\"flexbox\",{key:i,staticClass:\"cell\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"cell-hd first-show\"},[s(\"i\",{staticClass:\"wk wk-file\"})]),t._v(\" \"),s(\"div\",{staticClass:\"cell-hd first-show\"},[t._v(\"\\n          附件：\\n        \")]),t._v(\" \"),s(\"div\",{staticClass:\"cell-bd text-one-line\"},[t._v(\"\\n          \"+t._s(e.name)+\"\\n        \")]),t._v(\" \"),s(\"div\",{staticClass:\"cell-ft\"},[s(\"span\",{staticClass:\"des\"},[t._v(\"（\"+t._s(t._f(\"getFileSize\")(e.size))+\"）\")]),t._v(\" \"),s(\"a\",{on:{click:function(e){t.previewImg(t.item.file,i)}}},[t._v(\"预览\")]),t._v(\" \"),s(\"a\",{on:{click:function(s){t.downloadFile(e)}}},[t._v(\"下载\")])])])})):t._e(),t._v(\" \"),t.item.contactsList&&t.item.contactsList.length>0?s(\"div\",[s(\"flexbox\",{staticClass:\"cell\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"cell-hd\"},[s(\"i\",{staticClass:\"wk wk-contacts\"})]),t._v(\" \"),s(\"div\",{staticClass:\"cell-bd\"},[t._v(\"\\n          相关联系人：\\n        \")]),t._v(\" \"),t._l(t.item.contactsList,function(e,i){return s(\"div\",{key:i,staticClass:\"cell-ft__item text-one-line\"},[s(\"a\",{on:{click:function(s){t.checkRelationDetail(\"contacts\",e.id)}}},[t._v(t._s(e.name))])])})],2)],1):t._e(),t._v(\" \"),t.item.businessList&&t.item.businessList.length>0?s(\"div\",[s(\"flexbox\",{staticClass:\"cell\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"cell-hd\"},[s(\"i\",{staticClass:\"wk wk-business\"})]),t._v(\" \"),s(\"div\",{staticClass:\"cell-bd\"},[t._v(\"\\n          相关商机：\\n        \")]),t._v(\" \"),s(\"div\",{staticClass:\"cell-ft\"},t._l(t.item.businessList,function(e,i){return s(\"div\",{key:i,staticClass:\"cell-ft__item text-one-line\"},[s(\"a\",{on:{click:function(s){t.checkRelationDetail(\"business\",e.id)}}},[t._v(t._s(e.name))])])}))])],1):t._e(),t._v(\" \"),t.item.nextTime?s(\"div\",{staticClass:\"cell-top\"},[s(\"flexbox\",{staticClass:\"cell\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"cell-hd\"},[s(\"i\",{staticClass:\"wk wk-time\"})]),t._v(\" \"),s(\"div\",{staticClass:\"cell-bd text-one-line\"},[t._v(\"\\n          下次联系时间：\"+t._s(t.item.nextTime)+\"\\n        \")])])],1):t._e(),t._v(\" \"),t.item.address?s(\"div\",{staticClass:\"cell-top\"},[s(\"flexbox\",{staticClass:\"cell\",attrs:{align:\"stretch\"}},[s(\"div\",{staticClass:\"cell-hd is-address\"},[s(\"i\",{staticClass:\"wk wk-location\"})]),t._v(\" \"),s(\"div\",{staticClass:\"cell-bd text-one-line can-visit--underline\",on:{click:function(e){t.checkMapView(t.item)}}},[t._v(t._s(t.item.address))])])],1):t._e()],1),t._v(\" \"),t.showMapView?s(\"map-view\",{attrs:{title:t.mapViewInfo.title,lat:t.mapViewInfo.lat,lng:t.mapViewInfo.lng},on:{hidden:function(e){t.showMapView=!1}}}):t._e(),t._v(\" \"),t._t(\"default\")],2)},[],!1,null,\"99f77bf4\",null);p.options.__file=\"LogCell.vue\";e.default=p.exports},OM3V:function(t,e,s){},OWIW:function(t,e,s){\"use strict\";var i=s(\"gWfY\");s.n(i).a},OdVz:function(t,e,s){\"use strict\";var i=s(\"VlxE\");s.n(i).a},PAIM:function(t,e,s){\"use strict\";s.r(e);var i={props:{editTagList:Array},data:function(){return{searchInput:\"\"}},computed:{list:function(){var t=this;return this.editTagList.filter(function(e){return e.name.indexOf(t.searchInput)>-1})}},watch:{},methods:{back:function(){this.$emit(\"back\")},close:function(){this.$emit(\"close\")},deleteBtn:function(t){this.$emit(\"deleteBtn\",t)},editBtn:function(t){this.$emit(\"editBtn\",t)}}},a=(s(\"936R\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"edit-tag-dialog\"},[s(\"div\",{staticClass:\"title\"},[s(\"span\",{staticClass:\"el-icon-arrow-left\",on:{click:t.back}}),t._v(\" \"),s(\"span\",[t._v(\"标签管理\")]),t._v(\" \"),s(\"span\",{staticClass:\"el-icon-close rt\",on:{click:t.close}})]),t._v(\" \"),s(\"div\",{staticClass:\"search\"},[s(\"el-input\",{attrs:{maxlength:10,size:\"mini\",placeholder:\"输入标签名，最多十个字符\"},model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:\"searchInput\"}})],1),t._v(\" \"),s(\"div\",{staticClass:\"content\"},t._l(t.list,function(e,i){return s(\"div\",{key:i,staticClass:\"tag-list\"},[s(\"span\",{staticClass:\"tag-name\",style:{background:e.color?e.color:\"#ccc\"}},[t._v(\"\\n        \"+t._s(e.name.length>10?e.name.substring(0,10)+\"...\":e.name)+\"\\n      \")]),t._v(\" \"),s(\"div\",{staticClass:\"rt\"},[s(\"span\",{staticClass:\"el-icon-edit\",on:{click:function(s){t.editBtn(e)}}}),t._v(\" \"),s(\"span\",{staticClass:\"el-icon-delete\",on:{click:function(s){t.deleteBtn(e)}}})])])}))])},[],!1,null,\"d1e776f2\",null);n.options.__file=\"EditTag.vue\";e.default=n.exports},PWYh:function(t,e,s){},PdhK:function(t,e,s){\"use strict\";var i=s(\"Cbuk\");s.n(i).a},QSP8:function(t,e,s){\"use strict\";var i=s(\"WWx0\");s.n(i).a},REO3:function(t,e,s){\"use strict\";var i=s(\"cOW0\");s.n(i).a},Rq8O:function(t,e,s){},Rw8k:function(t,e,s){},TDiV:function(t,e,s){},U63j:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"FoeY\"),o=s(\"Ew9n\"),c=s(\"jM2j\"),l=s(\"L2JU\"),r={name:\"NoticeDetail\",components:{SlideView:o.a,NewDialog:c.default},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return[\"el-table__body\"]}}},data:function(){return{loading:!1,detail:null,announcementAddShow:!1}},computed:a()({},Object(l.b)([\"allAuth\"]),{permissionUpdate:function(){return this.allAuth&&this.allAuth.manage&&this.allAuth.manage.notice&&this.allAuth.manage.notice.update},permissionDelete:function(){return this.allAuth&&this.allAuth.manage&&this.allAuth.manage.notice&&this.allAuth.manage.notice.delete},moreTypes:function(){var t=[];return this.permissionUpdate&&t.push({type:\"edit\",name:\"编辑\",icon:\"edit\"}),this.permissionDelete&&t.push({type:\"delete\",name:\"删除\",icon:\"delete\"}),t}}),watch:{id:function(t){this.detail=null,this.getDetail()}},mounted:function(){this.getDetail()},beforeDestroy:function(){},methods:{getDetail:function(){var t=this;this.loading=!0,Object(n.e)(this.id).then(function(e){t.detail=e.data,t.loading=!1}).catch(function(){t.loading=!1,t.hideView()})},handleTypeDrop:function(t){\"delete\"==t?this.deleteDetail():this.announcementAddShow=!0},deleteDetail:function(){var t=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(n.b)(t.id).then(function(e){t.$emit(\"delete\"),t.$message({type:\"success\",message:\"删除成功!\"}),t.hideView()}).catch(function(){})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},hideView:function(){this.$emit(\"close\"),this.$emit(\"hide-view\")}}},u=(s(\"1Xy/\"),s(\"KHd+\")),d=Object(u.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"slide-view\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"d-view\",attrs:{\"no-listener-class\":t.noListenerClass,\"body-style\":{padding:0,height:\"100%\"},\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"},on:{close:t.hideView}},[t.detail?s(\"div\",{staticClass:\"main\",attrs:{direction:\"column\",align:\"stretch\"}},[s(\"flexbox\",{staticClass:\"detail-header\"},[s(\"div\",{staticClass:\"header-icon\"},[s(\"i\",{staticClass:\"wk wk-log\"})]),t._v(\" \"),s(\"div\",{staticClass:\"header-name\"},[t._v(\"公告\")]),t._v(\" \"),t.moreTypes.length>0?s(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:t.handleTypeDrop}},[s(\"el-button\",{attrs:{icon:\"el-icon-more\"}}),t._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},t._l(t.moreTypes,function(e,i){return s(\"el-dropdown-item\",{key:i,attrs:{icon:t._f(\"wkIconPre\")(e.icon),command:e.type}},[t._v(t._s(e.name))])}))],1):t._e()],1),t._v(\" \"),s(\"div\",{staticClass:\"detail-title\"},[t._v(t._s(t.detail.title))]),t._v(\" \"),s(\"div\",{staticClass:\"detail-time\"},[t._v(t._s(t.detail.updateTime))]),t._v(\" \"),s(\"div\",{staticClass:\"main__bd\"},[t._v(t._s(t.detail.content))])],1):t._e(),t._v(\" \"),t.announcementAddShow?s(\"new-dialog\",{attrs:{action:{type:\"update\",id:t.id,data:t.detail}},on:{onSubmit:t.getDetail,close:function(e){t.announcementAddShow=!1}}}):t._e()],1)},[],!1,null,\"f2b96c32\",null);d.options.__file=\"NoticeDetail.vue\";e.default=d.exports},\"Vf/o\":function(t,e,s){\"use strict\";s.r(e);var i={props:{newTagTitle:String,newTagInput:String,bgColorProps:String},data:function(){return{colorList:[\"#53D397\",\"#20C1BD\",\"#58DADA\",\"#0FC9E7\",\"#3498DB\",\"#4586FF\",\"#8983F3\",\"#AEA1EA\",\"#FF6699\",\"#F24D70\",\"#FF6F6F\"],input:this.newTagInput,showBgColor:\"\"}},watch:{bgColorProps:function(t){this.showBgColor=t||\"#53D397\"}},mounted:function(){this.showBgColor=this.bgColorProps||\"#53D397\"},methods:{back:function(){this.$emit(\"back\")},close:function(){this.$emit(\"close\")},changeColor:function(t){this.$emit(\"changeColor\",t)},tagCreateSubmit:function(){this.$emit(\"tagCreateSubmit\",this.input,this.showBgColor)},tagCancel:function(){this.$emit(\"tagCancel\")}}},a=(s(\"OWIW\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"new-tag-dialog\"},[s(\"div\",{staticClass:\"title\"},[s(\"span\",{staticClass:\"el-icon-arrow-left\",on:{click:t.back}}),t._v(\" \"),s(\"span\",[t._v(t._s(t.newTagTitle))]),t._v(\" \"),s(\"span\",{staticClass:\"el-icon-close rt\",on:{click:t.close}})]),t._v(\" \"),s(\"div\",{staticClass:\"search\"},[s(\"el-input\",{attrs:{maxlength:10,size:\"mini\",placeholder:\"输入标签名，最多十个字符\"},model:{value:t.input,callback:function(e){t.input=e},expression:\"input\"}}),t._v(\" \"),s(\"span\",{staticClass:\"checked-color\",style:{background:t.showBgColor}})],1),t._v(\" \"),s(\"div\",{staticClass:\"color-box\"},t._l(t.colorList,function(e,i){return s(\"span\",{key:i,style:{background:e},on:{click:function(s){t.changeColor(e)}}})})),t._v(\" \"),s(\"div\",{staticClass:\"footer\"},[s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.tagCreateSubmit,expression:\"tagCreateSubmit\"}],attrs:{type:\"primary\",size:\"medium\"}},[t._v(\"保存\")]),t._v(\" \"),s(\"el-button\",{attrs:{size:\"medium\"},on:{click:t.tagCancel}},[t._v(\"取消\")])],1)])},[],!1,null,\"2756a05c\",null);n.options.__file=\"NewTag.vue\";e.default=n.exports},VlxE:function(t,e,s){},Vm8M:function(t,e,s){\"use strict\";var i=s(\"7Qib\"),a={name:\"MapView\",components:{},props:{title:{type:String,default:\"\"},lat:{type:[String,Number],default:0},lng:{type:[String,Number],default:0}},data:function(){return{}},computed:{},mounted:function(){var t=this;this.$el.style.zIndex=Object(i.q)(),document.body.appendChild(this.$el),Object(i.l)().then(function(){var e=new BMap.Map(\"choicemap\",{enableMapClick:!1}),s=new BMap.Point(parseFloat(t.lng),parseFloat(t.lat));e.centerAndZoom(s,18),e.enableScrollWheelZoom();var i=new BMap.Marker(s);e.addOverlay(i);var a=new BMap.InfoWindow(t.title);i.addEventListener(\"click\",function(){e.openInfoWindow(a,s)})})},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit(\"hidden\")}}},n=(s(\"I+NK\"),s(\"KHd+\")),o=Object(n.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",{staticClass:\"map-view\"},[e(\"div\",{attrs:{id:\"choicemap\"}}),this._v(\" \"),e(\"i\",{staticClass:\"el-icon-close map-close\",on:{click:this.hiddenView}})])},[],!1,null,\"33a9f6bf\",null);o.options.__file=\"MapView.vue\";e.a=o.exports},VmBU:function(t,e,s){\"use strict\";s.d(e,\"e\",function(){return a}),s.d(e,\"a\",function(){return n}),s.d(e,\"c\",function(){return o}),s.d(e,\"b\",function(){return c}),s.d(e,\"j\",function(){return l}),s.d(e,\"h\",function(){return r}),s.d(e,\"f\",function(){return u}),s.d(e,\"g\",function(){return d}),s.d(e,\"i\",function(){return h}),s.d(e,\"d\",function(){return p}),s.d(e,\"m\",function(){return m}),s.d(e,\"l\",function(){return f}),s.d(e,\"k\",function(){return v}),s.d(e,\"n\",function(){return g});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"oaLog/queryList\",method:\"post\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"},data:t})}function n(t){return Object(i.a)({url:\"oaLog/addOrUpdate\",method:\"post\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"},data:t})}function o(t){return Object(i.a)({url:\"oaLog/addOrUpdate\",method:\"post\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"},data:t})}function c(t){return Object(i.a)({url:\"oaLog/deleteById\",method:\"post\",data:t})}function l(t){return Object(i.a)({url:\"oaLog/readLog\",method:\"post\",data:t})}function r(t){return Object(i.a)({url:\"oaLog/queryById\",method:\"post\",data:t})}function u(t){return Object(i.a)({url:\"oaLog/queryLogBulletin\",method:\"post\",data:t})}function d(t){return Object(i.a)({url:\"oaLog/queryLogBulletinByType\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function h(t){return Object(i.a)({url:\"oaLog/queryLogRecordCount\",method:\"post\",data:t})}function p(t){return Object(i.a)({url:\"oaLog/getLogWelcomeSpeech\",method:\"post\",data:t})}function m(t){return Object(i.a)({url:\"oaLog/export\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"},responseType:\"blob\"})}function f(t){return Object(i.a)({url:\"oaLog/queryCompleteStats\",method:\"post\",data:t})}function v(t){return Object(i.a)({url:\"oaLog/queryCompleteOaLogList\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function g(t){return Object(i.a)({url:\"oaLog/queryIncompleteOaLogList\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}},WWx0:function(t,e,s){},XFCB:function(t,e,s){},YIeP:function(t,e,s){\"use strict\";var i=s(\"4XAY\"),a=s(\"XJYT\"),n=s(\"t2rG\"),o={name:\"Set\",components:{draggable:s.n(n).a},props:{visible:{type:Boolean,required:!0,default:!1},list:Array},data:function(){return{setList:[],isDrag:!1}},computed:{},watch:{list:{handler:function(){this.initInfo()},immediate:!0},visible:function(t){t&&this.initInfo()}},created:function(){},beforeDestroy:function(){},methods:{initInfo:function(){this.setList=this.list.map(function(t){return{value:t}}),0==this.setList.length&&(this.setList=[{value:\"\"}])},close:function(){this.$emit(\"update:visible\",!1)},addClick:function(){this.setList.push({value:\"\"})},deleteClick:function(t){this.setList.splice(t,1)},sureClick:function(){for(var t=this,e=[],s=0;s<this.setList.length;s++){var n=this.setList[s];n.value&&e.push(n.value)}if(0!=e.length){var o=a.Loading.service({target:document.querySelector('.el-dialog[aria-label=\"常用语管理\"]')});Object(i.G)(e).then(function(s){o.close(),t.$emit(\"update\",e),t.close()}).catch(function(){o.close()})}else this.$message.error(\"请输入常用语\")},dragEnter:function(){this.isDrag=!0},dragLeave:function(){this.isDrag=!1}}},c=(s(\"nD2f\"),s(\"KHd+\")),l=Object(c.a)(o,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-dialog\",{attrs:{visible:t.visible,\"append-to-body\":!0,\"close-on-click-modal\":!1,title:\"常用语管理\",width:\"600px\"},on:{close:t.close}},[s(\"div\",{staticClass:\"set\"},[s(\"draggable\",{attrs:{options:{group:\"list\",forceFallback:!1,fallbackClass:\"draggingStyle\",filter:\".el-input__inner\",preventOnFilter:!1}},model:{value:t.setList,callback:function(e){t.setList=e},expression:\"setList\"}},t._l(t.setList,function(e,i){return s(\"flexbox\",{key:i,staticClass:\"set-item\",class:{\"is-drag\":t.isDrag}},[s(\"el-input\",{attrs:{maxlength:100},model:{value:e.value,callback:function(s){t.$set(e,\"value\",s)},expression:\"item.value\"}},[s(\"div\",{staticClass:\"drag-handle\",attrs:{slot:\"suffix\"},on:{mouseenter:t.dragEnter,mouseleave:t.dragLeave},slot:\"suffix\"},[t._v(\"⋮⋮\")])]),t._v(\" \"),s(\"i\",{staticClass:\"el-icon-remove\",on:{click:function(e){t.deleteClick(i)}}})],1)})),t._v(\" \"),s(\"el-button\",{attrs:{type:\"text\",icon:\"el-icon-circle-plus\"},on:{click:t.addClick}},[t._v(\"添加常用语\")])],1),t._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.sureClick,expression:\"sureClick\"}],attrs:{type:\"primary\"}},[t._v(\"保存\")])],1)])},[],!1,null,\"1a59f706\",null);l.options.__file=\"Set.vue\";var r={name:\"CommonWords\",components:{Set:l.exports},props:{},data:function(){return{loading:!1,showPopover:!1,setShow:!1,list:[]}},computed:{},watch:{showPopover:function(t){t&&0==this.list.length&&this.getCommonWords()}},mounted:function(){},beforeDestroy:function(){},methods:{selectScene:function(t,e){this.$emit(\"select\",t),this.showPopover=!1},setClick:function(){this.setShow=!0},getCommonWords:function(){var t=this;this.loading=!0,Object(i.F)().then(function(e){t.loading=!1,t.list=e.data||[]}).catch(function(){t.loading=!1})},udpateCommonWords:function(t){this.list=t}}},u=(s(\"q0fG\"),Object(c.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-popover\",{attrs:{placement:\"bottom\",width:\"320\",trigger:\"click\",\"popper-class\":\"no-padding-popover\"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:\"showPopover\"}},[s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"common-words\"},[s(\"div\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:t.list&&0==t.list.length,expression:\"list && list.length == 0\"}],staticClass:\"word\",attrs:{\"xs-empty-icon\":\"none\"}},t._l(t.list,function(e,i){return s(\"div\",{key:i,staticClass:\"word-item\",on:{click:function(s){t.selectScene(e,i)}}},[t._v(\"\\n        \"+t._s(e)+\"\\n      \")])})),t._v(\" \"),s(\"div\",{staticClass:\"handle-interval\"},[s(\"flexbox\",{staticClass:\"handle-button\",nativeOn:{click:function(e){return t.setClick(e)}}},[s(\"i\",{staticClass:\"wk wk-manage handle-button-icon\"}),t._v(\" \"),s(\"div\",{staticClass:\"handle-button-name\"},[t._v(\"管理\")])])],1)]),t._v(\" \"),s(\"el-button\",{staticClass:\"word-button\",attrs:{slot:\"reference\"},slot:\"reference\"},[t._v(\"常用语\")]),t._v(\" \"),s(\"set\",{attrs:{visible:t.setShow,list:t.list},on:{\"update:visible\":function(e){t.setShow=e},update:t.udpateCommonWords}})],1)},[],!1,null,\"6ddd3652\",null));u.options.__file=\"index.vue\";e.a=u.exports},\"Z+Ht\":function(t,e,s){\"use strict\";e.a={methods:{getXrIcon:function(t){return{leads:\"wk wk-leads\",customer:\"wk wk-customer\",contacts:\"wk wk-contacts\",product:\"wk wk-product\",business:\"wk wk-business\",contract:\"wk wk-contract\",receivables:\"wk wk-receivables\",invoice:\"wk wk-invoice\",log:\"wk wk-log\",examine:\"wk wk-approve\",task:\"wk wk-o-task\",record:\"wk wk-record\"}[t]},getXrIconColor:function(t){return{leads:\"#704afd\",customer:\"#487DFF\",contacts:\"#27BA4A\",product:\"#26d4da\",business:\"#FB9323\",contract:\"#FD5B4A\",receivables:\"#FFB940\",invoice:\"#1cbaf5\",log:\"#5864FF\",approve:\"#9376FF\",task:\"#D376FF\",record:\"#19B5F6\"}[t]}}}},\"Z/5k\":function(t,e,s){\"use strict\";var i=s(\"u2Af\");s.n(i).a},ZX9L:function(t,e,s){\"use strict\";var i={name:\"TimeTypeSelect\",props:{defaultType:[String,Object],width:{type:Number,default:200},options:{type:Array,default:function(){return[{label:\"今天\",value:\"today\"},{label:\"昨天\",value:\"yesterday\"},{label:\"本周\",value:\"week\"},{label:\"上周\",value:\"lastWeek\"},{label:\"本月\",value:\"month\"},{label:\"上月\",value:\"lastMonth\"},{label:\"本季度\",value:\"quarter\"},{label:\"上季度\",value:\"lastQuarter\"},{label:\"本年\",value:\"year\"},{label:\"去年\",value:\"lastYear\"}]}}},data:function(){return{selectType:{label:\"本年\",value:\"year\"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:\"\",endTime:\"\"}},computed:{typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||\"\")+\"-\"+(this.endTime||\"\"):\"\":this.selectType.label}},watch:{defaultType:function(){this.selectType.value!=this.defaultType&&(this.selectType=this.getDefaultTypeValue(this.defaultType))}},mounted:function(){void 0!==this.defaultType?\"string\"==typeof this.defaultType?this.selectType=this.getDefaultTypeValue(this.defaultType):this.defaultType.label?this.selectType=this.defaultType:\"default\"==this.defaultType.type?this.selectType=this.getDefaultTypeValue(this.defaultType.value):\"custom\"==this.defaultType.type&&(this.sureCustomContent=!0,this.showCustomContent=!0,this.startTime=this.defaultType.startTime,this.endTime=this.defaultType.endTime):this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},methods:{getDefaultTypeValue:function(t){for(var e=0;e<this.options.length;e++){var s=this.options[e];if(s.value==t)return s}return{label:\"本年\",value:\"year\"}},typeSelectClick:function(t){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=t,this.$emit(\"change\",{type:\"default\",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit(\"change\",{type:\"custom\",startTime:this.startTime,endTime:this.endTime}))}}},a=(s(\"77fj\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"el-popover\",{staticClass:\"time-type-select\",attrs:{width:t.width,placement:\"bottom\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showTypePopover,callback:function(e){t.showTypePopover=e},expression:\"showTypePopover\"}},[s(\"div\",{staticClass:\"type-popper\"},[s(\"div\",{staticClass:\"type-content\"},[t._l(t.options,function(e,i){return s(\"div\",{key:i,staticClass:\"type-content-item\",class:{selected:t.selectType.value==e.value&&!t.showCustomContent},on:{click:function(s){t.typeSelectClick(e)}}},[s(\"div\",{staticClass:\"mark\"}),t._v(t._s(e.label)+\"\\n      \")])}),t._v(\" \"),s(\"div\",{staticClass:\"type-content-item\",class:{selected:t.showCustomContent},on:{click:function(e){t.showCustomContent=!0}}},[s(\"div\",{staticClass:\"mark\"}),t._v(\"自定义\\n      \")])],2),t._v(\" \"),t.showCustomContent?s(\"div\",{staticClass:\"type-content-custom\"},[s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:\"startTime\"}}),t._v(\" \"),s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy.MM.dd\",placeholder:\"选择日期\"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:\"endTime\"}}),t._v(\" \"),s(\"el-button\",{on:{click:t.customSureClick}},[t._v(\"确定\")])],1):t._e()]),t._v(\" \"),s(\"el-input\",{staticClass:\"type-select\",style:{width:t.width+\"px\"},attrs:{slot:\"reference\",readonly:!0},slot:\"reference\",model:{value:t.typeShowValue,callback:function(e){t.typeShowValue=e},expression:\"typeShowValue\"}},[s(\"i\",{class:[\"el-icon-arrow-up\",{\"is-reverse\":t.showTypePopover}],attrs:{slot:\"suffix\"},slot:\"suffix\"})])],1)},[],!1,null,\"20503202\",null);n.options.__file=\"index.vue\";e.a=n.exports},ZZgR:function(t,e,s){},cEue:function(t,e,s){t.exports=s.p+\"static/img/delete_task.96cc063.png\"},cFwc:function(t,e,s){},cOW0:function(t,e,s){},cZgO:function(t,e,s){\"use strict\";var i=s(\"ZZgR\");s.n(i).a},d5Rn:function(t,e,s){},dPzk:function(t,e,s){\"use strict\";var i=s(\"Xjjk\"),a=s.n(i),n={name:\"ReplyComment\",components:{Emoji:s(\"u+Mw\").a},data:function(){return{commentLoading:!1,blurIndex:0,commentsTextarea:\"\",showEmoji:!1,showNoFocus:!1}},methods:{blurFun:function(t){this.blurIndex=t.target.selectionEnd},selectEmoji:function(t){if(this.commentsTextarea&&this.commentsTextarea.length+t.length<=2e3||!this.commentsTextarea){var e=this.commentsTextarea.split(\"\");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(\"\"),this.showEmoji=!1}},commentSubmit:function(){this.commentsTextarea?this.$emit(\"reply\",a()(this.commentsTextarea)):this.$message.error(\"回复内容不能为空\")},closeComment:function(){this.showEmoji=!1,this.$emit(\"close\"),this.toggleFocus()},toggleFocus:function(t){this.showNoFocus=\"boolean\"==typeof t?t:!this.showNoFocus,this.$emit(\"toggle\",this.showNoFocus)}}},o=(s(\"szeO\"),s(\"KHd+\")),c=Object(o.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.commentLoading,expression:\"commentLoading\"}],staticClass:\"reply-comment\"},[t.showNoFocus?s(\"div\",{staticClass:\"no-focus\",on:{click:function(e){t.toggleFocus()}}},[t._v(\"\\n    请输入回复内容\\n  \")]):[s(\"el-input\",{attrs:{rows:3,maxlength:2e3,\"show-word-limit\":\"\",type:\"textarea\",placeholder:\"请输入回复内容\"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:\"commentsTextarea\"}}),t._v(\" \"),s(\"div\",{staticClass:\"btn-group\"},[s(\"el-popover\",{attrs:{placement:\"top\",width:\"400\",trigger:\"click\"},model:{value:t.showEmoji,callback:function(e){t.showEmoji=e},expression:\"showEmoji\"}},[s(\"emoji\",{on:{select:t.selectEmoji}}),t._v(\" \"),s(\"i\",{staticClass:\"wk wk-expression smiling-img\",attrs:{slot:\"reference\"},slot:\"reference\"})],1),t._v(\" \"),s(\"div\",{staticClass:\"btn-box\"},[s(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.commentSubmit}},[t._v(\"回复\")]),t._v(\" \"),s(\"el-button\",{on:{click:t.closeComment}},[t._v(\"取消\")])],1)],1)]],2)},[],!1,null,\"cdcf716e\",null);c.options.__file=\"ReplyComment.vue\";e.a=c.exports},\"dow+\":function(t,e,s){},eOwn:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"7Dod\"),o=s(\"6iAj\"),c=s(\"4XAY\"),l=s(\"giPm\"),r=s(\"O8VQ\"),u=s(\"/G0b\"),d=s(\"8OTK\"),h=s(\"C3Po\"),p=s(\"ZoMv\"),m=s(\"7Qib\"),f=s(\"Z+Ht\"),v=s(\"vvxI\"),g=s(\"ZX9L\"),b=s(\"ehos\"),k=s(\"L2JU\"),y={name:\"Activity\",components:{LogAdd:l.default,LogCell:r.default,CRMAllCreate:d.default,TaskQuickAdd:h.default,TimeTypeSelect:g.a,LogEditDialog:u.default,CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-66f9\"),s.e(\"chunk-63bb\"),s.e(\"chunk-7029\"),s.e(\"chunk-0aaf\"),s.e(\"chunk-24c6\")]).then(s.bind(null,\"3z7q\"))}},mixins:[f.a,v.default],props:{handle:{type:Array,default:function(){return[]}},id:[String,Number],contactsId:[String,Number],crmType:{type:String,default:\"\"},isSeas:{type:Boolean,default:!1},typeList:{type:Array,default:function(){return[]}},detail:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,filterValue:{},timeOptions:[{label:\"全部\",value:\"\"},{label:\"最近7天\",value:\"7\"},{label:\"最近30天\",value:\"30\"},{label:\"最近60天\",value:\"60\"}],contacts:[],followTypes:[],handleType:\"\",activityType:{icon:\"all\",color:\"#2362FB\",command:\"\",label:\"全部活动\"},list:[],noMore:!1,page:1,isCRMCreate:!1,createActionInfo:{type:\"relative\",crmType:this.crmType,data:{}},createCRMType:\"\",isTaskCreate:!1,showFullDetail:!1,relationID:\"\",relationCrmType:\"\",scrollKey:Date.now(),logEditData:null,logEditPosition:{seciton:0,index:0},logEditDialogVisible:!1}},computed:a()({},Object(k.b)([\"crm\"]),{canCreateFollowRecord:function(){return this.crm&&this.crm.followRecord&&this.crm.followRecord.save},showRelate:function(){return\"customer\"==this.crmType},scrollDisabled:function(){return this.loading||this.noMore},taskParams:function(){var t={};return t[this.crmType+\"Ids\"]=this.id,t}}),watch:{id:function(){this.initInfo(),this.refreshLogList()}},created:function(){this.debouncedRefreshLogList=Object(b.debounce)(300,this.refreshLogList),this.initInfo()},methods:{getLogTypeList:function(){var t=this;Object(o.s)().then(function(e){t.followTypes=e.data.map(function(t){return{value:t,label:t}})}).catch(function(){})},getContactsList:function(){var t=this;Object(n.H)({customerId:this.id}).then(function(e){t.contacts=e.data.list}).catch(function(){})},sendLog:function(t){var e=this;if(t.content){var s={};s.activityType=p.default[this.crmType],s.activityTypeId=t.id,s.content=t.content,s.category=t.followType;var i=t.business.map(function(t){return t.businessId});s.batchId=t.batchId,s.businessIds=i.join(\",\"),s.contactsIds=t.contactsId,s.nextTime=t.nextTime||\"\",s.isEvent=0,this.sendLoading=!0,Object(c.a)(s).then(function(t){e.sendLoading=!1,e.$message.success(\"发布成功\"),e.$refs.logAdd&&e.$refs.logAdd.resetInfo(),e.refreshLogList()}).catch(function(){e.sendLoading=!1})}else this.$message.error(\"请输入跟进内容\")},handleClick:function(t){var e=this;if(this.handleType==t?this.handleType=\"\":this.handleType=t,\"log\"==t)this.isTaskCreate=!1,this.$nextTick(function(){e.$refs.logAdd&&(e.$refs.logAdd.isUnfold=e.handleType==t)});else if(\"task\"==t)this.isTaskCreate=!0,this.$nextTick(function(){e.$refs.taskAdd.inputFocus()});else{this.isTaskCreate=!1;var s={type:\"relative\",crmType:this.crmType,data:{}};\"contacts\"==this.crmType?(s.data.customer=Object(m.t)(this.detail),\"business\"==t&&(s.relativeData={contactsId:this.detail.contactsId})):\"customer\"==this.crmType?s.data.customer=Object(m.t)(this.detail):\"business\"==this.crmType?(s.data.customer=Object(m.t)(this.detail),s.data.business=Object(m.t)(this.detail),\"contacts\"==t&&(s.relativeData={businessId:this.detail.businessId})):\"contract\"==this.crmType&&(s.data.customer=Object(m.t)(this.detail),s.data.contract=Object(m.t)(this.detail)),this.createActionInfo=s,this.createCRMType=t,this.isCRMCreate=!0}},initInfo:function(){var t=this;this.$nextTick(function(){t.$refs.logAdd&&t.$refs.logAdd.resetInfo(),t.$refs.taskAdd&&t.$refs.taskAdd.resetSendData()}),this.filterValue={search:\"\",timeLine:{label:\"全部\",value:\"\"}},this.getLogTypeList(),this.showRelate&&this.getContactsList()},refreshLogList:function(){this.page=1,this.noMore=!1,this.list=[],this.scrollKey=Date.now()},handleSelectClick:function(t){this.activityType=t,this.refreshLogList()},timeTypeChange:function(t){this.filterValue.timeLine=t,this.refreshLogList()},getLogList:function(){var t=this;this.loading=!0;var e={page:this.page,crmType:p.default[this.crmType],activityType:this.activityType.command,activityTypeId:this.id};this.filterValue.search&&(e.search=this.filterValue.search),this.filterValue.timeLine.type&&(\"custom\"===this.filterValue.timeLine.type?(e.startDate=this.filterValue.timeLine.startTime.replace(/\\./g,\"-\"),e.endDate=this.filterValue.timeLine.endTime.replace(/\\./g,\"-\")):e.intervalDay=this.filterValue.timeLine.value||\"\"),Object(c.c)(e).then(function(e){if(t.loading=!1,!t.noMore)if(t.page++,t.list.length){var s=t.list[t.list.length-1];e.data.time&&e.data.list.length&&s.time!=e.data.time&&t.list.push(e.data)}else e.data.time&&e.data.list.length&&t.list.push(e.data);t.noMore=e.data.lastPage}).catch(function(){t.noMore=!0,t.loading=!1})},createCRMSuccess:function(){this.handleType=\"\",this.refreshLogList()},createCRMClose:function(){this.isCRMCreate=!1,this.handleType=\"\"},checkCRMDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0},getActivityIcon:function(t){return this.getXrIcon(this.getActivityType(t))},getActivityTypeColor:function(t){return this.getXrIconColor(this.getActivityType(t))},logCellDelete:function(t,e,s){this.list[s].list.splice(e,1),0==this.list[s].list.length&&this.list.splice(s,1),this.scrollKey=Date.now()},logCellEdit:function(t,e,s){this.logEditData=t,this.logEditPosition={seciton:s,index:e},this.logEditDialogVisible=!0},logEditSave:function(t){this.logEditPosition.seciton>=0&&this.logEditPosition.index>=0&&this.list[this.logEditPosition.seciton].list.splice(this.logEditPosition.index,1,t)}}},_=(s(\"QSP8\"),s(\"KHd+\")),w=Object(_.a)(y,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:t.getLogList,expression:\"getLogList\"}],key:t.scrollKey,staticClass:\"main\",attrs:{\"infinite-scroll-distance\":\"100\",\"infinite-scroll-disabled\":\"scrollDisabled\"}},[s(\"div\",[!t.isSeas&&t.handle&&t.handle.length?s(\"div\",{staticClass:\"main-handle\"},t._l(t.handle,function(e,i){return s(\"el-button\",{key:i,class:{\"is-select\":t.handleType===e.type},attrs:{type:\"primary\",icon:\"wk wk-add\"},on:{click:function(s){t.handleClick(e.type)}}},[t._v(\"\\n        \"+t._s(e.label)+\"\\n      \")])})):t._e(),t._v(\" \"),!t.isSeas&&t.handle&&t.handle.length?[!t.isTaskCreate&&t.canCreateFollowRecord?s(\"log-add\",{ref:\"logAdd\",staticClass:\"log-add\",attrs:{id:t.id,\"show-business\":t.showRelate,\"show-contacts\":t.showRelate,contacts:t.contacts,\"contacts-id\":t.contactsId,\"follow-types\":t.followTypes,\"crm-type\":t.crmType},on:{send:t.sendLog,focus:function(e){t.handleType=\"log\"},close:function(e){t.handleClick(t.handleType)}}}):s(\"task-quick-add\",{ref:\"taskAdd\",staticClass:\"task-quick-add\",attrs:{params:t.taskParams},on:{focus:function(e){t.handleType=\"task\"},send:t.refreshLogList}})]:t._e(),t._v(\" \"),s(\"div\",{staticClass:\"log\",class:{\"is-top\":t.handle&&0==t.handle.length}},[s(\"flexbox\",{staticClass:\"log__header\",attrs:{justify:\"flex-end\"}},[s(\"el-input\",{attrs:{placeholder:\"关键字搜索\",\"prefix-icon\":\"el-icon-search\"},on:{input:t.debouncedRefreshLogList},model:{value:t.filterValue.search,callback:function(e){t.$set(t.filterValue,\"search\",e)},expression:\"filterValue.search\"}}),t._v(\" \"),s(\"time-type-select\",{attrs:{width:190,options:t.timeOptions,\"default-type\":t.filterValue.timeLine},on:{change:t.timeTypeChange}}),t._v(\" \"),t.typeList.length>1?s(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:t.handleSelectClick}},[s(\"span\",{staticClass:\"el-dropdown-link\"},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+t.activityType.icon],style:{backgroundColor:t.activityType.color}}),t._v(t._s(t.activityType.label)),s(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),t._v(\" \"),s(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},t._l(t.typeList,function(e,i){return s(\"el-dropdown-item\",{key:i,attrs:{command:e}},[s(\"i\",{class:[\"wk\",\"dropdown-icon\",\"wk-\"+e.icon],style:{backgroundColor:e.color}}),t._v(t._s(e.label))])}))],1):t._e()],1),t._v(\" \"),t._l(t.list,function(e,i){return s(\"div\",{key:i,staticClass:\"log-section\"},[s(\"div\",{staticClass:\"log-section__title\"},[s(\"span\",{staticClass:\"section-title\"},[s(\"span\",{staticClass:\"section-title__time\"},[t._v(t._s(e.time))])])]),t._v(\" \"),t._l(e.list,function(a,n){return[1==a.type?s(\"div\",{key:n,staticClass:\"log-cell\",class:{\"only-one\":1==e.list.length}},[s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":!t.isSeas},on:{\"crm-detail\":t.checkCRMDetail,delete:t.logCellDelete,edit:t.logCellEdit}}),t._v(\" \"),s(\"i\",{staticClass:\"wk wk-message log-cell__mark\"})],1):s(\"div\",{key:n,staticClass:\"log-cell activity-cell\",class:{\"only-one\":1==e.list.length}},[2==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[t._v(t._s(a.createTime)+\" \"+t._s(a.realname)+\"创建了\"+t._s(t.getActivityTypeName(a.activityType))+\"：\")]),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(e){t.checkCRMDetail(t.getActivityType(a.activityType),a.activityTypeId)}}},[t._v(t._s(a.activityTypeName||\"查看详情\"))])]):3==a.type?s(\"div\",{staticClass:\"activity-cell\"},[s(\"span\",{staticClass:\"activity-cell__label\"},[t._v(t._s(a.createTime)+\" \"+t._s(a.realname)+\"将商机：\")]),t._v(\" \"),s(\"span\",{staticClass:\"activity-cell__content\",on:{click:function(e){t.checkCRMDetail(\"business\",a.activityTypeId)}}},[t._v(t._s(a.activityTypeName))]),t._v(\" \"),s(\"span\",[t._v(t._s(\" 阶段变为 \"+a.content))])]):4==a.type?s(\"log-cell\",{attrs:{item:a,section:i,index:n,\"can-delete\":\"\"},on:{\"crm-detail\":t.checkCRMDetail,delete:t.logCellDelete}}):t._e(),t._v(\" \"),s(\"i\",{staticClass:\"log-cell__mark\",class:t.getActivityIcon(a.activityType),staticStyle:{\"background-color\":\"#FB9323\"},style:{backgroundColor:t.getActivityTypeColor(a.activityType)}})],1)]})],2)}),t._v(\" \"),t.loading?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"加载中...\")]):t._e(),t._v(\" \"),t.noMore?s(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"没有更多了\")]):t._e()],2)],2),t._v(\" \"),t.isCRMCreate?s(\"c-r-m-all-create\",{attrs:{\"crm-type\":t.createCRMType,action:t.createActionInfo},on:{\"save-success\":t.createCRMSuccess,close:t.createCRMClose}}):t._e(),t._v(\" \"),s(\"c-r-m-full-screen-detail\",{attrs:{visible:t.showFullDetail,\"crm-type\":t.relationCrmType,id:t.relationID},on:{\"update:visible\":function(e){t.showFullDetail=e}}}),t._v(\" \"),s(\"log-edit-dialog\",{attrs:{visible:t.logEditDialogVisible,data:t.logEditData},on:{\"update:visible\":function(e){t.logEditDialogVisible=e},save:t.logEditSave}})],1)},[],!1,null,\"7955f64b\",null);w.options.__file=\"index.vue\";e.default=w.exports},ep8U:function(t,e,s){},\"fRE+\":function(t,e,s){},gIBH:function(t,e,s){},gWfY:function(t,e,s){},giPm:function(t,e,s){\"use strict\";s.r(e);var i=s(\"KTTK\"),a=s(\"mkuN\"),n=s(\"zMq1\"),o=s(\"ye9D\"),c=s(\"NYF1\"),l=s(\"YIeP\"),r=s(\"7Qib\");var u={methods:{dispatch:function(t,e,s){for(var i=this.$parent||this.$root,a=i.$options.componentName;i&&(!a||a!==t);)(i=i.$parent)&&(a=i.$options.componentName);i&&i.$emit.apply(i,[e].concat(s))},broadcast:function(t,e,s){(function t(e,s,i){this.$children.forEach(function(a){a.$options.componentName===e?a.$emit.apply(a,[s].concat(i)):t.apply(a,[e,s].concat([i]))})}).call(this,t,e,s)}}},d={name:\"LogAdd\",components:{CrmRelative:a.a,AddImageList:n.a,AddFileList:o.a,AddRelateList:c.a,CommonWords:l.a},mixins:[u],props:{showBusiness:{type:Boolean,default:!1},showContacts:{type:Boolean,default:!1},contacts:Array,contactsId:[String,Number],followTypes:Array,id:[String,Number],crmType:{type:String,default:\"\"}},data:function(){return{isUnfold:!1,content:\"\",imgFiles:[],businessAction:{},files:[],showBusinessPopover:!1,business:[],selectContactsId:\"\",followType:\"\",nextTime:\"\",showRelativeType:\"\",batchId:Object(r.r)()}},computed:{autosize:function(){return this.isUnfold?{minRows:3,maxRows:6}:{minRows:1,maxRows:1}}},watch:{followTypes:function(){this.getDefalutFollowType()},content:function(t){var e=!!(t&&t.length>0);this.dispatch(\"SlideView\",\"setEditClose\",[e])},contactsId:function(){this.selectContactsId=this.contactsId||\"\"},id:{handler:function(){this.businessAction={type:\"condition\",data:{moduleType:this.crmType,customerId:this.id}}},immediate:!0}},created:function(){this.selectContactsId=this.contactsId||\"\",this.getDefalutFollowType()},beforeDestroy:function(){},methods:{getDefalutFollowType:function(){this.followTypes&&this.followTypes.length>0?this.followType=this.followTypes[0].value:this.followType=\"\"},resetInfo:function(){this.nextTime=\"\",this.isUnfold=!1,this.content=\"\",this.dispatch(\"SlideView\",\"setEditClose\",[!1]),this.imgFiles=[],this.files=[],this.business=[],this.selectContactsId=this.contactsId||\"\",this.showRelativeType=\"\",this.batchId=Object(r.r)(),this.getDefalutFollowType()},commonWordsSelect:function(t){var e=this;this.content?this.$confirm(\"您选中的常用语将覆盖当前填写内容?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){e.content=t}).catch(function(){}):this.content=t},checkRelativeInfos:function(t){\"business\"==this.showRelativeType&&(this.business=t.data)},barClick:function(t){this.showRelativeType=t,\"business\"==t?this.showBusinessPopover=!0:\"file\"==t?this.$refs.fileInput.click():\"img\"==t&&this.$refs.imgInput.click()},uploadFile:function(t){var e=t.target.files;if(e.length){for(var s=0;s<e.length;s++){if(-1==e[s].type.indexOf(\"image\")&&\"img\"==this.showRelativeType)return void this.$message.error(\"请上传正确的文件类型\")}for(var i=\"image/*\"==t.target.accept?\"img\":\"file\",a=0;a<e.length;a++){var n=e[a];this.uploadFileRequest(n,i)}t.target.value=\"\"}},uploadFileRequest:function(t,e,s){var i=this;this.$wkUploadFile.upload({file:t,params:{type:e,batchId:this.batchId}}).then(function(a){var n=a.res.data||{};n.size=Object(r.h)(t.size),\"img\"==e?i.imgFiles.push(n):(n.icon=Object(r.o)(t),i.files.push(n)),s&&s()}).catch(function(){})},deleteImage:function(t,e){this.deleteImgOrFile(\"image\",t,e)},deleteFile:function(t,e){this.deleteImgOrFile(\"file\",t,e)},deleteImgOrFile:function(t,e,s){var a=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.g)({id:e.fileId}).then(function(e){\"image\"==t?a.imgFiles.splice(s,1):a.files.splice(s,1),a.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteAllFile:function(t){var e=this;this.batchId&&this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(i.i)({batchId:e.batchId,type:t}).then(function(s){2==t?e.imgFiles=[]:e.files=[],e.$message.success(\"操作成功\")}).catch(function(){})}).catch(function(){})},deleteRelate:function(t,e){this.business.splice(e,1)},inputFocus:function(){var t=this;this.isUnfold=!0,this.$nextTick(function(){t.$refs.textarea.focus(),t.$emit(\"focus\")})},sendClick:function(){this.$emit(\"send\",{id:this.id,content:this.content,files:this.files,images:this.imgFiles,business:this.business,contactsId:this.selectContactsId,batchId:this.batchId,followType:this.followType,nextTime:this.nextTime})},close:function(){this.isUnfold=!1,this.$emit(\"close\")}}},h=(s(\"Nbko\"),s(\"KHd+\")),p=Object(h.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{class:[\"mix-content\",{unfold:!t.isUnfold}]},[t.isUnfold?s(\"i\",{staticClass:\"wk wk-close\",on:{click:t.close}}):t._e(),t._v(\" \"),t.isUnfold?s(\"div\",{staticClass:\"mix-content-select\"},[t.showContacts?s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择联系人\"},model:{value:t.selectContactsId,callback:function(e){t.selectContactsId=e},expression:\"selectContactsId\"}},t._l(t.contacts,function(t){return s(\"el-option\",{key:t.contactsId,attrs:{label:t.name,value:t.contactsId}})})):t._e(),t._v(\" \"),s(\"el-select\",{attrs:{clearable:\"\",placeholder:\"选择跟进方式\"},model:{value:t.followType,callback:function(e){t.followType=e},expression:\"followType\"}},t._l(t.followTypes,function(t){return s(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(\" \"),s(\"el-date-picker\",{attrs:{editable:!1,type:\"datetime\",placeholder:\"选择下次联系时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:t.nextTime,callback:function(e){t.nextTime=e},expression:\"nextTime\"}}),t._v(\" \"),s(\"common-words\",{on:{select:t.commonWordsSelect}})],1):t._e(),t._v(\" \"),s(\"div\",{class:[\"i-cont\",{unfold:!t.isUnfold}]},[t.isUnfold?t._e():s(\"i\",{staticClass:\"wk wk-write\"}),t._v(\" \"),s(\"el-input\",{ref:\"textarea\",attrs:{autosize:t.autosize,maxlength:800,type:\"textarea\",clearable:\"\",resize:\"none\",placeholder:\"请输入内容\"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:\"content\"}})],1),t._v(\" \"),t.imgFiles.length>0&&t.isUnfold?s(\"add-image-list\",{attrs:{data:t.imgFiles},on:{delete:t.deleteImage,\"delete-all\":function(e){t.deleteAllFile(2)},upload:t.uploadFile}}):t._e(),t._v(\" \"),t.files.length>0&&t.isUnfold?s(\"add-file-list\",{attrs:{data:t.files},on:{delete:t.deleteFile,\"delete-all\":function(e){t.deleteAllFile(1)}}}):t._e(),t._v(\" \"),t.business.length>0&&t.isUnfold?s(\"add-relate-list\",{attrs:{data:t.business,type:\"business\"},on:{delete:t.deleteRelate}}):t._e(),t._v(\" \"),t.isUnfold?s(\"div\",{staticClass:\"bar-cont\"},[s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-picture\"},on:{click:function(e){t.barClick(\"img\")}}},[t._v(\"图片\")]),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",attrs:{type:\"text\",icon:\"wk wk-file\"},on:{click:function(e){t.barClick(\"file\")}}},[t._v(\"附件\")]),t._v(\" \"),t.showBusiness?s(\"el-popover\",{attrs:{placement:\"bottom\",width:\"700\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showBusinessPopover,callback:function(e){t.showBusinessPopover=e},expression:\"showBusinessPopover\"}},[s(\"crm-relative\",{ref:\"crmrelative\",attrs:{show:t.showBusinessPopover,radio:!1,action:t.businessAction,\"selected-data\":{business:t.business},\"crm-type\":\"business\"},on:{close:function(e){t.showBusinessPopover=!1},changeCheckout:t.checkRelativeInfos}}),t._v(\" \"),s(\"el-button\",{staticClass:\"handle-button\",staticStyle:{\"margin-left\":\"10px\"},attrs:{slot:\"reference\",type:\"text\",icon:\"wk wk-associate\"},on:{click:function(e){t.barClick(\"business\")}},slot:\"reference\"},[t._v(\"关联商机\")])],1):t._e(),t._v(\" \"),s(\"el-button\",{directives:[{name:\"debounce\",rawName:\"v-debounce\",value:t.sendClick,expression:\"sendClick\"}],staticClass:\"send-btn\",attrs:{type:\"primary\"}},[t._v(\"发布\")])],1):t._e(),t._v(\" \"),s(\"input\",{ref:\"fileInput\",staticClass:\"file-input\",attrs:{accept:\"*.*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}}),t._v(\" \"),s(\"input\",{ref:\"imgInput\",staticClass:\"file-input\",attrs:{accept:\"image/*\",type:\"file\",multiple:\"\"},on:{change:t.uploadFile}})],1)},[],!1,null,\"670c00a3\",null);p.options.__file=\"LogAdd.vue\";e.default=p.exports},hSIE:function(t,e,s){\"use strict\";s.d(e,\"d\",function(){return a}),s.d(e,\"f\",function(){return n}),s.d(e,\"b\",function(){return o}),s.d(e,\"c\",function(){return c}),s.d(e,\"e\",function(){return l}),s.d(e,\"a\",function(){return r});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"workTask/myTask\",method:\"post\",data:t})}function n(t){return Object(i.a)({url:\"workTask/updateTop\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function o(t){return Object(i.a)({url:\"work/work/queryWorkNameList\",method:\"post\",data:t})}function c(t){return Object(i.a)({url:\"workTask/archiveByTaskId/\"+t,method:\"post\"})}function l(t){return Object(i.a)({url:\"work/work/activation/\"+t,method:\"post\"})}function r(t){return Object(i.a)({url:\"workTask/workBenchTaskExport\",method:\"post\",data:t,responseType:\"blob\"})}},hr1e:function(t,e,s){\"use strict\";var i=s(\"4lzj\");s.n(i).a},hwzM:function(t,e,s){\"use strict\";s.r(e);var i=s(\"7Qib\"),a=s(\"KTTK\"),n={name:\"FileCell\",filters:{getFileSize:function(t){return Object(i.h)(t)}},props:{cellIndex:Number,data:Object,list:Array,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},data:function(){return{}},computed:{fileIcon:function(){var t=this.data.name?this.data.name.split(\".\"):[],e=\"\";return e=t.length>0?t[t.length-1]:\"\",Object(i.n)(e)},previewShow:function(){return this.list}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{downloadClick:function(){Object(i.d)({path:this.data.filePath||this.data.url,name:this.data.name})},previewClick:function(){Object(i.a)(this.data.name)?Object(i.G)(this.data.filePath||this.data.url,this.data.name):this.$bus.emit(\"preview-image-bus\",{index:this.cellIndex||0,data:this.list.map(function(t){return{url:t.filePath||t.url,name:t.name}})})},deleteClick:function(){var t=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(a.g)({id:t.data.fileId}).then(function(e){t.$message.success(\"操作成功\"),t.$emit(\"delete\",t.cellIndex,t.data)}).catch(function(){})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})}}},o=(s(\"Bd1s\"),s(\"KHd+\")),c=Object(o.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"flexbox\",{staticClass:\"cell\"},[i(\"img\",{staticClass:\"cell-head\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:t.fileIcon,alt:\"\"}}),t._v(\" \"),i(\"div\",{staticClass:\"cell-body text-one-line\",class:{\"cursor-pointer\":t.cursorPointer}},[i(\"span\",[t._v(t._s(t.data.name.length>20?t.data.name.substring(0,20)+\"...\":t.data.name))])]),t._v(\" \"),i(\"div\",{staticClass:\"size\"},[t._v(\"\\n    (\"+t._s(t._f(\"getFileSize\")(t.data.size))+\")\\n  \")]),t._v(\" \"),i(\"div\",{staticClass:\"cell-foot\"},[t.previewShow?i(\"span\",{staticClass:\"xr-text-btn primary\",on:{click:t.previewClick}},[t._v(\"预览\")]):t._e(),t._v(\" \"),i(\"span\",{staticClass:\"xr-text-btn primary\",on:{click:t.downloadClick}},[t._v(\"下载\")]),t._v(\" \"),t.showDelete?i(\"span\",{staticClass:\"xr-text-btn delete\",on:{click:t.deleteClick}},[t._v(\"删除\")]):t._e()])])},[],!1,null,\"4a3d86b8\",null);c.options.__file=\"index.vue\";e.default=c.exports},jM2j:function(t,e,s){\"use strict\";s.r(e);var i=s(\"ViDN\"),a=s(\"8GhS\"),n=s(\"FoeY\"),o=s(\"7Qib\"),c={components:{CreateView:i.a,XhStrucUserCell:a.m},props:{action:{type:Object,default:function(){return{type:\"save\"}}}},data:function(){var t=this,e=function(e,s,i){\"startTime\"==e.field&&!t.formData.startTime&&t.formData.endTime||\"endTime\"==e.field&&!t.formData.endTime&&t.formData.startTime?i(new Error(\"请完善时间\")):t.formData.startTime&&t.formData.endTime&&Object(o.k)(t.formData.startTime)>=Object(o.k)(t.formData.endTime)&&i(new Error(\"开始时间必须小于结束时间\")),i()};return{formList:[{label:\"公告标题\",field:\"title\"},{label:\"通知范围\",field:\"dep\",type:\"plus\"},{label:\"公告正文\",field:\"content\",type:\"textarea\"}],formData:{dep:{staff:[],dep:[]}},rules:{title:[{required:!0,message:\"公告标题不能为空\",trigger:\"blur\"},{max:50,message:\"公告标题长度最多为50个字符\",trigger:\"blur\"}],content:[{required:!0,message:\"公告正文不能为空\",trigger:\"blur\"}],startTime:[{required:!0,message:\"不能为空\",trigger:\"blur\"},{validator:e,trigger:\"blur\"}],endTime:[{required:!0,message:\"不能为空\",trigger:\"blur\"},{validator:e,trigger:\"blur\"}]},loading:!1}},computed:{title:function(){return\"save\"==this.action.type?\"新建公告\":\"编辑公告\"}},created:function(){var t=this;\"update\"==this.action.type&&Object(n.e)(this.action.id).then(function(e){t.formData={title:e.data.title,content:e.data.content,dep:{staff:e.data.ownerUserList,dep:e.data.deptList}}})},methods:{onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var s={title:t.formData.title,content:t.formData.content,deptIds:t.formData.dep.dep.map(function(t){return t.id}).join(\",\"),ownerUserIds:t.formData.dep.staff.map(function(t){return t.userId}).join(\",\")};\"update\"==t.action.type&&(s.announcementId=t.action.id),Object(n.a)(s).then(function(e){t.$message.success(t.title+\"成功\"),t.$emit(\"onSubmit\"),t.close(),t.loading=!1}).catch(function(){t.$message.error(t.title+\"失败\"),t.loading=!1})})},close:function(){this.$emit(\"close\")},strcUserChange:function(t){this.$set(this.formData,\"dep\",{staff:t.value.users,dep:t.value.strucs})},deleteuser:function(t){this.formData.dep.staff.splice(t,1)},deleteDepuser:function(t){this.formData.dep.dep.splice(t,1)}}},l=(s(\"cZgO\"),s(\"KHd+\")),r=Object(l.a)(c,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"create-view\",{attrs:{\"body-style\":{height:\"100%\"}}},[s(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"details-box\"},[s(\"div\",{staticClass:\"header\",attrs:{slot:\"header\"},slot:\"header\"},[s(\"span\",{staticClass:\"text\"},[t._v(t._s(t.title))]),t._v(\" \"),s(\"i\",{staticClass:\"el-icon-close rt\",on:{click:t.close}})]),t._v(\" \"),s(\"div\",{staticClass:\"content\"},[s(\"el-form\",{ref:\"form\",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,i){return s(\"el-form-item\",{key:i,class:\"el-form-item\"+e.field,attrs:{label:e.label,prop:e.field}},[\"date\"==e.type?[s(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"选择日期\"},model:{value:t.formData[e.field],callback:function(s){t.$set(t.formData,e.field,s)},expression:\"formData[item.field]\"}})]:\"textarea\"==e.type?[s(\"el-input\",{attrs:{autosize:{minRows:15},maxlength:2e3,\"show-word-limit\":\"\",type:\"textarea\",placeholder:\"请输入内容\"},model:{value:t.formData[e.field],callback:function(s){t.$set(t.formData,e.field,s)},expression:\"formData[item.field]\"}})]:\"plus\"==e.type?[s(\"xh-struc-user-cell\",{staticStyle:{width:\"100%\"},attrs:{value:null,users:t.formData[e.field].staff,strucs:t.formData[e.field].dep},on:{\"value-change\":t.strcUserChange}})]:s(\"el-input\",{model:{value:t.formData[e.field],callback:function(s){t.$set(t.formData,e.field,s)},expression:\"formData[item.field]\"}})],2)}))],1),t._v(\" \"),s(\"div\",{staticClass:\"btn-box\"},[s(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.onSubmit}},[t._v(\"提交\")]),t._v(\" \"),s(\"el-button\",{on:{click:t.close}},[t._v(\"取消\")])],1)])])},[],!1,null,\"6d1389f4\",null);r.options.__file=\"NewDialog.vue\";e.default=r.exports},kK4T:function(t,e,s){\"use strict\";s.r(e),e.default={data:function(){return{priorityList:[{id:3,label:\"高\",color:\"#F95A5A\"},{id:2,label:\"中\",color:\"#F7AD3D\"},{id:1,label:\"低\",color:\"#67C23A\"},{id:0,label:\"无\",color:\"#D8D8D8\"}]}},methods:{getPriorityColor:function(t){return 1==t?{color:\"#67C23A\",label:\"低\"}:2==t?{color:\"#F7AD3D\",label:\"中\"}:3==t?{color:\"#F95A5A\",label:\"高\"}:{color:\"transparent\",label:\"无\"}}}}},lebS:function(t,e,s){},nD2f:function(t,e,s){\"use strict\";var i=s(\"tjFw\");s.n(i).a},pKm3:function(t,e,s){\"use strict\";s.r(e);var i=s(\"FyfS\"),a=s.n(i),n=s(\"QbLZ\"),o=s.n(n),c=s(\"Ew9n\"),l=s(\"Xjjk\"),r=s.n(l),u=s(\"hSIE\"),d=s(\"zsVz\"),h=s(\"Ir+r\"),p=s(\"Flj7\"),m=s(\"LWkM\"),f=s(\"2X1c\"),v=s(\"U8n8\"),g=s(\"HslM\"),b=s(\"z5u8\"),k=s(\"u+Mw\"),y=s(\"EBQf\"),_=s(\"8GhS\"),w=s(\"hwzM\"),C=s(\"L2JU\"),T=s(\"z7oh\"),D=s(\"dPzk\"),x=s(\"wd/R\"),I=s.n(x),L=s(\"7Qib\"),j=s(\"kK4T\"),$={name:\"TaskDetail\",components:{SlideView:c.a,MembersDep:v.a,Emoji:k.a,RelatedBusiness:y.a,TagIndex:g.default,CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-63bb\"),s.e(\"chunk-7029\"),s.e(\"chunk-6435\"),s.e(\"chunk-9dc6\"),s.e(\"chunk-8a41\")]).then(s.bind(null,\"3z7q\"))},SubTask:b.default,FileCell:w.default,XhUserCell:_.p,CommentList:T.a,ReplyComment:D.a},mixins:[j.default],props:{id:[String,Number],isTrash:Boolean,detailIndex:Number,detailSection:Number,noListenerClass:{type:Array,default:function(){return[\"el-table__body\"]}}},data:function(){var t=this;return{loading:null,canShowDetail:!0,priorityVisible:!1,startTimeOptions:{disabledDate:function(e){return!(!t.taskData||!t.taskData.stopTime)&&I()(e).isAfter(t.taskData.stopTime)}},stopTimeOptions:{disabledDate:function(e){return!(!t.taskData||!t.taskData.startTime)&&I()(e).isBefore(t.taskData.startTime)}},addSubtasks:!0,nameVinput:!1,taskDataName:\"\",addDescriptionShow:!1,addDescriptionTextarea:\"\",subTaskDoneNum:0,addComments:!1,allData:{},commentsLoading:!1,relatedID:\"\",relatedCRMType:\"\",showRelatedDetail:!1,subTaskID:null,taskData:null,taskMilestone:\"1\",activityList:[],fileList:[],replyList:[]}},computed:o()({},Object(C.b)([\"userInfo\"]),{priority:function(){return 0!=this.taskData.priority&&this.taskData.priority?this.getPriorityColor(this.taskData.priority):this.priorityList[3]},isArchive:function(){return 1==this.taskData.isArchive&&1!=this.taskData.ishidden},isRecycle:function(){return 1==this.taskData.ishidden},showArchiveBtn:function(){return this.workId&&!this.isArchive&&!this.isRecycle},subTaskProgress:function(){return 0==this.subTaskDoneNum?0:parseInt(this.subTaskDoneNum/this.taskData.childTask.length*100)},ownerListRequest:function(){return this.workId?m.t:null},ownerListParams:function(){return this.workId?{workId:this.workId}:null},workId:function(){return this.taskData.workId},labelList:function(){return this.taskData&&this.taskData.labelList||[]}}),watch:{id:function(t){this.initInfo(),this.getDetail(),this.getCommentList(),this.getActivityList()},labelList:function(t,e){e&&this.$emit(\"on-handle\",{type:\"change-label\",value:t,index:this.detailIndex,section:this.detailSection})},addDescriptionTextarea:function(t){this.$refs.sideView.isEditClose=!!(t&&t.length>0)}},mounted:function(){},beforeDestroy:function(){},methods:{viewAfterEnter:function(){this.id&&(this.getDetail(),this.getCommentList(),this.getActivityList())},initInfo:function(){this.taskData=null,this.subTaskDoneNum=0,this.addDescriptionShow=!1,this.priorityVisible=!1,this.addSubtasks=!0,this.nameVinput=!1,this.addDescriptionTextarea=\"\",this.addComments=!1,this.allData={business:[],contacts:[],contract:[],customer:[]},this.relatedID=\"\",this.showRelatedDetail=!1,this.activityList=[],this.fileList=[],this.replyList=[]},getDetail:function(){var t=this;this.loading=!0,(this.isTrash?d.b:d.a)({taskId:this.id}).then(function(e){var s=e.data;if(s.checked=5==s.status,s.childTask){var i=!0,n=!1,o=void 0;try{for(var c,l=a()(s.childTask);!(i=(c=l.next()).done);i=!0){var r=c.value;5==r.status?(r.checked=!0,t.subTaskDoneNum++):r.checked=!1}}catch(t){n=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(n)throw o}}}t.fileList=e.data.file,t.allData={business:(s.businessList||[]).map(function(t){return t.id&&(t.businessId=t.id),t}),contacts:(s.contactsList||[]).map(function(t){return t.id&&(t.contactsId=t.id),t}),contract:(s.contractList||[]).map(function(t){return t.id&&(t.contractId=t.id),t}),customer:(s.customerList||[]).map(function(t){return t.id&&(t.customerId=t.id),t})},t.taskData=s,t.loading=!1}).catch(function(e){t.loading=!1,e&&\"没有权限\"==e.msg?t.canShowDetail=!1:t.closeBtn()})},getActivityList:function(){var t=this;Object(d.d)({taskId:this.id}).then(function(e){t.activityList=e.data}).catch(function(){})},getCommentList:function(){var t=this;Object(h.b)({typeId:this.id,type:1}).then(function(e){t.replyList=e.data}).catch(function(){})},completeMainTask:function(t){var e=this;this.taskData.checked=t,Object(p.p)({taskId:this.id,status:this.taskData.checked?5:1}).then(function(s){e.$emit(\"on-handle\",{type:\"title-check\",value:t,index:e.detailIndex,section:e.detailSection})}).catch(function(){e.taskData.checked=!e.taskData.checked})},editTaskName:function(){this.getPermission(\"setTaskTitle\")&&(this.nameVinput=!0,this.taskDataName=this.taskData.name)},editTaskDescription:function(){this.getPermission(\"setTaskDescription\")&&(this.addDescriptionShow=!0,this.addDescriptionTextarea=this.taskData.description)},switchChange:function(){var t=this;Object(p.a)({taskId:this.id,status:this.taskData.isMilestone}).then(function(e){t.$emit(\"on-handle\",{type:\"set-milestone\",value:t.taskData.isMilestone,index:t.detailIndex,section:t.detailSection})}).catch(function(){t.$message.error(\"设置里程碑失败\")})},getPermission:function(t){return!this.workId||!!(this.taskData&&this.taskData.authList.project||{})[t]},closeBtn:function(){this.$emit(\"close\")},priorityBtn:function(t,e){var s=this;this.taskData.priority=t.id,Object(p.n)({taskId:this.id,priority:t.id}).then(function(e){s.$emit(\"on-handle\",{type:\"change-priority\",value:t,index:s.detailIndex,section:s.detailSection}),s.priorityVisible=!1}).catch(function(){s.$message.error(\"编辑失败\"),s.taskData.priority=e})},moreDelete:function(){var t=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){Object(p.h)(t.id).then(function(e){t.$message.success(\"删除成功\"),t.$emit(\"on-handle\",{type:\"delete\",index:t.detailIndex,section:t.detailSection}),t.$emit(\"close\")}).catch(function(){})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},moreArchive:function(){var t=this;this.$confirm(\"此操作将归档该任务, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){Object(u.c)(t.id).then(function(e){t.$message.success(\"操作成功\"),t.$emit(\"on-handle\",{type:\"delete\",index:t.detailIndex,section:t.detailSection}),t.$emit(\"close\")}).catch(function(){})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},httpRequest:function(t){var e=this;this.$wkUploadFile.upload({file:t.file,params:{batchId:this.taskData.batchId}}).then(function(t){var s=t.res.data||{};e.fileList.push(s),e.$message.success(\"上传成功\")}).catch(function(){})},accessoryDeleteFun:function(t,e){this.fileList.splice(t,1)},subtasksCheckbox:function(t,e){var s=this;e?(this.$set(t,\"checked\",!0),this.subTaskDoneNum++):(this.$set(t,\"checked\",!1),this.subTaskDoneNum--),Object(p.e)({taskId:t.taskId,status:e?5:1}).then(function(t){s.$emit(\"on-handle\",{type:\"change-sub-task\",value:{subdonecount:s.subTaskDoneNum,allcount:s.taskData.childTask.length},index:s.detailIndex,section:s.detailSection})}).catch(function(){s.$message.error(\"子任务标记失败\"),e?(s.$set(t,\"checked\",!1),s.subTaskDoneNum--):(s.$set(t,\"checked\",!0),s.subTaskDoneNum++)})},editOwnerList:function(t,e){var s=this;Object(p.m)({taskId:this.id,ownerUserId:t.map(function(t){return t.userId}).join(\",\")}).then(function(e){s.taskData.ownerUserList=t}).catch(function(){})},deleteOwnerList:function(t,e){var s=this;Object(p.l)({taskId:this.id,userId:t.userId}).then(function(t){s.taskData.ownerUserList.splice(e,1)}).catch(function(){})},mainUserChange:function(t){var e=t.value.length>0?t.value[0]:null;this.submiteMainUser(e)},submiteMainUser:function(t){var e=this;Object(p.k)({taskId:this.id,userId:t?t.userId:\"\"}).then(function(s){t?e.$set(e.taskData,\"mainUser\",t):e.$set(e.taskData,\"mainUser\",null),e.$emit(\"on-handle\",{type:\"change-main-user\",value:t,index:e.detailIndex,section:e.detailSection})}).catch(function(){})},submiteTaskName:function(t){var e=this;Object(p.r)({name:t,taskId:this.id}).then(function(s){e.nameVinput=!1,e.$emit(\"on-handle\",{type:\"change-name\",value:t,index:e.detailIndex,section:e.detailSection}),e.taskData.name=t}).catch(function(){})},deleteTime:function(t){this.taskData[t]=\"\",this.timeChange(t)},timeChange:function(t){var e=this,s={taskId:this.id};s[t]=this.taskData[t],Object(p.q)(s).then(function(s){\"stopTime\"==t&&e.$emit(\"on-handle\",{type:\"change-stop-time\",value:e.taskData[t],index:e.detailIndex,section:e.detailSection})}).catch(function(){})},submiteDescription:function(){var t=this;Object(p.i)({taskId:this.id,description:this.addDescriptionTextarea}).then(function(e){t.addDescriptionShow=!1,t.$set(t.taskData,\"description\",t.addDescriptionTextarea),t.addDescriptionTextarea=\"\"}).catch(function(){})},handleReply:function(t){var e=this;t&&(this.commentsLoading=!0,Object(h.c)({typeId:this.id,type:1,content:r()(t)}).then(function(t){t.data.childCommentList=[],t.data.user={userId:e.userInfo.id,realname:e.userInfo.realname,img:e.userInfo.img},e.$refs.f_reply.commentsTextarea=\"\",e.replyList.push(t.data),e.$emit(\"on-handle\",{type:\"change-comments\",value:\"add\",index:e.detailIndex,section:e.detailSection}),e.commentsLoading=!1}).catch(function(){e.commentsLoading=!1}))},deleteComment:function(t){this.replyList.splice(t,1)},discussDelete:function(t,e,s){var i=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){Object(h.a)({commentId:t.commentId}).then(function(t){e.splice(s,1),i.$emit(\"on-handle\",{type:\"change-comments\",value:\"delete\",index:i.detailIndex,section:i.detailSection})}).catch(function(){})}).catch(function(){i.$message({type:\"info\",message:\"已取消删除\"})})},checkInfos:function(t,e){var s=this;Object(d.c)({taskId:this.id,customerIds:t.customerIds&&t.customerIds.length?\",\"+t.customerIds.join(\",\")+\",\":\"\",contactsIds:t.contactsIds&&t.contactsIds.length?\",\"+t.contactsIds.join(\",\")+\",\":\"\",businessIds:t.businessIds&&t.businessIds.length?\",\"+t.businessIds.join(\",\")+\",\":\"\",contractIds:t.contractIds&&t.contractIds.length?\",\"+t.contractIds.join(\",\")+\",\":\"\"}).then(function(t){s.$message.success(\"关联成功\"),s.allData=e,s.$emit(\"on-handle\",{type:\"relation-business\",index:s.detailIndex,section:s.detailSection})}).catch(function(){})},unbindRelatedInfo:function(t,e,s){var i=this;this.$confirm(\"确认取消关联?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){var e={taskId:i.taskData.taskId},a=Object(L.t)(i.allData);a[t].splice(s,1);for(var n=[\"customer\",\"contacts\",\"business\",\"contract\"],o=function(t){var s=n[t],i=a[s]||[];e[s+\"Ids\"]=i.map(function(t){return t[s+\"Id\"]}).join(\",\")},c=0;c<n.length;c++)o(c);Object(d.c)(e).then(function(t){i.allData=a,i.$message.success(\"关联取消成功\")}).catch(function(){})}).catch(function(){i.$message.info(\"已取消操作\")})},checkRelatedDetail:function(t,e){this.relatedID=e.key,this.relatedCRMType=t,this.showRelatedDetail=!0},deleteSubTask:function(t){var e=this;this.$confirm(\"此操作将删除该任务, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\",customClass:\"is-particulars\"}).then(function(){Object(p.c)(t.taskId).then(function(s){var i=e.taskData.childTask;for(var a in i)if(i[a].taskId==t.taskId){i.splice(a,1);break}t.checked&&e.subTaskDoneNum--,e.$emit(\"on-handle\",{type:\"change-sub-task\",value:{subdonecount:e.subTaskDoneNum,allcount:e.taskData.childTask.length},index:e.detailIndex,section:e.detailSection}),e.$message.success(\"子任务删除成功\")}).catch(function(){e.$message.error(\"子任务删除失败\")})}).catch(function(){e.$message({type:\"info\",message:\"已取消删除\"})})},editSubTask:function(t){this.subTaskID=t.taskId;var e=this.taskData.childTask;for(var s in e)e[s].taskId==t.taskId?this.$set(e[s],\"showEdit\",!0):this.$set(e[s],\"showEdit\",!1)},handleSubTasksBlock:function(t,e){\"edit\"==t.type?this.$set(e,\"showEdit\",!1):\"add\"==t.type?(this.addSubtasks=!0,t.result,this.$emit(\"on-handle\",{type:\"change-sub-task\",value:{subdonecount:this.subTaskDoneNum,allcount:this.taskData.childTask.length},index:this.detailIndex,section:this.detailSection})):\"cancel\"==t.type&&(e?this.$set(e,\"showEdit\",!1):this.addSubtasks=!0)},deleteTimeTop:function(){var t=this;Object(p.q)({taskId:this.id,stopTime:\"\"}).then(function(e){t.$set(t.taskData,\"stopTime\",\"\"),t.$emit(\"on-handle\",{type:\"stop-time\",index:t.detailIndex,section:t.detailSection})}).catch(function(){})},activateTask:function(){var t=this;this.loading=!0,Object(u.e)(this.taskData.taskId).then(function(e){t.loading=!1,t.$emit(\"on-handle\",{type:\"activate-task\",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})},recoverTask:function(){var t=this;this.loading=!0,Object(f.c)(this.taskData.taskId).then(function(e){t.loading=!1,t.$message.success(\"恢复成功\"),t.$emit(\"on-handle\",{type:\"recover-task\",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})},thoroughDeleteTask:function(){var t=this;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){t.loading=!0,Object(f.a)(t.taskData.taskId).then(function(e){t.loading=!1,t.$emit(\"on-handle\",{type:\"thorough-delete-task\",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},morkDropdownClick:function(t){this.moreDelete()},hideView:function(){this.$emit(\"close\"),this.$emit(\"hide-view\")},closeOtherReply:function(t){!t&&this.$refs.comment_list&&this.$refs.comment_list.closeReply()}}},O=(s(\"wEl6\"),s(\"KHd+\")),S=Object(O.a)($,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"slide-view\",{directives:[{name:\"empty\",rawName:\"v-empty\",value:!t.canShowDetail,expression:\"!canShowDetail\"}],ref:\"sideView\",staticClass:\"d-view\",attrs:{\"no-listener-class\":t.noListenerClass,\"body-style\":{padding:0,height:\"100%\"},\"xs-empty-icon\":\"nopermission\",\"xs-empty-text\":\"暂无权限\"},on:{afterEnter:t.viewAfterEnter,close:t.hideView}},[null!==t.loading?i(\"flexbox\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticClass:\"main\",attrs:{direction:\"column\",align:\"stretch\"}},[t.taskData?i(\"div\",{staticClass:\"main__hd task-hd\"},[i(\"flexbox\",{staticClass:\"task-hd__top\",attrs:{justify:\"space-between\"}},[t.taskData.createUser?i(\"span\",{staticClass:\"task-hd__top--create\"},[t._v(t._s(t.taskData.createUser.realname)+\" 创建于 \"+t._s(t.taskData.createTime))]):t._e(),t._v(\" \"),i(\"div\",[t.isArchive?i(\"span\",{staticClass:\"task-hd__top--info\"},[t._v(\"该任务已于 \"+t._s(t.taskData.archiveTime)+\" 被归档\")]):t._e(),t._v(\" \"),t.isArchive?i(\"el-button\",{staticClass:\"xr-btn--primary\",attrs:{icon:\"wk wk-activation\",type:\"primary\"},on:{click:t.activateTask}},[t._v(\"激活\")]):t._e(),t._v(\" \"),t.isRecycle?i(\"span\",{staticClass:\"task-hd__top--info\"},[t._v(\"该任务已于 \"+t._s(t.taskData.hiddenTime)+\" 被放入回收站\")]):t._e(),t._v(\" \"),t.isRecycle&&t.getPermission(\"restoreTask\")?i(\"el-button\",{staticClass:\"xr-btn--primary\",attrs:{icon:\"wk wk-activation\",type:\"primary\"},on:{click:t.recoverTask}},[t._v(\"恢复\")]):t._e(),t._v(\" \"),t.isRecycle&&t.getPermission(\"cleanTask\")?i(\"el-button\",{staticClass:\"xr-btn--red\",attrs:{icon:\"el-icon-delete-solid\",type:\"primary\"},on:{click:t.thoroughDeleteTask}},[t._v(\"彻底删除\")]):t._e(),t._v(\" \"),t.showArchiveBtn&&t.getPermission(\"archiveTask\")?i(\"el-button\",{staticClass:\"xr-btn--green\",attrs:{icon:\"wk wk-archive\",type:\"primary\"},on:{click:t.moreArchive}},[t._v(\"归档\")]):t._e(),t._v(\" \"),!t.isRecycle&&t.getPermission(\"deleteTask\")?i(\"el-dropdown\",{attrs:{trigger:\"click\"},on:{command:t.morkDropdownClick}},[i(\"el-button\",{attrs:{icon:\"el-icon-more\"}}),t._v(\" \"),i(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[i(\"el-dropdown-item\",{attrs:{icon:t._f(\"wkIconPre\")(\"delete\"),command:\"delete\"}},[t._v(\"删除\")])],1)],1):t._e()],1)]),t._v(\" \"),i(\"flexbox\",{staticClass:\"task-hd__middle\",attrs:{align:\"stretch\"}},[i(\"el-checkbox\",{attrs:{disabled:!t.getPermission(\"setTaskStatus\")},on:{change:t.completeMainTask},model:{value:t.taskData.checked,callback:function(e){t.$set(t.taskData,\"checked\",e)},expression:\"taskData.checked\"}}),t._v(\" \"),t.nameVinput?i(\"div\",{staticClass:\"show-input\"},[i(\"el-input\",{attrs:{maxlength:100,size:\"medium\"},model:{value:t.taskDataName,callback:function(e){t.taskDataName=e},expression:\"taskDataName\"}}),t._v(\" \"),i(\"div\",{staticClass:\"btn-box\"},[i(\"el-button\",{attrs:{type:\"primary\",size:\"mini\"},on:{click:function(e){t.submiteTaskName(t.taskDataName)}}},[t._v(\"保 存\")]),t._v(\" \"),i(\"el-button\",{attrs:{size:\"mini\"},on:{click:function(e){t.nameVinput=!1}}},[t._v(\"取 消\")])],1)],1):i(\"el-tooltip\",{attrs:{content:t.taskData.name,effect:\"dark\",placement:\"top\"}},[i(\"div\",{class:[\"task-name\",{\"is-checked\":t.taskData.checked}],on:{click:t.editTaskName}},[t._v(t._s(t.taskData.name))])])],1),t._v(\" \"),i(\"flexbox\",{staticClass:\"task-hd__bottom\"},[i(\"flexbox-item\",{staticClass:\"priority\",attrs:{span:.125}},[i(\"flexbox\",{nativeOn:{click:function(e){t.priorityVisible=!0}}},[i(\"el-popover\",{attrs:{disabled:!t.getPermission(\"setTaskPriority\"),\"popper-class\":\"no-padding-popover\",placement:\"bottom\",trigger:\"click\"},model:{value:t.priorityVisible,callback:function(e){t.priorityVisible=e},expression:\"priorityVisible\"}},[i(\"flexbox\",{staticClass:\"priority-select\"},t._l(t.priorityList,function(e,s){return i(\"div\",{key:s,staticClass:\"priority-select-item\",on:{click:function(s){t.priorityBtn(e,t.taskData.priority)}}},[i(\"span\",{staticClass:\"priority--icon\",style:{backgroundColor:e.color}},[t._v(t._s(e.label))])])})),t._v(\" \"),i(\"span\",{staticClass:\"priority--icon\",style:{backgroundColor:t.priority.color},attrs:{slot:\"reference\"},slot:\"reference\"},[t._v(t._s(t.priority.label))])],1),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd\"},[i(\"div\",{staticClass:\"head-btn__bd--des\"},[t._v(\"优先级\")])])],1)],1),t._v(\" \"),i(\"flexbox-item\",{staticClass:\"label\",attrs:{span:.125}},[i(\"flexbox\",{staticClass:\"head-btn\"},[i(\"div\",{staticClass:\"head-btn__bd\"},[i(\"div\",{staticClass:\"head-btn__bd--des\"},[t._v(\"里程碑\")])]),t._v(\" \"),i(\"el-switch\",{attrs:{\"active-value\":1,\"inactive-value\":0},on:{change:function(e){t.switchChange()}},model:{value:t.taskData.isMilestone,callback:function(e){t.$set(t.taskData,\"isMilestone\",e)},expression:\"taskData.isMilestone\"}})],1)],1),t._v(\" \"),i(\"flexbox-item\",[i(\"xh-user-cell\",{staticStyle:{width:\"100%\"},attrs:{value:t.taskData.mainUser?[t.taskData.mainUser]:[],\"info-request\":t.ownerListRequest,\"info-params\":t.ownerListParams,disabled:!t.getPermission(\"setTaskMainUser\"),placement:\"top\",radio:\"\"},on:{\"value-change\":t.mainUserChange}},[i(\"flexbox\",{staticClass:\"head-btn\",attrs:{slot:\"reference\"},slot:\"reference\"},[t.taskData.mainUser?i(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:t.taskData.mainUser?t.taskData.mainUser.realname:\"\",size:32,src:t.taskData.mainUser?t.taskData.mainUser.img:\"\"}}):i(\"i\",{staticClass:\"wk wk-l-plus head-btn__icon is-null\"}),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd\"},[t.taskData.mainUser?i(\"div\",{staticClass:\"head-btn__bd--title\"},[t._v(t._s(t.taskData.mainUser.realname))]):t._e(),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd--des\"},[t._v(\"负责人\")])]),t._v(\" \"),i(\"i\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.taskData.mainUser&&t.getPermission(\"setTaskMainUser\"),expression:\"taskData.mainUser && getPermission('setTaskMainUser')\"}],staticClass:\"el-icon-close head-btn__close\",on:{click:function(e){t.submiteMainUser(null)}}})],1)],1)],1),t._v(\" \"),i(\"flexbox-item\",[i(\"flexbox\",{staticClass:\"head-btn\"},[i(\"i\",{staticClass:\"wk wk-l-time head-btn__icon\",class:[t.taskData.startTime?\"is-valve\":\"is-null\"]}),t._v(\" \"),i(\"el-date-picker\",{attrs:{clearable:!1,disabled:!t.getPermission(\"setTaskTime\"),\"picker-options\":t.startTimeOptions,type:\"date\",\"value-format\":\"yyyy-MM-dd\"},on:{change:function(e){t.timeChange(\"startTime\")}},model:{value:t.taskData.startTime,callback:function(e){t.$set(t.taskData,\"startTime\",e)},expression:\"taskData.startTime\"}}),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd\"},[t.taskData.startTime?i(\"div\",{staticClass:\"head-btn__bd--title\"},[t._v(t._s(t._f(\"moment\")(t.taskData.startTime,\"YYYY年MM月DD日\")))]):t._e(),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd--des\"},[t._v(\"开始时间\")])]),t._v(\" \"),i(\"i\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.taskData.startTime,expression:\"taskData.startTime\"}],staticClass:\"el-icon-close head-btn__close\",on:{click:function(e){t.deleteTime(\"startTime\")}}})],1)],1),t._v(\" \"),i(\"flexbox-item\",[i(\"flexbox\",{staticClass:\"head-btn\"},[i(\"i\",{staticClass:\"wk wk-l-minus head-btn__icon\",class:[t.taskData.stopTime?\"is-valve\":\"is-null\"]}),t._v(\" \"),i(\"el-date-picker\",{attrs:{clearable:!1,disabled:!t.getPermission(\"setTaskTime\"),\"picker-options\":t.stopTimeOptions,type:\"date\",\"value-format\":\"yyyy-MM-dd\"},on:{change:function(e){t.timeChange(\"stopTime\")}},model:{value:t.taskData.stopTime,callback:function(e){t.$set(t.taskData,\"stopTime\",e)},expression:\"taskData.stopTime\"}}),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd\"},[t.taskData.stopTime?i(\"div\",{staticClass:\"head-btn__bd--title\"},[t._v(t._s(t._f(\"moment\")(t.taskData.stopTime,\"YYYY年MM月DD日\")))]):t._e(),t._v(\" \"),i(\"div\",{staticClass:\"head-btn__bd--des\"},[t._v(\"结束时间\")])]),t._v(\" \"),i(\"i\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.taskData.stopTime,expression:\"taskData.stopTime\"}],staticClass:\"el-icon-close head-btn__close\",on:{click:function(e){t.deleteTime(\"stopTime\")}}})],1)],1)],1)],1):t._e(),t._v(\" \"),t.taskData?i(\"flexbox\",{staticClass:\"main__bd\",attrs:{align:\"stretch\"}},[i(\"div\",{staticClass:\"main__bd--left\"},[i(\"flexbox\",[i(\"flexbox-item\",{staticClass:\"participant\"},[i(\"div\",{staticClass:\"participant-title\"},[t._v(\"参与人\")]),t._v(\" \"),i(\"flexbox\",{staticClass:\"participant-bd\",attrs:{wrap:\"wrap\"}},[t._l(t.taskData.ownerUserList,function(e,a){return i(\"span\",{key:a,staticClass:\"owner-list\"},[i(\"el-tooltip\",{attrs:{placement:\"bottom\",effect:\"light\",\"popper-class\":\"tooltip-change-border\"}},[i(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[i(\"span\",[t._v(t._s(e.realname))])]),t._v(\" \"),i(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:e.realname,size:32,src:e.img}})],1),t._v(\" \"),t.getPermission(\"setTaskOwnerUser\")?i(\"img\",{staticClass:\"el-icon-close\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:s(\"cEue\")},on:{click:function(s){t.deleteOwnerList(e,a)}}}):t._e()],1)}),t._v(\" \"),t.getPermission(\"setTaskOwnerUser\")?i(\"members-dep\",{attrs:{\"close-dep\":!0,\"content-block\":!1,\"user-checked-data\":t.taskData.ownerUserList,\"user-request\":t.ownerListRequest,\"user-params\":t.ownerListParams},on:{popoverSubmit:t.editOwnerList}},[i(\"i\",{staticClass:\"wk wk-l-plus participant-add\",attrs:{slot:\"membersDep\"},slot:\"membersDep\"})]):t._e()],2)],1),t._v(\" \"),i(\"flexbox-item\",{staticClass:\"label\"},[i(\"div\",{staticClass:\"label-title\"},[t._v(\"标签\")]),t._v(\" \"),t._l(t.labelList,function(e,s){return i(\"span\",{key:s,staticClass:\"item-color\",style:{background:e.color?e.color:\"#ccc\"}},[t._v(\"\\n              \"+t._s(e.labelName)+\"\\n            \")])}),t._v(\" \"),t.getPermission(\"setTaskLabel\")?i(\"div\",{staticClass:\"add-tag\"},[i(\"tag-index\",{attrs:{placement:\"right\",\"task-data\":t.taskData}},[i(\"span\",{staticClass:\"add-btn\",attrs:{slot:\"editIndex\"},slot:\"editIndex\"},[i(\"i\",{staticClass:\"wk wk-l-plus\"}),t._v(\" \"),i(\"span\",{staticClass:\"label\"},[t._v(\"标签\")])])])],1):t._e()],2)],1),t._v(\" \"),i(\"div\",{staticClass:\"secitons\"},[i(\"div\",{staticClass:\"section\"},[i(\"div\",{staticClass:\"section__hd\"},[i(\"i\",{staticClass:\"wk wk-write\"}),t._v(\" \"),i(\"span\",[t._v(\"描述\")])]),t._v(\" \"),i(\"div\",{staticClass:\"section__bd description\"},[i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.addDescriptionShow,expression:\"!addDescriptionShow\"}]},[t.taskData.description?i(\"div\",{staticClass:\"description-content\",on:{click:t.editTaskDescription}},[t._v(t._s(t.taskData.description))]):i(\"div\",{staticClass:\"description-empty\"},[i(\"span\",{staticClass:\"color-label\"},[t._v(\"暂无描述\")]),t._v(\" \"),t.getPermission(\"setTaskDescription\")?i(\"span\",{staticClass:\"add-btn\",on:{click:function(e){t.addDescriptionShow=!0}}},[i(\"i\",{staticClass:\"wk wk-l-plus\"}),t._v(\" \"),i(\"span\",{staticClass:\"label\"},[t._v(\"描述\")])]):t._e()])]),t._v(\" \"),i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.addDescriptionShow,expression:\"addDescriptionShow\"}]},[i(\"el-input\",{attrs:{autosize:{minRows:2},maxlength:2e3,\"show-word-limit\":\"\",type:\"textarea\",placeholder:\"请输入内容\"},model:{value:t.addDescriptionTextarea,callback:function(e){t.addDescriptionTextarea=e},expression:\"addDescriptionTextarea\"}}),t._v(\" \"),i(\"div\",{staticClass:\"btn-box\"},[i(\"el-button\",{attrs:{type:\"primary\",size:\"mini\"},on:{click:t.submiteDescription}},[t._v(\"保 存\")]),t._v(\" \"),i(\"el-button\",{attrs:{type:\"text\",size:\"mini\"},on:{click:function(e){t.addDescriptionTextarea=\"\",t.addDescriptionShow=!1}}},[t._v(\"取 消\")])],1)],1)])]),t._v(\" \"),i(\"div\",{staticClass:\"section\"},[i(\"div\",{staticClass:\"section__hd\"},[i(\"i\",{staticClass:\"wukong wukong-relevance\"}),t._v(\" \"),i(\"span\",[t._v(\"相关信息\")])]),t._v(\" \"),i(\"div\",{staticClass:\"section__bd\"},[i(\"related-business\",{attrs:{\"margin-left\":\"0\",\"all-data\":t.allData,\"show-foot\":t.getPermission(\"saveTaskRelation\"),\"show-add\":t.getPermission(\"saveTaskRelation\")},on:{checkRelatedDetail:t.checkRelatedDetail,checkInfos:t.checkInfos,unbind:t.unbindRelatedInfo}})],1)]),t._v(\" \"),i(\"div\",{staticClass:\"section\"},[i(\"div\",{staticClass:\"section__hd\"},[i(\"i\",{staticClass:\"wukong wukong-sub-task\"}),t._v(\" \"),i(\"span\",[t._v(\"子任务(\"+t._s(t.subTaskDoneNum)+\"/\"+t._s(t.taskData.childTask.length)+\")\")])]),t._v(\" \"),i(\"div\",{staticClass:\"section__bd\"},[0==t.taskData.pid?i(\"div\",[i(\"div\",[0!=t.taskData.childTask.length?[i(\"el-progress\",{attrs:{percentage:t.subTaskProgress,\"stroke-width\":10}})]:[i(\"el-progress\",{attrs:{percentage:0}})]],2),t._v(\" \"),0!=t.taskData.childTask.length?t._l(t.taskData.childTask,function(e,s){return i(\"div\",{key:s},[e.showEdit?i(\"sub-task\",{attrs:{\"sub-task-com\":\"edit\",time:e.stopTime,\"sub-data\":e,text:e.name,\"task-id\":t.subTaskID,\"checkbox-data\":e.checked,\"task-data\":t.taskData},on:{\"on-handle\":function(s){t.handleSubTasksBlock(s,e)}}}):i(\"flexbox\",{staticClass:\"sub-task\"},[i(\"div\",{on:{click:function(t){t.stopPropagation()}}},[i(\"el-checkbox\",{attrs:{disabled:!t.getPermission(\"setChildTaskStatus\")},on:{change:function(s){t.subtasksCheckbox(e,s)}},model:{value:e.checked,callback:function(s){t.$set(e,\"checked\",s)},expression:\"item.checked\"}})],1),t._v(\" \"),i(\"div\",{staticClass:\"sub-task__bd text-one-line\",class:{\"is-checked\":e.checked}},[t._v(\"\\n                        \"+t._s(e.name)+\"\\n                      \")]),t._v(\" \"),i(\"div\",{staticClass:\"edit-del-box\"},[t.getPermission(\"updateChildTask\")?i(\"span\",{staticClass:\"xr-text-btn primary\",on:{click:function(s){t.editSubTask(e)}}},[t._v(\"编辑\")]):t._e(),t._v(\" \"),t.getPermission(\"deleteChildTask\")?i(\"span\",{staticClass:\"xr-text-btn delete\",on:{click:function(s){t.deleteSubTask(e)}}},[t._v(\"删除\")]):t._e()]),t._v(\" \"),e.stopTime?i(\"div\",{staticClass:\"bg-color task-bg-color\"},[t._v(t._s(t._f(\"moment\")(e.stopTime,\"YYYY-MM-DD\"))+\" 截止\")]):t._e(),t._v(\" \"),e.mainUser?i(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:e.mainUser.realname,size:25,src:e.mainUser.img}}):t._e()],1)],1)}):t._e(),t._v(\" \"),t.getPermission(\"addChildTask\")?[t.addSubtasks?i(\"div\",[i(\"span\",{staticClass:\"add-btn\",on:{click:function(e){t.addSubtasks=!1}}},[i(\"i\",{staticClass:\"wk wk-l-plus\"}),t._v(\" \"),i(\"span\",{staticClass:\"label\"},[t._v(\"子任务\")])])]):i(\"sub-task\",{attrs:{\"sub-task-com\":\"new\",\"task-data\":t.taskData},on:{\"on-handle\":t.handleSubTasksBlock}})]:t._e()],2):t._e()])]),t._v(\" \"),i(\"div\",{staticClass:\"section\"},[i(\"div\",{staticClass:\"section__hd\"},[i(\"i\",{staticClass:\"wukong wukong-file\"}),t._v(\" \"),i(\"span\",[t._v(\"附件\")]),t._v(\" \"),t.fileList.length?i(\"span\",[t._v(\"(\"+t._s(t.fileList.length)+\")\")]):t._e()]),t._v(\" \"),i(\"div\",{staticClass:\"section__bd\"},[t._l(t.fileList,function(e,s){return i(\"file-cell\",{key:s,attrs:{data:e,list:t.fileList,\"cell-index\":s,\"module-id\":t.id,\"show-delete\":t.getPermission(\"deleteTaskFile\")},on:{delete:t.accessoryDeleteFun}})}),t._v(\" \"),t.getPermission(\"uploadTaskFile\")?i(\"el-upload\",{staticClass:\"upload-file\",attrs:{\"http-request\":t.httpRequest,action:\"https://jsonplaceholder.typicode.com/posts/\",multiple:\"\",\"list-type\":\"picture\"}},[i(\"span\",{staticClass:\"add-btn\"},[i(\"i\",{staticClass:\"wk wk-l-plus\"}),t._v(\" \"),i(\"span\",{staticClass:\"label\"},[t._v(\"附件\")])])]):t._e()],2)])])],1),t._v(\" \"),i(\"div\",{staticClass:\"main__bd--right\"},[i(\"el-tabs\",{staticClass:\"d-container-bd--right\",attrs:{value:\"comment\",type:\"border-card\"}},[i(\"el-tab-pane\",{attrs:{label:\"评论\",name:\"comment\",lazy:\"\"}},[i(\"flexbox\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.commentsLoading,expression:\"commentsLoading\"}],staticClass:\"comment-cells\",attrs:{direction:\"column\",align:\"stretch\"}},[i(\"comment-list\",{ref:\"comment_list\",attrs:{id:t.taskData.taskId,list:t.replyList,type:\"1\"},on:{delete:t.deleteComment,\"close-other-reply\":function(e){t.$refs.f_reply.toggleFocus(!0)}}}),t._v(\" \"),i(\"reply-comment\",{ref:\"f_reply\",on:{toggle:t.closeOtherReply,reply:t.handleReply}})],1)],1),t._v(\" \"),i(\"el-tab-pane\",{attrs:{label:\"活动\",name:\"activity\",lazy:\"\"}},[i(\"div\",{staticClass:\"activity-cells\"},t._l(t.activityList,function(e,s){return i(\"flexbox\",{key:s,staticClass:\"activity-cell\",attrs:{align:\"stretch\"}},[i(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:e.realname,size:26,src:e.img}}),t._v(\" \"),i(\"div\",{staticClass:\"activity-cell__bd\"},[i(\"div\",{staticClass:\"activity-info\"},[i(\"span\",{staticClass:\"activity-info--name\"},[t._v(t._s(e.realname))]),t._v(\" \"),i(\"span\",{staticClass:\"activity-info--time\"},[t._v(t._s(e.createTime))])]),t._v(\" \"),i(\"div\",{staticClass:\"activity-content\"},[t._v(t._s(e.content))])])],1)}))])],1)],1)]):t._e()],1):t._e(),t._v(\" \"),i(\"c-r-m-full-screen-detail\",{attrs:{visible:t.showRelatedDetail,\"crm-type\":t.relatedCRMType,id:t.relatedID},on:{\"update:visible\":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,\"842ab9ec\",null);S.options.__file=\"TaskDetail.vue\";e.default=S.exports},q0fG:function(t,e,s){\"use strict\";var i=s(\"ep8U\");s.n(i).a},qDfk:function(t,e,s){\"use strict\";s.r(e);var i=s(\"QbLZ\"),a=s.n(i),n=s(\"O8VQ\"),o=s(\"Ew9n\"),c=s(\"ZoMv\"),l={name:\"RecordList\",components:{LogCell:n.default,SlideView:o.a,CRMFullScreenDetail:function(){return Promise.all([s.e(\"chunk-66f9\"),s.e(\"chunk-0aaf\"),s.e(\"chunk-620e\"),s.e(\"chunk-36d0\")]).then(s.bind(null,\"3z7q\"))}},filters:{crmIconClass:function(t){return\"wk wk-\"+c.default.convertTypeToKey(t)},crmName:function(t){return c.default.convertTypeToName(t)}},props:{crmType:String,request:Function,params:Object,listenerIDs:{type:Array,default:function(){return[\"crm-main-container\"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return[\"el-table__body\"]}}},data:function(){return{loading:!1,page:1,noMore:!1,list:[],scrollKey:Date.now(),showFullDetail:!1,relationID:\"\",relationCrmType:\"\"}},computed:{crmIcon:function(){var t=this.crmType.replace(\"crm_\",\"\");return s(\"p3hS\")(\"./\"+t+\".png\")},scrollDisabled:function(){return this.loading||this.noMore}},watch:{params:function(){this.refreshList()}},mounted:function(){},methods:{refreshList:function(){this.page=1,this.list=[],this.noMore=!1,this.scrollKey=Date.now()},getList:function(){var t=this;this.loading=!0,this.request(a()({page:this.page,limit:15},this.params)).then(function(e){t.page++,t.list=t.list.concat(e.data.list),t.noMore=e.data.lastPage,t.loading=!1}).catch(function(){t.noMore=!0,t.loading=!1})},checkRelationDetail:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.relationID=e,this.relationCrmType=s?c.default.convertTypeToKey(t):t,this.showFullDetail=!0},hideView:function(){this.$emit(\"hide\")}}},r=(s(\"ANtS\"),s(\"KHd+\")),u=Object(r.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"slide-view\",{staticClass:\"d-view\",attrs:{\"listener-ids\":t.listenerIDs,\"no-listener-ids\":t.noListenerIDs,\"no-listener-class\":t.noListenerClass,\"body-style\":{padding:0,height:\"100%\"}},on:{close:t.hideView}},[i(\"flexbox\",{staticClass:\"t-section\"},[i(\"img\",{staticClass:\"t-img\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:t.crmIcon}}),t._v(\" \"),i(\"div\",{staticClass:\"t-name\"},[t._v(\"跟进记录\")])]),t._v(\" \"),i(\"div\",{staticClass:\"t-content\"},[i(\"div\",{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:t.getList,expression:\"getList\"}],key:t.scrollKey,attrs:{\"infinite-scroll-disabled\":\"scrollDisabled\",\"infinite-scroll-distance\":\"100\"}},t._l(t.list,function(e,s){return i(\"log-cell\",{key:s,attrs:{item:e,index:s,\"can-delete\":!1},on:{\"crm-detail\":t.checkRelationDetail}},[i(\"div\",{staticClass:\"relate-cell\",on:{click:function(s){t.checkRelationDetail(e.activityType,e.activityTypeId,!0)}}},[i(\"i\",{staticClass:\"relate-cell-icon\",class:t._f(\"crmIconClass\")(e.activityType)}),t._v(\" \"),i(\"span\",{staticClass:\"relate-cell-type\"},[t._v(t._s(t._f(\"crmName\")(e.activityType))+\"-\")]),t._v(\" \"),i(\"span\",{staticClass:\"relate-cell-name\"},[t._v(t._s(e.crmTypeName))])])])})),t._v(\" \"),t.loading?i(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"加载中...\")]):t._e(),t._v(\" \"),t.noMore?i(\"p\",{staticClass:\"scroll-bottom-tips\"},[t._v(\"没有更多了\")]):t._e()]),t._v(\" \"),i(\"c-r-m-full-screen-detail\",{attrs:{visible:t.showFullDetail,\"crm-type\":t.relationCrmType,id:t.relationID},on:{\"update:visible\":function(e){t.showFullDetail=e}}})],1)},[],!1,null,\"ec661820\",null);u.options.__file=\"RecordList.vue\";e.default=u.exports},qEca:function(t,e,s){\"use strict\";var i=s(\"wp1W\");s.n(i).a},s357:function(t,e,s){\"use strict\";var i=s(\"TDiV\");s.n(i).a},szeO:function(t,e,s){\"use strict\";var i=s(\"d5Rn\");s.n(i).a},tjFw:function(t,e,s){},\"u+Mw\":function(t,e,s){\"use strict\";var i=s(\"GQeE\"),a=s.n(i),n=s(\"sCIN\"),o={name:\"Emoji\",data:function(){return{emojiData:n.a,pannels:[\"表情\",\"自然\",\"物品\",\"地点\",\"符号\"],activeIndex:0}},computed:{emojis:function(){var t=this;return this.pannels.map(function(e){return a()(t.emojiData[e])})}},created:function(){},methods:{changeActive:function(t){this.activeIndex=t},getPureName:function(t){return t.replace(/:/g,\"\")},selectItem:function(t){this.$emit(\"select\",t)}}},c=(s(\"HtQe\"),s(\"KHd+\")),l=Object(c.a)(o,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"emoji\"},[s(\"ul\",{staticClass:\"emoji-controller\"},t._l(t.pannels,function(e,i){return s(\"li\",{key:i,class:{active:i===t.activeIndex},on:{click:function(e){t.changeActive(i)}}},[t._v(\"\\n      \"+t._s(e)+\"\\n    \")])})),t._v(\" \"),s(\"ul\",{staticClass:\"emoji-container\"},t._l(t.emojis,function(e,i){return i===t.activeIndex?s(\"li\",{key:i,staticStyle:{padding:\"0\"}},[t._v(\"\\n      \"+t._s(e)+\"--\"+t._s(i)+\"\\n      \"),t._l(e,function(e,i){return s(\"a\",{key:i,attrs:{href:\"javascript:;\"},on:{click:function(s){t.selectItem(e)}}},[s(\"span\",{staticClass:\"emoji-item\",class:\"sprite-\"+t.getPureName(e),attrs:{title:e}})])})],2):t._e()}))])},[],!1,null,\"36243ed9\",null);l.options.__file=\"Emoji.vue\";e.a=l.exports},u2Af:function(t,e,s){},ujp9:function(t,e,s){},vvxI:function(t,e,s){\"use strict\";s.r(e),e.default={filters:{},methods:{getActivityType:function(t){return{1:\"leads\",2:\"customer\",3:\"contacts\",4:\"product\",5:\"business\",6:\"contract\",7:\"receivables\",8:\"log\",9:\"examine\",11:\"task\"}[t]},getActivityTypeName:function(t){return{1:\"线索\",2:\"客户\",3:\"联系人\",4:\"产品\",5:\"商机\",6:\"合同\",7:\"回款\",8:\"日志\",9:\"审批\",10:\"日程\",11:\"任务\",12:\"发邮件\"}[t]},getRecordLogTypeName:function(t){return t?{1:\"跟进记录\",2:\"创建记录\",3:\"商机阶段变更\",4:\"外勤签到\"}[t]:\"跟进记录\"}}}},wEl6:function(t,e,s){\"use strict\";var i=s(\"cFwc\");s.n(i).a},wp1W:function(t,e,s){},ye9D:function(t,e,s){\"use strict\";var i={name:\"AddFileList\",components:{},props:{data:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{deleteItem:function(t,e){this.$emit(\"delete\",t,e)},deleteAll:function(){this.$emit(\"delete-all\")}}},a=(s(\"9Y/r\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"section\",{staticClass:\"file-cont\"},[i(\"flexbox\",{staticClass:\"f-header\"},[i(\"i\",{staticClass:\"wk wk-file\"}),t._v(\" \"),i(\"div\",{staticClass:\"f-name\"},[t._v(\"附件\")])]),t._v(\" \"),i(\"div\",{staticClass:\"f-body\"},t._l(t.data,function(e,a){return i(\"flexbox\",{key:a,staticClass:\"f-item\"},[i(\"img\",{staticClass:\"f-img\",attrs:{onerror:'this.src=\"'+s(\"Tww3\")+'\"',src:e.icon}}),t._v(\" \"),i(\"div\",{staticClass:\"f-name\"},[t._v(t._s(e.name)),i(\"span\",{staticClass:\"f-size\"},[t._v(t._s(\"（\"+e.size+\"）\"))])]),t._v(\" \"),i(\"div\",{staticClass:\"close-button\",on:{click:function(s){t.deleteItem(e,a)}}},[t._v(\"×\")])])})),t._v(\" \"),i(\"el-button\",{attrs:{type:\"text\"},on:{click:t.deleteAll}},[t._v(\"全部删除\")])],1)},[],!1,null,\"72a25ee2\",null);n.options.__file=\"AddFileList.vue\";e.a=n.exports},z5u8:function(t,e,s){\"use strict\";s.r(e);var i=s(\"gDS+\"),a=s.n(i),n=s(\"QbLZ\"),o=s.n(n),c=s(\"Flj7\"),l=s(\"0hym\"),r=s(\"LWkM\"),u=s(\"L2JU\"),d={components:{XhUser:l.a},props:{taskData:{type:Object,default:function(){return{}}},text:String,time:[String,Number],subData:Object,subTaskCom:{type:String,default:\"\"},taskId:[Number,String],checkboxData:{type:Boolean,default:!1}},data:function(){return{subtasksDate:\"\",xhUserData:[],isRequesting:!1,subtasksTextarea:\"\",showUserPopover:!1}},computed:o()({ownerListRequest:function(){return this.workId?r.t:null},ownerListParams:function(){return this.workId?{workId:this.workId}:null},workId:function(){return this.taskData.workId},isChangeUser:function(){var t=this.subData.mainUser?[this.subData.mainUser]:[];return this.xhUserData.length!=t.length||!(!this.xhUserData.length||this.xhUserData[0].userId==this.subData.mainUser.userId)}},Object(u.b)([\"userInfo\"])),watch:{},created:function(){\"edit\"==this.subTaskCom&&(this.subtasksTextarea=this.text?this.text:\"\",this.subtasksDate=this.time,\"{}\"!==a()(this.subData)?this.subData.mainUser&&(this.xhUserData=[this.subData.mainUser]):this.xhUserData=[])},methods:{subtasksSubmit:function(t){var e=this;this.subtasksTextarea=this.subtasksTextarea.split(/[\\n]/).join(\"\"),this.subtasksTextarea&&!this.isRequesting?(this.isRequesting=!0,\"new\"==this.subTaskCom?Object(c.b)({pid:this.taskData.taskId,name:this.subtasksTextarea,stopTime:this.subtasksDate,mainUserId:0!=this.xhUserData.length?this.xhUserData[0].userId:\"\"}).then(function(t){e.taskData.childTask.push({name:e.subtasksTextarea,stopTime:e.subtasksDate,taskId:t.data.taskId,mainUser:e.xhUserData.length>0?e.xhUserData[0]:e.userInfo}),e.$message.success(\"子任务创建成功\"),e.subtasksTextarea=\"\",e.subtasksDate=\"\",e.isRequesting=!1,e.$emit(\"on-handle\",{type:\"add\",result:\"success\"})}).catch(function(){e.$emit(\"on-handle\",{type:\"add\",result:\"error\"}),e.$message.error(\"子任务创建失败\"),e.isRequesting=!0}):\"edit\"==this.subTaskCom&&(1==this.isChangeUser||this.text!=this.subtasksTextarea||this.subtasksDate!=this.time?Object(c.d)({taskId:this.taskId,stopTime:this.subtasksDate,mainUserId:this.xhUserData.length>0?this.xhUserData[0].userId:\"\",name:this.subtasksTextarea}).then(function(t){var s=e.taskData.childTask;for(var i in s)if(s[i].taskId==e.taskId){var a=s[i];a.name=e.subtasksTextarea,a.stopTime=e.subtasksDate,a.mainUser=e.xhUserData.length>0?e.xhUserData[0]:null,s.splice(i,1,a);break}e.isRequesting=!1,e.$emit(\"on-handle\",{type:\"edit\",result:\"success\"}),e.$message.success(\"子任务编辑成功\")}).catch(function(){e.$emit(\"on-handle\",{type:\"edit\",result:\"error\"}),e.$message.error(\"子任务编辑失败\"),e.isRequesting=!1}):this.$emit(\"on-handle\",{type:\"cancel\"}))):this.$emit(\"on-handle\",{type:\"cancel\"})},xhUserCheckout:function(t){this.xhUserData=t,this.showUserPopover=!1},subtasksDateFun:function(){this.$refs.subtasksDate.change()}}},h=(s(\"qEca\"),s(\"KHd+\")),p=Object(h.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"task-sub\"},[s(\"div\",{directives:[{name:\"clickoutside\",rawName:\"v-clickoutside\",value:t.subtasksSubmit,expression:\"subtasksSubmit\"}],staticClass:\"subtasks-content\"},[s(\"div\",{staticClass:\"checkbox-box subtasks-box\"},[s(\"el-checkbox\",{attrs:{disabled:\"\"},model:{value:t.checkboxData,callback:function(e){t.checkboxData=e},expression:\"checkboxData\"}})],1),t._v(\" \"),s(\"div\",{staticClass:\"subtasks-content-box\"},[s(\"el-input\",{attrs:{maxlength:50,type:\"textarea\",autosize:\"\",placeholder:\"请输入内容\"},nativeOn:{keyup:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.subtasksSubmit(e):null}},model:{value:t.subtasksTextarea,callback:function(e){t.subtasksTextarea=e},expression:\"subtasksTextarea\"}})],1),t._v(\" \"),s(\"flexbox\",{staticClass:\"subtasks-content-png\"},[s(\"div\",{staticClass:\"time\"},[s(\"el-date-picker\",{ref:\"subtasksDate\",style:{width:t.subtasksDate?\"54px\":\"28px\"},attrs:{type:\"date\",format:\"yyyy 年 MM 月 dd 日\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"选择日期\"},model:{value:t.subtasksDate,callback:function(e){t.subtasksDate=e},expression:\"subtasksDate\"}}),t._v(\" \"),t.subtasksDate?s(\"span\",{staticClass:\"bg-color\"},[t._v(t._s(t._f(\"moment\")(t.subtasksDate,\"YYYY-MM-DD\")))]):s(\"i\",{staticClass:\"wukong wukong-time-task\",on:{click:t.subtasksDateFun}})],1),t._v(\" \"),s(\"el-popover\",{attrs:{placement:\"bottom-end\",width:\"280\",\"popper-class\":\"no-padding-popover\",trigger:\"click\"},model:{value:t.showUserPopover,callback:function(e){t.showUserPopover=e},expression:\"showUserPopover\"}},[s(\"xh-user\",{ref:\"xhuser\",attrs:{\"info-request\":t.ownerListRequest,\"info-params\":t.ownerListParams,\"selected-data\":t.xhUserData,radio:\"\"},on:{changeCheckout:t.xhUserCheckout}}),t._v(\" \"),s(\"div\",{staticClass:\"select-box\",attrs:{slot:\"reference\"},slot:\"reference\"},[t.xhUserData&&t.xhUserData.length?t._l(t.xhUserData,function(e,i){return s(\"span\",{key:i},[s(\"el-tooltip\",{attrs:{placement:\"bottom\",effect:\"light\",\"popper-class\":\"tooltip-change-border\"}},[s(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[s(\"span\",{on:{click:function(e){t.showUserPopover=!0}}},[t._v(t._s(e.realname))])]),t._v(\" \"),s(\"xr-avatar\",{attrs:{name:e.realname,size:24,src:e.img}})],1)],1)}):s(\"i\",{staticClass:\"wukong wukong-user\"})],2)],1)],1)],1)])},[],!1,null,\"69ac83d6\",null);p.options.__file=\"SubTask.vue\";e.default=p.exports},z7oh:function(t,e,s){\"use strict\";var i=s(\"QbLZ\"),a=s.n(i),n=s(\"dPzk\"),o=s(\"Ir+r\"),c=s(\"L2JU\"),l=s(\"Xjjk\"),r=s.n(l),u={name:\"CommentList\",components:{ReplyComment:n.a},props:{list:{type:Array,required:!0},id:{type:[String,Number],required:!0},type:[String,Number]},data:function(){return{replyIndex:null,commentLoading:!1}},computed:a()({},Object(c.b)([\"userInfo\"])),methods:{handleToReply:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=t+(null!==e?\"-\"+e:\"\");this.$emit(\"close-other-reply\"),s!==this.replyIndex&&(this.replyIndex=s)},closeReply:function(){this.replyIndex=null},handleReply:function(t){var e=this,s={type:this.type,content:r()(t),typeId:this.id},i=null,a=this.replyIndex.split(\"-\"),n=this.list[a[0]];a[1]&&(i=n.childCommentList[a[1]]),n&&(s.mainId=n.commentId,s.pid=n.userId),i&&(s.pid=i.userId),this.commentLoading=!0,Object(o.c)(s).then(function(t){t.data.user={userId:e.userInfo.id,realname:e.userInfo.realname,img:e.userInfo.img},t.data.replyUser=i?i.user:n.user,e.list[a[0]].childCommentList.push(t.data),e.replyIndex=null,e.commentLoading=!1}).catch(function(){e.commentLoading=!1})},handleToDelete:function(t,e){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.$confirm(\"确定删除?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(o.a)({commentId:t.commentId}).then(function(t){s.$message({type:\"success\",message:\"删除成功!\"}),i>=0?s.list[e].childCommentList.splice(i,1):s.$emit(\"delete\",e)})}).catch(function(){s.$message({type:\"info\",message:\"已取消删除\"})})}}},d=(s(\"OdVz\"),s(\"KHd+\")),h=Object(d.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"comment-list\"},t._l(t.list,function(e,i){return s(\"div\",{key:i,staticClass:\"comment-list-item\"},[s(\"div\",{staticClass:\"parent-reply reply\"},[s(\"div\",{staticClass:\"user-info\"},[s(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:e.user.realname,id:e.user.userId,size:34,src:e.user.img,disabled:!1}}),t._v(\" \"),s(\"div\",{staticClass:\"user-info__bd\"},[s(\"div\",{staticClass:\"user\"},[t._v(t._s(e.user.realname))]),t._v(\" \"),s(\"div\",{staticClass:\"time\"},[t._v(\"\\n            \"+t._s(e.createTime)+\"\\n          \")])]),t._v(\" \"),s(\"div\",{staticClass:\"control\"},[s(\"span\",{staticClass:\"reply-btn\",on:{click:function(e){t.handleToReply(i)}}},[s(\"i\",{staticClass:\"wk wk-reply\"}),t._v(\" \"),s(\"span\",[t._v(\"回复\")])]),t._v(\" \"),s(\"span\",{staticClass:\"delete-btn\",on:{click:function(s){t.handleToDelete(e,i)}}},[s(\"i\",{staticClass:\"wk wk-s-delete\"}),t._v(\" \"),s(\"span\",[t._v(\"删除\")])])])],1),t._v(\" \"),s(\"div\",{staticClass:\"content\",domProps:{innerHTML:t._s(t.emoji(e.content))}}),t._v(\" \"),t.replyIndex===String(i)?s(\"reply-comment\",{on:{reply:t.handleReply,close:function(e){t.replyIndex=null}}}):t._e()],1),t._v(\" \"),e.childCommentList&&e.childCommentList.length>0?t._l(e.childCommentList,function(e,a){return s(\"div\",{key:a},[s(\"div\",{staticClass:\"child-reply reply\"},[s(\"div\",{staticClass:\"user-info\"},[s(\"xr-avatar\",{staticClass:\"user-img\",attrs:{name:e.user.realname,id:e.user.userId,size:34,src:e.user.img,disabled:!1}}),t._v(\" \"),s(\"div\",{staticClass:\"user-info__bd\"},[s(\"div\",{staticClass:\"user\"},[t._v(\"\\n                \"+t._s(e.user.realname)+\"\\n              \")]),t._v(\" \"),s(\"div\",{staticClass:\"time\"},[t._v(\"\\n                \"+t._s(e.createTime)+\"\\n              \")])]),t._v(\" \"),s(\"div\",{staticClass:\"control\"},[s(\"span\",{staticClass:\"reply-btn\",on:{click:function(e){t.handleToReply(i,a)}}},[s(\"i\",{staticClass:\"wk wk-reply\"}),t._v(\" \"),s(\"span\",[t._v(\"回复\")])]),t._v(\" \"),s(\"span\",{staticClass:\"delete-btn\",on:{click:function(s){t.handleToDelete(e,i,a)}}},[s(\"i\",{staticClass:\"wk wk-s-delete\"}),t._v(\" \"),s(\"span\",[t._v(\"删除\")])])])],1),t._v(\" \"),s(\"div\",{staticClass:\"child-content\"},[s(\"span\",[t._v(\"\\n              回复 @\"+t._s(e.replyUser.realname)+\"：\\n            \")]),t._v(\" \"),s(\"span\",{staticClass:\"content\",domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(\" \"),t.replyIndex===i+\"-\"+a?s(\"reply-comment\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.commentLoading,expression:\"commentLoading\"}],on:{reply:t.handleReply,close:function(e){t.replyIndex=null}}}):t._e()],1)])}):t._e()],2)}))},[],!1,null,\"714ff9da\",null);h.options.__file=\"CommentList.vue\";e.a=h.exports},zMq1:function(t,e,s){\"use strict\";var i={name:\"AddImageList\",components:{},props:{data:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.data,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.data,e,t)},deleteItem:function(t,e){this.$emit(\"delete\",t,e)},deleteAll:function(){this.$emit(\"delete-all\")},uploadFile:function(t){this.$emit(\"upload\",t)}}},a=(s(\"Z/5k\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"section\",{staticClass:\"img-cont\"},[s(\"flexbox\",{attrs:{wrap:\"wrap\"}},[t._l(t.data,function(e,i){return s(\"div\",{directives:[{name:\"src\",rawName:\"v-src:background-image\",value:e.url||e.filePath,expression:\"item.url || item.filePath\",arg:\"background-image\"}],key:i,staticClass:\"img-item\",on:{mouseover:function(s){t.mouseImgOver(e,i)},mouseleave:function(s){t.mouseImgLeave(e,i)}}},[e.showDelete?s(\"div\",{staticClass:\"img-delete\",on:{click:function(s){t.deleteItem(e,i)}}},[t._v(\"×\")]):t._e()])}),t._v(\" \"),s(\"div\",{staticClass:\"img-item-add\"},[s(\"input\",{staticClass:\"img-item-iput\",attrs:{type:\"file\",accept:\"image/*\",multiple:\"\"},on:{change:t.uploadFile}})])],2),t._v(\" \"),s(\"el-button\",{attrs:{type:\"text\"},on:{click:t.deleteAll}},[t._v(\"全部删除\")])],1)},[],!1,null,\"605cd0e7\",null);n.options.__file=\"AddImageList.vue\";e.a=n.exports},zsVz:function(t,e,s){\"use strict\";s.d(e,\"g\",function(){return a}),s.d(e,\"e\",function(){return n}),s.d(e,\"a\",function(){return o}),s.d(e,\"b\",function(){return c}),s.d(e,\"d\",function(){return l}),s.d(e,\"c\",function(){return r}),s.d(e,\"f\",function(){return u}),s.d(e,\"h\",function(){return d});var i=s(\"t3Un\");function a(t){return Object(i.a)({url:\"oaTask/queryTaskList\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function n(t){return Object(i.a)({url:\"workTask/saveWorkTask\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function o(t){return Object(i.a)({url:\"workTask/queryTaskInfo/\"+t.taskId,method:\"post\"})}function c(t){return Object(i.a)({url:\"workTask/queryTrashTaskInfo\",method:\"post\",data:t})}function l(t){return Object(i.a)({url:\"workTaskLog/queryTaskLog/\"+t.taskId,method:\"post\"})}function r(t){return Object(i.a)({url:\"workTaskRelation/saveWorkTaskRelation\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function u(t){return Object(i.a)({url:\"oaTask/deleteWorkTaskLabel\",method:\"post\",data:t,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function d(t){return Object(i.a)({url:\"oaTask/oaTaskExport\",method:\"post\",data:t,responseType:\"blob\",headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}}}]);","extractedComments":[]}